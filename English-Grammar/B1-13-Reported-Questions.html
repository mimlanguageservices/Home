<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>B1-53: Reported Speech - Questions & Commands</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            height: 100vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 20px 40px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
        }

        .header-left {
            display: flex;
            flex-direction: column;
        }

        .header h1 {
            color: #2d3748;
            font-size: 2.5rem;
            font-weight: 700;
            margin: 0;
            letter-spacing: -0.5px;
        }

        .header .website {
            text-align: center;
            margin-top: 8px;
        }

        .header .website a {
            color: #4c51bf;
            text-decoration: none;
            font-size: 1.2rem;
            font-weight: 500;
            transition: color 0.3s ease;
        }

        .header .website a:hover {
            color: #553c9a;
        }

        .header-image {
            width: 120px;
            height: 80px;
            border-radius: 12px;
            object-fit: cover;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.15);
        }

        .container {
            display: flex;
            height: calc(100vh - 120px);
        }

        .navigation {
            width: 280px;
            background: rgba(45, 55, 72, 0.95);
            backdrop-filter: blur(10px);
            padding: 30px 20px;
            border-right: 1px solid rgba(255, 255, 255, 0.1);
        }

        .nav-item {
            padding: 16px 24px;
            margin: 8px 0;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            color: #e2e8f0;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            text-align: center;
            font-weight: 500;
            font-size: 1.1rem;
            backdrop-filter: blur(5px);
        }

        .nav-item:hover {
            background: rgba(255, 255, 255, 0.2);
            color: #ffffff;
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
        }

        .nav-item.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #ffffff;
            border-color: transparent;
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
        }

        .content {
            flex: 1;
            display: flex;
            flex-direction: column;
            height: 100%;
            overflow: hidden;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
        }

        .section {
            display: none;
            flex: 1;
            padding: 0;
            overflow: hidden;
            height: 100%;
            background: white;
        }

        .section.active {
            display: flex;
            flex-direction: column;
        }

        .slideshow-container {
            position: relative;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background: white;
            padding: 30px 80px;
        }

        .slide-content-wrapper {
            position: relative;
            width: 100%;
            max-width: 1400px;
            height: 85%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .slide {
            display: none;
            width: 100%;
            height: 100%;
            background: white;
            border-radius: 20px;
            padding: 25px 35px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .slide.active {
            display: flex;
            flex-direction: column;
            animation: slideIn 0.5s ease-in-out;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(30px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .slide-arrow {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: #8B7EC8;
            color: white;
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            z-index: 10;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }

        .slide-arrow:hover {
            background: #7366B0;
            transform: translateY(-50%) scale(1.1);
        }

        .slide-arrow.prev {
            left: -70px;
        }

        .slide-arrow.next {
            right: -70px;
        }

        .slide-indicators {
            position: absolute;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 12px;
            z-index: 10;
        }

        .indicator-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #D1D5DB;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .indicator-dot.active {
            background: #667eea;
            transform: scale(1.3);
        }

        .indicator-dot:hover {
            background: #9CA3AF;
        }

        .slide h2 {
            color: #2d3748;
            margin-bottom: 15px;
            font-size: 2rem;
            font-weight: 700;
            text-align: center;
            letter-spacing: -0.5px;
        }

        .explanation-box {
            background: transparent;
            border: none;
            border-radius: 0;
            padding: 0;
            margin-bottom: 0;
            backdrop-filter: none;
            box-shadow: none;
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow-y: auto;
            overflow-x: hidden;
        }

        .explanation-box h3 {
            color: #667eea;
            font-size: 1.3rem;
            margin-bottom: 10px;
            font-weight: 600;
        }

        .explanation-box p {
            color: #2d3748;
            line-height: 1.5;
            font-size: 1rem;
            margin-bottom: 8px;
        }

        .rule-box {
            background: #e3f2fd;
            padding: 15px 20px;
            border-radius: 10px;
            margin: 10px 0;
            border-left: 4px solid #667eea;
        }

        .rule-box h4 {
            color: #667eea;
            font-size: 1.2rem;
            margin-bottom: 8px;
            font-weight: 600;
        }

        .rule-box p {
            font-size: 1rem;
            color: #2d3748;
            margin: 5px 0;
        }

        .yes-no {
            display: inline-block;
            padding: 6px 12px;
            margin: 3px;
            border-radius: 6px;
            font-weight: 600;
            font-size: 1rem;
            background: #4299e1;
            color: white;
        }

        .auxiliary {
            display: inline-block;
            padding: 6px 12px;
            margin: 3px;
            border-radius: 6px;
            font-weight: 600;
            font-size: 1rem;
            background: #48bb78;
            color: white;
        }

        .subject {
            display: inline-block;
            padding: 6px 12px;
            margin: 3px;
            border-radius: 6px;
            font-weight: 600;
            font-size: 1rem;
            background: #9f7aea;
            color: white;
        }

        .verb {
            display: inline-block;
            padding: 6px 12px;
            margin: 3px;
            border-radius: 6px;
            font-weight: 600;
            font-size: 1rem;
            background: #ed64a6;
            color: white;
        }

        .example-box {
            background: #f7fafc;
            border-left: 4px solid #667eea;
            padding: 12px;
            border-radius: 8px;
            margin: 8px 0;
        }

        .example-box p {
            margin: 5px 0;
            font-size: 1rem;
            color: #2d3748;
        }

        .note-box {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 12px;
            margin: 10px 0;
            border-radius: 8px;
        }

        .note-box strong {
            color: #856404;
            font-size: 1rem;
        }

        .note-box p {
            color: #856404;
            margin-top: 5px;
            line-height: 1.4;
            font-size: 0.95rem;
        }

        .exercise-container {
            background: transparent;
            border: none;
            border-radius: 0;
            padding: 0;
            margin-bottom: 10px;
            backdrop-filter: none;
            box-shadow: none;
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .exercise-container h3 {
            color: #764ba2;
            font-size: 1.4rem;
            margin-bottom: 15px;
            font-weight: 600;
        }

        .question-box {
            background: #e3f2fd;
            padding: 20px;
            border-radius: 12px;
            margin: 0;
        }

        .question-box p {
            font-weight: 600;
            color: #2d3748;
            margin-bottom: 12px;
            font-size: 1.1rem;
        }

        input[type="text"] {
            width: 100%;
            padding: 12px 18px;
            margin: 8px 0;
            border: 2px solid rgba(102, 126, 234, 0.3);
            border-radius: 8px;
            font-size: 1.05rem;
            font-family: 'Inter', sans-serif;
            background: rgba(255, 255, 255, 0.8);
            transition: all 0.3s ease;
        }

        input[type="text"]:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 20px rgba(102, 126, 234, 0.2);
        }

        .check-button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #ffffff;
            border: none;
            padding: 12px 30px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1.1rem;
            font-weight: 600;
            margin: 15px 5px 10px 5px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }

        .check-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
        }

        .feedback {
            padding: 15px 20px;
            border-radius: 12px;
            margin: 15px 0;
            font-weight: 500;
            font-size: 1.05rem;
            display: none;
        }

        .feedback.correct {
            background: rgba(72, 187, 120, 0.1);
            color: #2f855a;
            border: 1px solid rgba(72, 187, 120, 0.3);
            display: block;
        }

        .feedback.incorrect {
            background: rgba(245, 101, 101, 0.1);
            color: #c53030;
            border: 1px solid rgba(245, 101, 101, 0.3);
            display: block;
        }

        ul {
            margin-left: 25px;
            line-height: 1.6;
        }

        li {
            margin: 6px 0;
            font-size: 1.05rem;
            color: #2d3748;
        }

        li strong {
            color: #667eea;
        }

        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin: 12px 0;
        }

        .comparison-table th {
            background: #667eea;
            color: white;
            padding: 10px;
            font-size: 1.05rem;
            font-weight: 600;
        }

        .comparison-table td {
            padding: 10px;
            border: 1px solid #e2e8f0;
            font-size: 1rem;
            text-align: center;
        }

        .comparison-table tr:nth-child(even) {
            background: #f7fafc;
        }

        .explanation-box::-webkit-scrollbar {
            width: 8px;
        }

        .explanation-box::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }

        .explanation-box::-webkit-scrollbar-thumb {
            background: #667eea;
            border-radius: 10px;
        }

        .explanation-box::-webkit-scrollbar-thumb:hover {
            background: #5568d3;
        }

        .formula-box {
            background: #e6fffa;
            border: 2px solid #319795;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            text-align: center;
            font-size: 1.3rem;
        }

        .grid-examples {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .grid-card {
            background: white;
            padding: 15px;
            border-radius: 10px;
            border: 2px solid #e2e8f0;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .grid-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .reading-text {
            background: #f7fafc;
            padding: 20px;
            border-radius: 10px;
            line-height: 1.9;
            margin: 15px 0;
            border: 2px solid #e2e8f0;
        }

        .reading-text p {
            margin: 12px 0;
        }

        .highlight-question {
            background: #bee3f8;
            padding: 2px 6px;
            border-radius: 4px;
            font-weight: bold;
        }

        .highlight-answer {
            background: #c6f6d5;
            padding: 2px 6px;
            border-radius: 4px;
            font-weight: bold;
        }

        .example-sentence {
            font-size: 1.1rem;
            margin: 10px 0;
            padding: 10px;
            background: white;
            border-radius: 8px;
            border-left: 3px solid #667eea;
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="header-left">
            <h1>B1-53: Reported Speech - Questions & Commands</h1>
            <div class="website">
                <a href="https://www.mimlanguageservices.com/" target="_blank">mimlanguageservices</a>
            </div>
        </div>
        <a href="https://www.mimlanguageservices.com/" target="_blank">
            <img src="https://static.wixstatic.com/media/593d03_8958d96b0f6d4d1ea9dffa7f89bffe8b~mv2.png" alt="ESL Logo" class="header-image">
        </a>
    </div>

    <div class="container">
        <div class="navigation">
            <div class="nav-item active" onclick="showSection('explanation', this)">Explanation</div>
            <div class="nav-item" onclick="showSection('examples', this)">Examples</div>
            <div class="nav-item" onclick="showSection('reading', this)">Reading</div>
            <div class="nav-item" onclick="showSection('media', this)">Media</div>
            <div class="nav-item" onclick="showSection('practice', this)">Practice</div>
            <div class="nav-item" onclick="showSection('writing', this)">Writing</div>
        </div>

        <div class="content">
            <!-- Explanation Section -->
            <div class="section active" id="explanation">
                <div class="slideshow-container">
                    <div class="slide-content-wrapper">
                        <button class="slide-arrow prev" onclick="changeSlide(-1)">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                                <polyline points="15 18 9 12 15 6"></polyline>
                            </svg>
                        </button>
                        <button class="slide-arrow next" onclick="changeSlide(1)">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                                <polyline points="9 18 15 12 9 6"></polyline>
                            </svg>
                        </button>

                        <div class="slide active" data-section="explanation">
                            <h2>Welcome to Reported Speech - Questions & Commands!</h2>
                            <div class="explanation-box">
                                <p style="font-size: 1.2rem; text-align: center; margin: 20px 0;">
                                    Today we will learn how to report <span class="yes-no">QUESTIONS</span> and <span class="yes-no">COMMANDS</span> in English!
                                </p>
                                <p style="font-size: 1.1rem; text-align: center;">
                                    When we report what someone asked or told us to do, we need special structures.
                                </p>
                                <div class="formula-box">
                                    <p><strong>Reported Questions:</strong> <span class="auxiliary">asked</span> + <span class="subject">question word/if/whether</span> + <span class="verb">statement order</span></p>
                                    <p style="margin-top: 15px;"><strong>Reported Commands:</strong> <span class="auxiliary">told/asked/ordered</span> + <span class="subject">person</span> + <span class="verb">to + infinitive</span></p>
                                </div>
                                <p style="text-align: center; font-size: 1.1rem;">
                                    Example: "Where do you live?" → He <strong>asked where I lived</strong>.<br>
                                    "Close the door!" → She <strong>told me to close</strong> the door.
                                </p>
                            </div>
                        </div>

                        <div class="slide" data-section="explanation">
                            <h2>Reported Questions: Wh-Questions</h2>
                            <div class="explanation-box">
                                <h3>Converting Wh-Questions to Reported Speech</h3>

                                <div class="formula-box">
                                    <span class="subject">Subject</span> + <span class="auxiliary">asked</span> + <span class="verb">question word</span> + <span class="yes-no">statement order</span>
                                </div>

                                <table class="comparison-table">
                                    <tr>
                                        <th>Direct Question</th>
                                        <th>Reported Question</th>
                                    </tr>
                                    <tr>
                                        <td>"Where do you live?"</td>
                                        <td>She asked where I lived.</td>
                                    </tr>
                                    <tr>
                                        <td>"What are you doing?"</td>
                                        <td>He asked what I was doing.</td>
                                    </tr>
                                    <tr>
                                        <td>"Why did you come late?"</td>
                                        <td>They asked why I had come late.</td>
                                    </tr>
                                    <tr>
                                        <td>"When will you arrive?"</td>
                                        <td>She asked when I would arrive.</td>
                                    </tr>
                                </table>

                                <div class="rule-box">
                                    <h4>Key Changes:</h4>
                                    <p>• Use <strong>statement word order</strong> (not question order)</p>
                                    <p>• Keep the <strong>question word</strong> (what, where, when, why, who, how)</p>
                                    <p>• Change the <strong>tense</strong> (backshift)</p>
                                    <p>• Change <strong>pronouns</strong> and <strong>time expressions</strong></p>
                                    <p>• <strong>NO question mark</strong> at the end</p>
                                </div>
                            </div>
                        </div>

                        <div class="slide" data-section="explanation">
                            <h2>Reported Questions: Yes/No Questions</h2>
                            <div class="explanation-box">
                                <h3>Converting Yes/No Questions with IF or WHETHER</h3>

                                <div class="formula-box">
                                    <span class="subject">Subject</span> + <span class="auxiliary">asked</span> + <span class="verb">if/whether</span> + <span class="yes-no">statement order</span>
                                </div>

                                <table class="comparison-table">
                                    <tr>
                                        <th>Direct Question</th>
                                        <th>Reported Question</th>
                                    </tr>
                                    <tr>
                                        <td>"Do you like coffee?"</td>
                                        <td>She asked if I liked coffee.</td>
                                    </tr>
                                    <tr>
                                        <td>"Are you coming to the party?"</td>
                                        <td>He asked whether I was coming to the party.</td>
                                    </tr>
                                    <tr>
                                        <td>"Have you finished your homework?"</td>
                                        <td>They asked if I had finished my homework.</td>
                                    </tr>
                                    <tr>
                                        <td>"Can you help me?"</td>
                                        <td>She asked whether I could help her.</td>
                                    </tr>
                                </table>

                                <div class="rule-box">
                                    <h4>Remember:</h4>
                                    <p>• Use <strong>IF</strong> or <strong>WHETHER</strong> (both are correct)</p>
                                    <p>• WHETHER is more formal</p>
                                    <p>• Change to <strong>statement order</strong></p>
                                    <p>• Apply <strong>tense backshift</strong></p>
                                    <p>• Change <strong>auxiliaries</strong>: do/does → (nothing), did → had, can → could, will → would</p>
                                </div>
                            </div>
                        </div>

                        <div class="slide" data-section="explanation">
                            <h2>Reported Commands: Tell/Ask/Order + to Infinitive</h2>
                            <div class="explanation-box">
                                <h3>Converting Commands and Instructions</h3>

                                <div class="formula-box">
                                    <span class="subject">Subject</span> + <span class="auxiliary">told/asked/ordered</span> + <span class="subject">person</span> + <span class="verb">to + infinitive</span>
                                </div>

                                <table class="comparison-table">
                                    <tr>
                                        <th>Direct Command</th>
                                        <th>Reported Command</th>
                                    </tr>
                                    <tr>
                                        <td>"Close the door!"</td>
                                        <td>She told me to close the door.</td>
                                    </tr>
                                    <tr>
                                        <td>"Don't be late!"</td>
                                        <td>He told me not to be late.</td>
                                    </tr>
                                    <tr>
                                        <td>"Sit down, please."</td>
                                        <td>The teacher asked us to sit down.</td>
                                    </tr>
                                    <tr>
                                        <td>"Leave the room immediately!"</td>
                                        <td>The officer ordered them to leave the room immediately.</td>
                                    </tr>
                                </table>

                                <div class="rule-box">
                                    <h4>Reporting Verbs for Commands:</h4>
                                    <p>• <strong>TELL</strong> + person + to infinitive (neutral, instructions)</p>
                                    <p>• <strong>ASK</strong> + person + to infinitive (polite requests)</p>
                                    <p>• <strong>ORDER</strong> + person + to infinitive (strong commands, authority)</p>
                                    <p>• For negative: <strong>NOT to</strong> + infinitive</p>
                                </div>
                            </div>
                        </div>

                        <div class="slide" data-section="explanation">
                            <h2>Reported Requests: Ask/Beg + to Infinitive</h2>
                            <div class="explanation-box">
                                <h3>Converting Polite Requests</h3>

                                <div class="formula-box">
                                    <span class="subject">Subject</span> + <span class="auxiliary">asked/begged</span> + <span class="subject">person</span> + <span class="verb">to + infinitive</span>
                                </div>

                                <table class="comparison-table">
                                    <tr>
                                        <th>Direct Request</th>
                                        <th>Reported Request</th>
                                    </tr>
                                    <tr>
                                        <td>"Could you help me, please?"</td>
                                        <td>She asked me to help her.</td>
                                    </tr>
                                    <tr>
                                        <td>"Would you open the window?"</td>
                                        <td>He asked me to open the window.</td>
                                    </tr>
                                    <tr>
                                        <td>"Please, please give me another chance!"</td>
                                        <td>He begged me to give him another chance.</td>
                                    </tr>
                                    <tr>
                                        <td>"Can you call me later?"</td>
                                        <td>She asked me to call her later.</td>
                                    </tr>
                                </table>

                                <div class="rule-box">
                                    <h4>Key Points:</h4>
                                    <p>• Use <strong>ASK</strong> for polite requests with "could you", "would you", "can you"</p>
                                    <p>• Use <strong>BEG</strong> for very strong, desperate requests</p>
                                    <p>• Remove modal verbs (could, would, can) → use <strong>to infinitive</strong></p>
                                    <p>• Always include the <strong>person</strong> being asked</p>
                                    <p>• Change pronouns appropriately (you → me/him/her)</p>
                                </div>

                                <div class="note-box">
                                    <strong>Other Reporting Verbs:</strong>
                                    <p>advise (sb to), warn (sb not to), remind (sb to), invite (sb to), encourage (sb to), persuade (sb to)</p>
                                </div>
                            </div>
                        </div>

                        <div class="slide" data-section="explanation">
                            <h2>Common Mistakes</h2>
                            <div class="explanation-box">
                                <h3>Mistake 1: Using question order in reported questions</h3>
                                <div class="example-box">
                                    <p>❌ She asked where <del>do I live</del>. → ✅ She asked where <strong>I lived</strong>.</p>
                                    <p>❌ He asked if <del>am I ready</del>. → ✅ He asked if <strong>I was ready</strong>.</p>
                                    <p><strong>Remember:</strong> Use statement order, not question order!</p>
                                </div>

                                <h3>Mistake 2: Forgetting IF/WHETHER in yes/no questions</h3>
                                <div class="example-box">
                                    <p>❌ She asked <del>I liked coffee</del>. → ✅ She asked <strong>if I liked coffee</strong>.</p>
                                    <p>❌ He wanted to know <del>I was coming</del>. → ✅ He wanted to know <strong>whether I was coming</strong>.</p>
                                </div>

                                <h3>Mistake 3: Using wrong structure for commands</h3>
                                <div class="example-box">
                                    <p>❌ She told me <del>close the door</del>. → ✅ She told me <strong>to close the door</strong>.</p>
                                    <p>❌ He asked me <del>that I help him</del>. → ✅ He asked me <strong>to help him</strong>.</p>
                                </div>

                                <h3>Mistake 4: Adding question mark to reported questions</h3>
                                <div class="example-box">
                                    <p>❌ She asked where I lived<del>?</del> → ✅ She asked where I lived<strong>.</strong></p>
                                    <p><strong>Remember:</strong> Reported questions end with a period, not a question mark!</p>
                                </div>

                                <h3>Mistake 5: Forgetting tense backshift</h3>
                                <div class="example-box">
                                    <p>❌ He asked what I <del>am doing</del>. → ✅ He asked what I <strong>was doing</strong>.</p>
                                    <p>❌ She asked if I <del>have finished</del>. → ✅ She asked if I <strong>had finished</strong>.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="slide-indicators" id="explanation-indicators">
                        <span class="indicator-dot active" onclick="goToSlide(1)"></span>
                        <span class="indicator-dot" onclick="goToSlide(2)"></span>
                        <span class="indicator-dot" onclick="goToSlide(3)"></span>
                        <span class="indicator-dot" onclick="goToSlide(4)"></span>
                        <span class="indicator-dot" onclick="goToSlide(5)"></span>
                        <span class="indicator-dot" onclick="goToSlide(6)"></span>
                    </div>
                </div>
            </div>

            <!-- Examples Section -->
            <div class="section" id="examples">
                <div class="slideshow-container">
                    <div class="slide-content-wrapper">
                        <button class="slide-arrow prev" onclick="changeSlide(-1)">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                                <polyline points="15 18 9 12 15 6"></polyline>
                            </svg>
                        </button>
                        <button class="slide-arrow next" onclick="changeSlide(1)">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                                <polyline points="9 18 15 12 9 6"></polyline>
                            </svg>
                        </button>

                        <div class="slide active" data-section="examples">
                            <h2>Wh-Question Examples</h2>
                            <div class="explanation-box">
                                <h3>Converting Wh-Questions to Reported Speech:</h3>
                                <div class="grid-examples">
                                    <div class="grid-card">
                                        <strong>WHERE questions:</strong><br><br>
                                        <p style="margin: 8px 0;">"Where do you work?"</p>
                                        <p style="color: #667eea;">→ He asked where I worked.</p>
                                        <p style="margin: 8px 0;">"Where is the station?"</p>
                                        <p style="color: #667eea;">→ She asked where the station was.</p>
                                    </div>
                                    <div class="grid-card">
                                        <strong>WHAT questions:</strong><br><br>
                                        <p style="margin: 8px 0;">"What are you doing?"</p>
                                        <p style="color: #667eea;">→ He asked what I was doing.</p>
                                        <p style="margin: 8px 0;">"What did you say?"</p>
                                        <p style="color: #667eea;">→ She asked what I had said.</p>
                                    </div>
                                </div>

                                <div class="grid-examples">
                                    <div class="grid-card">
                                        <strong>WHEN questions:</strong><br><br>
                                        <p style="margin: 8px 0;">"When will you finish?"</p>
                                        <p style="color: #667eea;">→ He asked when I would finish.</p>
                                        <p style="margin: 8px 0;">"When did you arrive?"</p>
                                        <p style="color: #667eea;">→ She asked when I had arrived.</p>
                                    </div>
                                    <div class="grid-card">
                                        <strong>WHY questions:</strong><br><br>
                                        <p style="margin: 8px 0;">"Why are you late?"</p>
                                        <p style="color: #667eea;">→ He asked why I was late.</p>
                                        <p style="margin: 8px 0;">"Why didn't you call?"</p>
                                        <p style="color: #667eea;">→ She asked why I hadn't called.</p>
                                    </div>
                                </div>

                                <div class="grid-examples">
                                    <div class="grid-card">
                                        <strong>HOW questions:</strong><br><br>
                                        <p style="margin: 8px 0;">"How do you know?"</p>
                                        <p style="color: #667eea;">→ He asked how I knew.</p>
                                        <p style="margin: 8px 0;">"How much does it cost?"</p>
                                        <p style="color: #667eea;">→ She asked how much it cost.</p>
                                    </div>
                                    <div class="grid-card">
                                        <strong>WHO questions:</strong><br><br>
                                        <p style="margin: 8px 0;">"Who is your teacher?"</p>
                                        <p style="color: #667eea;">→ He asked who my teacher was.</p>
                                        <p style="margin: 8px 0;">"Who did you meet?"</p>
                                        <p style="color: #667eea;">→ She asked who I had met.</p>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="slide" data-section="examples">
                            <h2>Yes/No Question Examples</h2>
                            <div class="explanation-box">
                                <h3>Converting Yes/No Questions with IF/WHETHER:</h3>

                                <table class="comparison-table">
                                    <tr>
                                        <th>Direct Question</th>
                                        <th>Reported with IF</th>
                                        <th>Reported with WHETHER</th>
                                    </tr>
                                    <tr>
                                        <td>"Do you like pizza?"</td>
                                        <td>She asked if I liked pizza.</td>
                                        <td>She asked whether I liked pizza.</td>
                                    </tr>
                                    <tr>
                                        <td>"Are you ready?"</td>
                                        <td>He asked if I was ready.</td>
                                        <td>He asked whether I was ready.</td>
                                    </tr>
                                    <tr>
                                        <td>"Have you seen the movie?"</td>
                                        <td>She asked if I had seen the movie.</td>
                                        <td>She asked whether I had seen the movie.</td>
                                    </tr>
                                    <tr>
                                        <td>"Can you drive?"</td>
                                        <td>He asked if I could drive.</td>
                                        <td>He asked whether I could drive.</td>
                                    </tr>
                                    <tr>
                                        <td>"Will you come tomorrow?"</td>
                                        <td>She asked if I would come tomorrow.</td>
                                        <td>She asked whether I would come tomorrow.</td>
                                    </tr>
                                    <tr>
                                        <td>"Did you finish the work?"</td>
                                        <td>He asked if I had finished the work.</td>
                                        <td>He asked whether I had finished the work.</td>
                                    </tr>
                                </table>

                                <div class="rule-box">
                                    <h4>Remember:</h4>
                                    <p>• Both IF and WHETHER are correct</p>
                                    <p>• WHETHER sounds more formal</p>
                                    <p>• Always use statement order after if/whether</p>
                                </div>
                            </div>
                        </div>

                        <div class="slide" data-section="examples">
                            <h2>Command and Request Examples</h2>
                            <div class="explanation-box">
                                <h3>Commands, Requests, and Orders:</h3>

                                <div class="grid-examples">
                                    <div class="grid-card">
                                        <strong>TELL (commands/instructions):</strong><br><br>
                                        <p style="margin: 8px 0;">"Close the window."</p>
                                        <p style="color: #667eea;">→ She told me to close the window.</p>
                                        <p style="margin: 8px 0;">"Don't touch that!"</p>
                                        <p style="color: #667eea;">→ He told me not to touch that.</p>
                                        <p style="margin: 8px 0;">"Be quiet!"</p>
                                        <p style="color: #667eea;">→ The teacher told us to be quiet.</p>
                                    </div>
                                    <div class="grid-card">
                                        <strong>ASK (polite requests):</strong><br><br>
                                        <p style="margin: 8px 0;">"Could you help me, please?"</p>
                                        <p style="color: #667eea;">→ She asked me to help her.</p>
                                        <p style="margin: 8px 0;">"Please sit down."</p>
                                        <p style="color: #667eea;">→ He asked me to sit down.</p>
                                        <p style="margin: 8px 0;">"Would you call me later?"</p>
                                        <p style="color: #667eea;">→ She asked me to call her later.</p>
                                    </div>
                                </div>

                                <div class="grid-examples">
                                    <div class="grid-card">
                                        <strong>ORDER (strong commands):</strong><br><br>
                                        <p style="margin: 8px 0;">"Leave immediately!"</p>
                                        <p style="color: #667eea;">→ The officer ordered them to leave immediately.</p>
                                        <p style="margin: 8px 0;">"Stop talking!"</p>
                                        <p style="color: #667eea;">→ The guard ordered us to stop talking.</p>
                                        <p style="margin: 8px 0;">"Put your hands up!"</p>
                                        <p style="color: #667eea;">→ The police officer ordered him to put his hands up.</p>
                                    </div>
                                    <div class="grid-card">
                                        <strong>Other reporting verbs:</strong><br><br>
                                        <p style="margin: 8px 0;"><strong>Advise:</strong> "You should study more."</p>
                                        <p style="color: #667eea;">→ He advised me to study more.</p>
                                        <p style="margin: 8px 0;"><strong>Warn:</strong> "Don't go there!"</p>
                                        <p style="color: #667eea;">→ She warned me not to go there.</p>
                                        <p style="margin: 8px 0;"><strong>Beg:</strong> "Please help me!"</p>
                                        <p style="color: #667eea;">→ He begged me to help him.</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="slide-indicators" id="examples-indicators">
                        <span class="indicator-dot active" onclick="goToSlide(1)"></span>
                        <span class="indicator-dot" onclick="goToSlide(2)"></span>
                        <span class="indicator-dot" onclick="goToSlide(3)"></span>
                    </div>
                </div>
            </div>

            <!-- Reading Section -->
            <div class="section" id="reading">
                <div class="slideshow-container">
                    <div class="slide-content-wrapper">
                        <button class="slide-arrow prev" onclick="changeSlide(-1)">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                                <polyline points="15 18 9 12 15 6"></polyline>
                            </svg>
                        </button>
                        <button class="slide-arrow next" onclick="changeSlide(1)">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                                <polyline points="9 18 15 12 9 6"></polyline>
                            </svg>
                        </button>

                        <div class="slide active" data-section="reading">
                            <h2>Reading: A Job Interview</h2>
                            <div class="explanation-box">
                                <div class="reading-text">
                                    <p><strong>Sarah's Job Interview</strong></p>

                                    <p>Yesterday, Sarah had a job interview. When she arrived, the receptionist <span class="highlight-question">asked her to sit down</span> and wait. After a few minutes, the manager came out and <span class="highlight-question">asked her if she was nervous</span>. Sarah replied that she was a little nervous.</p>

                                    <p>During the interview, the manager <span class="highlight-question">asked her where she had worked before</span>. Sarah explained her previous experience. Then he <span class="highlight-question">asked why she wanted to work for his company</span>. She gave a detailed answer about her interest in the company.</p>

                                    <p>The manager also <span class="highlight-question">asked if she could work on weekends</span>. Sarah said yes. He <span class="highlight-question">asked when she could start</span>, and she told him she could start immediately. He <span class="highlight-question">wanted to know whether she had any questions</span>, so Sarah asked about the salary and benefits.</p>

                                    <p>At the end of the interview, the manager <span class="highlight-answer">told her to wait for a call within a week</span>. He also <span class="highlight-answer">asked her not to accept any other job offers</span> until she heard from them. He <span class="highlight-answer">told her to bring her documents</span> if she got the job.</p>

                                    <p>Sarah left feeling confident. The receptionist <span class="highlight-answer">told her to have a nice day</span> and <span class="highlight-answer">asked her to close the door on her way out</span>.</p>
                                </div>
                            </div>
                        </div>

                        <div class="slide" data-section="reading">
                            <h2>Reading Analysis</h2>
                            <div class="explanation-box">
                                <h3>Reported Questions in the Text:</h3>
                                <div class="example-box">
                                    <p><strong>Yes/No Questions (with IF/WHETHER):</strong></p>
                                    <p>• <strong>asked her if she was nervous</strong></p>
                                    <p style="margin-left: 20px; color: #666;">Direct: "Are you nervous?"</p>
                                    <p>• <strong>asked if she could work on weekends</strong></p>
                                    <p style="margin-left: 20px; color: #666;">Direct: "Can you work on weekends?"</p>
                                    <p>• <strong>wanted to know whether she had any questions</strong></p>
                                    <p style="margin-left: 20px; color: #666;">Direct: "Do you have any questions?"</p>
                                </div>

                                <div class="example-box">
                                    <p><strong>Wh-Questions:</strong></p>
                                    <p>• <strong>asked her where she had worked before</strong></p>
                                    <p style="margin-left: 20px; color: #666;">Direct: "Where did you work before?"</p>
                                    <p>• <strong>asked why she wanted to work for his company</strong></p>
                                    <p style="margin-left: 20px; color: #666;">Direct: "Why do you want to work for my company?"</p>
                                    <p>• <strong>asked when she could start</strong></p>
                                    <p style="margin-left: 20px; color: #666;">Direct: "When can you start?"</p>
                                </div>

                                <h3>Reported Commands/Requests in the Text:</h3>
                                <div class="example-box">
                                    <p><strong>Commands and Requests:</strong></p>
                                    <p>• <strong>asked her to sit down</strong> (polite request)</p>
                                    <p style="margin-left: 20px; color: #666;">Direct: "Please sit down."</p>
                                    <p>• <strong>told her to wait for a call</strong> (instruction)</p>
                                    <p style="margin-left: 20px; color: #666;">Direct: "Wait for a call within a week."</p>
                                    <p>• <strong>asked her not to accept any other job offers</strong> (negative request)</p>
                                    <p style="margin-left: 20px; color: #666;">Direct: "Please don't accept any other job offers."</p>
                                    <p>• <strong>told her to bring her documents</strong> (instruction)</p>
                                    <p style="margin-left: 20px; color: #666;">Direct: "Bring your documents if you get the job."</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="slide-indicators" id="reading-indicators">
                        <span class="indicator-dot active" onclick="goToSlide(1)"></span>
                        <span class="indicator-dot" onclick="goToSlide(2)"></span>
                    </div>
                </div>
            </div>

            <!-- Media Section -->
            <div class="section" id="media">
                <div class="slideshow-container">
                    <div class="slide-content-wrapper">
                        <button class="slide-arrow prev" onclick="changeSlide(-1)">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                                <polyline points="15 18 9 12 15 6"></polyline>
                            </svg>
                        </button>
                        <button class="slide-arrow next" onclick="changeSlide(1)">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                                <polyline points="9 18 15 12 9 6"></polyline>
                            </svg>
                        </button>

                        <div class="slide active" data-section="media">
                            <h2>Video: Reported Questions</h2>
                            <div class="explanation-box">
                                <p style="font-size: 1.1rem; margin-bottom: 20px;">Watch this video about Reported Questions:</p>
                                <div style="text-align: center; margin: 30px 0;">
                                    <iframe width="800" height="450"
                                        src="https://www.youtube.com/embed/3tmgU8y6HoM"
                                        style="border-radius: 15px; box-shadow: 0 8px 30px rgba(0,0,0,0.2);"
                                        frameborder="0"
                                        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                                        allowfullscreen>
                                    </iframe>
                                </div>
                                <p style="font-size: 1rem; color: #666; text-align: center; font-style: italic;">
                                    Learn how to report questions in English
                                </p>
                            </div>
                        </div>

                        <div class="slide" data-section="media">
                            <h2>Video: Reported Commands</h2>
                            <div class="explanation-box">
                                <p style="font-size: 1.1rem; margin-bottom: 20px;">Watch this video about Reported Commands and Requests:</p>
                                <div style="text-align: center; margin: 30px 0;">
                                    <iframe width="800" height="450"
                                        src="https://www.youtube.com/embed/BUReK-NVGvU"
                                        style="border-radius: 15px; box-shadow: 0 8px 30px rgba(0,0,0,0.2);"
                                        frameborder="0"
                                        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                                        allowfullscreen>
                                    </iframe>
                                </div>
                                <p style="font-size: 1rem; color: #666; text-align: center; font-style: italic;">
                                    Understanding how to report commands and requests
                                </p>
                            </div>
                        </div>
                    </div>
                    <div class="slide-indicators" id="media-indicators">
                        <span class="indicator-dot active" onclick="goToSlide(1)"></span>
                        <span class="indicator-dot" onclick="goToSlide(2)"></span>
                    </div>
                </div>
            </div>

            <!-- Practice Section -->
            <div class="section" id="practice">
                <div class="slideshow-container">
                    <div class="slide-content-wrapper">
                        <button class="slide-arrow prev" onclick="changeSlide(-1)">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                                <polyline points="15 18 9 12 15 6"></polyline>
                            </svg>
                        </button>
                        <button class="slide-arrow next" onclick="changeSlide(1)">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                                <polyline points="9 18 15 12 9 6"></polyline>
                            </svg>
                        </button>

                        <div class="slide active" data-section="practice">
                            <h2>Practice 1: Report the wh-question</h2>
                            <div class="exercise-container">
                                <div class="question-box">
                                    <p>Direct: "Where do you live?"<br>Reported: She asked where ___.</p>
                                    <input type="text" id="q1" placeholder="Type: I lived" onkeypress="if(event.key==='Enter') checkAnswer1()">
                                    <button class="check-button" onclick="checkAnswer1()">Check Answer</button>
                                    <div id="feedback1" class="feedback"></div>
                                </div>
                            </div>
                        </div>

                        <div class="slide" data-section="practice">
                            <h2>Practice 2: Report the yes/no question</h2>
                            <div class="exercise-container">
                                <div class="question-box">
                                    <p>Direct: "Do you like coffee?"<br>Reported: He asked ___ I liked coffee.</p>
                                    <input type="text" id="q2" placeholder="Type: if or whether" onkeypress="if(event.key==='Enter') checkAnswer2()">
                                    <button class="check-button" onclick="checkAnswer2()">Check Answer</button>
                                    <div id="feedback2" class="feedback"></div>
                                </div>
                            </div>
                        </div>

                        <div class="slide" data-section="practice">
                            <h2>Practice 3: Report the command</h2>
                            <div class="exercise-container">
                                <div class="question-box">
                                    <p>Direct: "Close the door!"<br>Reported: She told me ___ the door.</p>
                                    <input type="text" id="q3" placeholder="Type: to close" onkeypress="if(event.key==='Enter') checkAnswer3()">
                                    <button class="check-button" onclick="checkAnswer3()">Check Answer</button>
                                    <div id="feedback3" class="feedback"></div>
                                </div>
                            </div>
                        </div>

                        <div class="slide" data-section="practice">
                            <h2>Practice 4: Complete the reported question</h2>
                            <div class="exercise-container">
                                <div class="question-box">
                                    <p>Direct: "What are you doing?"<br>Reported: He asked what I ___ doing.</p>
                                    <input type="text" id="q4" placeholder="Type: was" onkeypress="if(event.key==='Enter') checkAnswer4()">
                                    <button class="check-button" onclick="checkAnswer4()">Check Answer</button>
                                    <div id="feedback4" class="feedback"></div>
                                </div>
                            </div>
                        </div>

                        <div class="slide" data-section="practice">
                            <h2>Practice 5: Report the negative command</h2>
                            <div class="exercise-container">
                                <div class="question-box">
                                    <p>Direct: "Don't be late!"<br>Reported: He told me ___ late.</p>
                                    <input type="text" id="q5" placeholder="Type: not to be" onkeypress="if(event.key==='Enter') checkAnswer5()">
                                    <button class="check-button" onclick="checkAnswer5()">Check Answer</button>
                                    <div id="feedback5" class="feedback"></div>
                                </div>
                            </div>
                        </div>

                        <div class="slide" data-section="practice">
                            <h2>Practice 6: Fix the mistake</h2>
                            <div class="exercise-container">
                                <div class="question-box">
                                    <p>Fix: "She asked where do I live." → "She asked where ___."</p>
                                    <input type="text" id="q6" placeholder="Type the correct form" onkeypress="if(event.key==='Enter') checkAnswer6()">
                                    <button class="check-button" onclick="checkAnswer6()">Check Answer</button>
                                    <div id="feedback6" class="feedback"></div>
                                </div>
                            </div>
                        </div>

                        <div class="slide" data-section="practice">
                            <h2>Practice 7: Report the request</h2>
                            <div class="exercise-container">
                                <div class="question-box">
                                    <p>Direct: "Could you help me, please?"<br>Reported: She asked me ___ her.</p>
                                    <input type="text" id="q7" placeholder="Type: to help" onkeypress="if(event.key==='Enter') checkAnswer7()">
                                    <button class="check-button" onclick="checkAnswer7()">Check Answer</button>
                                    <div id="feedback7" class="feedback"></div>
                                </div>
                            </div>
                        </div>

                        <div class="slide" data-section="practice">
                            <h2>Practice 8: Complete the reported question</h2>
                            <div class="exercise-container">
                                <div class="question-box">
                                    <p>Direct: "When will you arrive?"<br>Reported: He asked when I ___ arrive.</p>
                                    <input type="text" id="q8" placeholder="Type: would" onkeypress="if(event.key==='Enter') checkAnswer8()">
                                    <button class="check-button" onclick="checkAnswer8()">Check Answer</button>
                                    <div id="feedback8" class="feedback"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="slide-indicators" id="practice-indicators">
                        <span class="indicator-dot active" onclick="goToSlide(1)"></span>
                        <span class="indicator-dot" onclick="goToSlide(2)"></span>
                        <span class="indicator-dot" onclick="goToSlide(3)"></span>
                        <span class="indicator-dot" onclick="goToSlide(4)"></span>
                        <span class="indicator-dot" onclick="goToSlide(5)"></span>
                        <span class="indicator-dot" onclick="goToSlide(6)"></span>
                        <span class="indicator-dot" onclick="goToSlide(7)"></span>
                        <span class="indicator-dot" onclick="goToSlide(8)"></span>
                    </div>
                </div>
            </div>

            <!-- Writing Section -->
            <div class="section" id="writing">
                <div class="slideshow-container">
                    <div class="slide-content-wrapper">
                        <button class="slide-arrow prev" onclick="changeSlide(-1)">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                                <polyline points="15 18 9 12 15 6"></polyline>
                            </svg>
                        </button>
                        <button class="slide-arrow next" onclick="changeSlide(1)">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                                <polyline points="9 18 15 12 9 6"></polyline>
                            </svg>
                        </button>

                        <div class="slide active" data-section="writing" style="overflow-y: auto;">
                            <h2>Writing Practice</h2>
                            <div class="explanation-box">
                                <h3>Write a short story using reported questions and commands</h3>
                                <p style="margin-bottom: 15px;">Imagine a conversation you had recently. Report what people asked and told you to do. Use at least 5 reported questions and 5 reported commands/requests.</p>
                                <div class="question-box">
                                    <textarea id="writing1" rows="8" style="width: 100%; padding: 12px; border: 2px solid rgba(102, 126, 234, 0.3); border-radius: 8px; font-size: 1.05rem; font-family: 'Inter', sans-serif; resize: vertical;" spellcheck="true" placeholder="Example: Yesterday, my friend asked me where I was going. She wanted to know if I had time to meet. She told me to call her later. My boss asked when I would finish the project..."></textarea>
                                    <div style="display: flex; gap: 10px; margin-top: 10px;">
                                        <button class="check-button" onclick="checkGrammar()">Check Grammar</button>
                                        <button id="send-teacher-btn" class="check-button" onclick="sendToTeacher()" style="background: linear-gradient(135deg, #48bb78 0%, #38a169 100%); opacity: 0.5; cursor: not-allowed;" disabled>Send to Teacher</button>
                                    </div>
                                    <div id="grammar-feedback" style="margin-top: 15px; padding: 15px; border-radius: 8px; display: none;"></div>
                                    <p style="font-size: 0.95rem; color: #666; margin-top: 10px;">Include reported questions (wh-questions and yes/no questions) and reported commands/requests using tell, ask, order, etc.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="slide-indicators" id="writing-indicators">
                        <span class="indicator-dot active" onclick="goToSlide(1)"></span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let currentSlide = 1;
        let currentSection = 'explanation';

        function showSection(sectionName, element) {
            const sections = document.querySelectorAll('.section');
            sections.forEach(section => section.classList.remove('active'));

            const navItems = document.querySelectorAll('.nav-item');
            navItems.forEach(item => item.classList.remove('active'));

            document.getElementById(sectionName).classList.add('active');

            if (element) {
                element.classList.add('active');
            }

            currentSection = sectionName;
            currentSlide = 1;

            setTimeout(() => {
                const activeSection = document.querySelector('.section.active');
                const inputField = activeSection.querySelector('input[type="text"]');
                if (inputField) {
                    inputField.focus();
                }
            }, 100);
        }

        function changeSlide(direction) {
            const activeSection = document.querySelector('.section.active');
            const slides = activeSection.querySelectorAll('.slide');
            const dots = activeSection.querySelectorAll('.indicator-dot');

            if (slides.length === 1) return;

            slides[currentSlide - 1].classList.remove('active');
            dots[currentSlide - 1].classList.remove('active');

            currentSlide += direction;

            if (currentSlide > slides.length) {
                currentSlide = 1;
            }
            if (currentSlide < 1) {
                currentSlide = slides.length;
            }

            slides[currentSlide - 1].classList.add('active');
            dots[currentSlide - 1].classList.add('active');

            setTimeout(() => {
                const activeSlide = slides[currentSlide - 1];
                const inputField = activeSlide.querySelector('input[type="text"]');
                if (inputField) {
                    inputField.focus();
                    inputField.value = '';
                }
            }, 100);
        }

        function goToSlide(slideNum) {
            const activeSection = document.querySelector('.section.active');
            const slides = activeSection.querySelectorAll('.slide');
            const dots = activeSection.querySelectorAll('.indicator-dot');

            slides[currentSlide - 1].classList.remove('active');
            dots[currentSlide - 1].classList.remove('active');

            currentSlide = slideNum;

            slides[currentSlide - 1].classList.add('active');
            dots[currentSlide - 1].classList.add('active');
        }

        document.addEventListener('keydown', function(e) {
            if (e.key === 'ArrowLeft') {
                changeSlide(-1);
            } else if (e.key === 'ArrowRight') {
                changeSlide(1);
            }
        });

        function checkAnswer1() {
            const answer = document.getElementById('q1').value.trim().toLowerCase();
            const feedback = document.getElementById('feedback1');

            if (answer === 'i lived') {
                feedback.className = 'feedback correct';
                feedback.textContent = '✓ Perfect! "She asked where I lived" - Use statement order!';
                setTimeout(() => { changeSlide(1); }, 1500);
            } else {
                feedback.className = 'feedback incorrect';
                feedback.textContent = '✗ Use statement order: She asked where I lived';
            }
        }

        function checkAnswer2() {
            const answer = document.getElementById('q2').value.trim().toLowerCase();
            const feedback = document.getElementById('feedback2');

            if (answer === 'if' || answer === 'whether') {
                feedback.className = 'feedback correct';
                feedback.textContent = '✓ Excellent! Use IF or WHETHER for yes/no questions.';
                setTimeout(() => { changeSlide(1); }, 1500);
            } else {
                feedback.className = 'feedback incorrect';
                feedback.textContent = '✗ Use IF or WHETHER: He asked if/whether I liked coffee';
            }
        }

        function checkAnswer3() {
            const answer = document.getElementById('q3').value.trim().toLowerCase();
            const feedback = document.getElementById('feedback3');

            if (answer === 'to close') {
                feedback.className = 'feedback correct';
                feedback.textContent = '✓ Correct! "told me to close" - Use TO + infinitive for commands.';
                setTimeout(() => { changeSlide(1); }, 1500);
            } else {
                feedback.className = 'feedback incorrect';
                feedback.textContent = '✗ Use TO + infinitive: She told me to close the door';
            }
        }

        function checkAnswer4() {
            const answer = document.getElementById('q4').value.trim().toLowerCase();
            const feedback = document.getElementById('feedback4');

            if (answer === 'was') {
                feedback.className = 'feedback correct';
                feedback.textContent = '✓ Perfect! Change present continuous "am doing" → "was doing" (backshift)';
                setTimeout(() => { changeSlide(1); }, 1500);
            } else {
                feedback.className = 'feedback incorrect';
                feedback.textContent = '✗ Apply tense backshift: He asked what I was doing';
            }
        }

        function checkAnswer5() {
            const answer = document.getElementById('q5').value.trim().toLowerCase();
            const feedback = document.getElementById('feedback5');

            if (answer === 'not to be') {
                feedback.className = 'feedback correct';
                feedback.textContent = '✓ Excellent! For negative commands: NOT TO + infinitive';
                setTimeout(() => { changeSlide(1); }, 1500);
            } else {
                feedback.className = 'feedback incorrect';
                feedback.textContent = '✗ Use NOT TO: He told me not to be late';
            }
        }

        function checkAnswer6() {
            const answer = document.getElementById('q6').value.trim().toLowerCase();
            const feedback = document.getElementById('feedback6');

            if (answer === 'i lived' || answer === 'i live') {
                feedback.className = 'feedback correct';
                feedback.textContent = '✓ Great! Use statement order, not question order: She asked where I lived';
                setTimeout(() => { changeSlide(1); }, 1500);
            } else {
                feedback.className = 'feedback incorrect';
                feedback.textContent = '✗ Don\'t use question order! Correct: She asked where I lived';
            }
        }

        function checkAnswer7() {
            const answer = document.getElementById('q7').value.trim().toLowerCase();
            const feedback = document.getElementById('feedback7');

            if (answer === 'to help') {
                feedback.className = 'feedback correct';
                feedback.textContent = '✓ Perfect! For requests: asked + person + TO + infinitive';
                setTimeout(() => { changeSlide(1); }, 1500);
            } else {
                feedback.className = 'feedback incorrect';
                feedback.textContent = '✗ Use TO + infinitive: She asked me to help her';
            }
        }

        function checkAnswer8() {
            const answer = document.getElementById('q8').value.trim().toLowerCase();
            const feedback = document.getElementById('feedback8');

            if (answer === 'would') {
                feedback.className = 'feedback correct';
                feedback.textContent = '✓ Excellent! Change "will" → "would" in reported speech (backshift)';
                setTimeout(() => { changeSlide(1); }, 1500);
            } else {
                feedback.className = 'feedback incorrect';
                feedback.textContent = '✗ Apply backshift: will → would. He asked when I would arrive';
            }
        }

        async function checkGrammar() {
            const text = document.getElementById('writing1').value;
            const feedbackDiv = document.getElementById('grammar-feedback');
            const textarea = document.getElementById('writing1');

            if (!text.trim()) {
                feedbackDiv.style.display = 'block';
                feedbackDiv.style.background = 'rgba(245, 101, 101, 0.1)';
                feedbackDiv.style.border = '1px solid rgba(245, 101, 101, 0.3)';
                feedbackDiv.style.color = '#c53030';
                feedbackDiv.innerHTML = '✗ Please write some sentences first!';
                return;
            }

            textarea.style.display = 'none';
            window.grammarCheckResult = { original: text, corrected: '' };

            feedbackDiv.style.display = 'block';
            feedbackDiv.style.background = 'rgba(102, 126, 234, 0.1)';
            feedbackDiv.style.border = '1px solid rgba(102, 126, 234, 0.3)';
            feedbackDiv.style.color = '#667eea';
            feedbackDiv.innerHTML = '⏳ Checking your grammar and spelling...';

            try {
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=AIzaSyBTH0NmDb3cqjrY6p7YROPIJel-iCxSxzs`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        contents: [{
                            parts: [{
                                text: `You are a strict grammar checker. Fix grammar and spelling errors. Do not change the meaning, style, or add punctuation unless absolutely necessary. Profanities are acceptable, but don't use shortened informal words like "cuz" or "wanna"\n\nText: "${text}"\n\nReturn only the corrected text with minimal changes.`
                            }]
                        }]
                    })
                });

                const data = await response.json();
                const correctedText = data.candidates?.[0]?.content?.parts?.[0]?.text?.trim() || text;

                if (correctedText !== text && correctedText.toLowerCase() !== text.toLowerCase()) {
                    const originalWords = text.split(/(\s+)/);
                    const correctedWords = correctedText.split(/(\s+)/);
                    let highlightedText = '';

                    originalWords.forEach((word, i) => {
                        if (word.match(/\s+/)) {
                            highlightedText += word;
                        } else if (correctedWords[i] && word.toLowerCase() !== correctedWords[i].toLowerCase()) {
                            highlightedText += `<span style="color: #e53e3e; font-weight: 600; background: rgba(245, 101, 101, 0.15); padding: 2px 4px; border-radius: 3px;">${word}</span>`;
                        } else {
                            highlightedText += word;
                        }
                    });

                    let html = `
                        <div style="margin-bottom: 20px;">
                            <strong style="color: #c53030;">Your Text (errors highlighted):</strong>
                            <div style="background: white; padding: 15px; border-radius: 8px; margin-top: 10px; border: 2px solid rgba(245, 101, 101, 0.3); line-height: 1.8;">
                                ${highlightedText}
                            </div>
                        </div>
                        <div>
                            <strong style="color: #2f855a;">Corrected Text:</strong>
                            <div style="background: rgba(72, 187, 120, 0.1); padding: 15px; border-radius: 8px; margin-top: 10px; border: 2px solid rgba(72, 187, 120, 0.3); color: #2d3748; line-height: 1.8;">
                                ${correctedText}
                            </div>
                        </div>
                    `;

                    feedbackDiv.style.background = 'rgba(245, 101, 101, 0.05)';
                    feedbackDiv.style.border = '1px solid rgba(245, 101, 101, 0.3)';
                    feedbackDiv.style.color = '#2d3748';
                    feedbackDiv.innerHTML = html;

                    window.grammarCheckResult.corrected = correctedText;
                    const sendBtn = document.getElementById('send-teacher-btn');
                    sendBtn.disabled = false;
                    sendBtn.style.opacity = '1';
                    sendBtn.style.cursor = 'pointer';
                } else {
                    feedbackDiv.style.background = 'rgba(72, 187, 120, 0.1)';
                    feedbackDiv.style.border = '1px solid rgba(72, 187, 120, 0.3)';
                    feedbackDiv.style.color = '#2f855a';
                    feedbackDiv.innerHTML = '✓ Perfect! No grammar or spelling errors detected!';

                    window.grammarCheckResult.corrected = text;
                    const sendBtn = document.getElementById('send-teacher-btn');
                    sendBtn.disabled = false;
                    sendBtn.style.opacity = '1';
                    sendBtn.style.cursor = 'pointer';
                }
            } catch (error) {
                feedbackDiv.style.background = 'rgba(245, 101, 101, 0.1)';
                feedbackDiv.style.border = '1px solid rgba(245, 101, 101, 0.3)';
                feedbackDiv.style.color = '#c53030';
                feedbackDiv.innerHTML = '✗ Unable to check grammar. Error: ' + error.message;
            }
        }

        function sendToTeacher() {
            const essayTitle = "B1-53: Reported Speech - Questions & Commands";
            const originalText = window.grammarCheckResult.original;
            const correctedText = window.grammarCheckResult.corrected;

            const emailBody = `Essay Title: ${essayTitle}\n\nOriginal Essay:\n${originalText}\n\nWe made some changes:\n\nCorrected Text:\n${correctedText}`;
            const mailtoLink = `mailto:?subject=${encodeURIComponent(essayTitle)}&body=${encodeURIComponent(emailBody)}`;
            window.location.href = mailtoLink;
        }
    </script>
</body>
</html>
