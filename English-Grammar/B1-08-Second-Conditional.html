<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>B1-48: Second Conditional - Imaginary Present/Future</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            height: 100vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 20px 40px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
        }

        .header-left {
            display: flex;
            flex-direction: column;
        }

        .header h1 {
            color: #2d3748;
            font-size: 2.5rem;
            font-weight: 700;
            margin: 0;
            letter-spacing: -0.5px;
        }

        .header .website {
            text-align: center;
            margin-top: 8px;
        }

        .header .website a {
            color: #4c51bf;
            text-decoration: none;
            font-size: 1.2rem;
            font-weight: 500;
            transition: color 0.3s ease;
        }

        .header .website a:hover {
            color: #553c9a;
        }

        .header-image {
            width: 120px;
            height: 80px;
            border-radius: 12px;
            object-fit: cover;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.15);
        }

        .container {
            display: flex;
            height: calc(100vh - 120px);
        }

        .navigation {
            width: 280px;
            background: rgba(45, 55, 72, 0.95);
            backdrop-filter: blur(10px);
            padding: 30px 20px;
            border-right: 1px solid rgba(255, 255, 255, 0.1);
        }

        .nav-item {
            padding: 16px 24px;
            margin: 8px 0;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            color: #e2e8f0;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            text-align: center;
            font-weight: 500;
            font-size: 1.1rem;
            backdrop-filter: blur(5px);
        }

        .nav-item:hover {
            background: rgba(255, 255, 255, 0.2);
            color: #ffffff;
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
        }

        .nav-item.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #ffffff;
            border-color: transparent;
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
        }

        .content {
            flex: 1;
            display: flex;
            flex-direction: column;
            height: 100%;
            overflow: hidden;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
        }

        .section {
            display: none;
            flex: 1;
            padding: 0;
            overflow: hidden;
            height: 100%;
            background: white;
        }

        .section.active {
            display: flex;
            flex-direction: column;
        }

        .slideshow-container {
            position: relative;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background: white;
            padding: 30px 80px;
        }

        .slide-content-wrapper {
            position: relative;
            width: 100%;
            max-width: 1400px;
            height: 85%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .slide {
            display: none;
            width: 100%;
            height: 100%;
            background: white;
            border-radius: 20px;
            padding: 25px 35px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .slide.active {
            display: flex;
            flex-direction: column;
            animation: slideIn 0.5s ease-in-out;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(30px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .slide-arrow {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: #8B7EC8;
            color: white;
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            z-index: 10;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }

        .slide-arrow:hover {
            background: #7366B0;
            transform: translateY(-50%) scale(1.1);
        }

        .slide-arrow.prev {
            left: -70px;
        }

        .slide-arrow.next {
            right: -70px;
        }

        .slide-indicators {
            position: absolute;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 12px;
            z-index: 10;
        }

        .indicator-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #D1D5DB;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .indicator-dot.active {
            background: #667eea;
            transform: scale(1.3);
        }

        .indicator-dot:hover {
            background: #9CA3AF;
        }

        .slide h2 {
            color: #2d3748;
            margin-bottom: 15px;
            font-size: 2rem;
            font-weight: 700;
            text-align: center;
            letter-spacing: -0.5px;
        }

        .explanation-box {
            background: transparent;
            border: none;
            border-radius: 0;
            padding: 0;
            margin-bottom: 0;
            backdrop-filter: none;
            box-shadow: none;
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow-y: auto;
            overflow-x: hidden;
        }

        .explanation-box h3 {
            color: #667eea;
            font-size: 1.3rem;
            margin-bottom: 10px;
            font-weight: 600;
        }

        .explanation-box p {
            color: #2d3748;
            line-height: 1.5;
            font-size: 1rem;
            margin-bottom: 8px;
        }

        .rule-box {
            background: #e3f2fd;
            padding: 15px 20px;
            border-radius: 10px;
            margin: 10px 0;
            border-left: 4px solid #667eea;
        }

        .rule-box h4 {
            color: #667eea;
            font-size: 1.2rem;
            margin-bottom: 8px;
            font-weight: 600;
        }

        .rule-box p {
            font-size: 1rem;
            color: #2d3748;
            margin: 5px 0;
        }

        .yes-no {
            display: inline-block;
            padding: 6px 12px;
            margin: 3px;
            border-radius: 6px;
            font-weight: 600;
            font-size: 1rem;
            background: #4299e1;
            color: white;
        }

        .auxiliary {
            display: inline-block;
            padding: 6px 12px;
            margin: 3px;
            border-radius: 6px;
            font-weight: 600;
            font-size: 1rem;
            background: #48bb78;
            color: white;
        }

        .subject {
            display: inline-block;
            padding: 6px 12px;
            margin: 3px;
            border-radius: 6px;
            font-weight: 600;
            font-size: 1rem;
            background: #9f7aea;
            color: white;
        }

        .verb {
            display: inline-block;
            padding: 6px 12px;
            margin: 3px;
            border-radius: 6px;
            font-weight: 600;
            font-size: 1rem;
            background: #ed64a6;
            color: white;
        }

        .example-box {
            background: #f7fafc;
            border-left: 4px solid #667eea;
            padding: 12px;
            border-radius: 8px;
            margin: 8px 0;
        }

        .example-box p {
            margin: 5px 0;
            font-size: 1rem;
            color: #2d3748;
        }

        .note-box {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 12px;
            margin: 10px 0;
            border-radius: 8px;
        }

        .note-box strong {
            color: #856404;
            font-size: 1rem;
        }

        .note-box p {
            color: #856404;
            margin-top: 5px;
            line-height: 1.4;
            font-size: 0.95rem;
        }

        .exercise-container {
            background: transparent;
            border: none;
            border-radius: 0;
            padding: 0;
            margin-bottom: 10px;
            backdrop-filter: none;
            box-shadow: none;
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .exercise-container h3 {
            color: #764ba2;
            font-size: 1.4rem;
            margin-bottom: 15px;
            font-weight: 600;
        }

        .question-box {
            background: #e3f2fd;
            padding: 20px;
            border-radius: 12px;
            margin: 0;
        }

        .question-box p {
            font-weight: 600;
            color: #2d3748;
            margin-bottom: 12px;
            font-size: 1.1rem;
        }

        input[type="text"] {
            width: 100%;
            padding: 12px 18px;
            margin: 8px 0;
            border: 2px solid rgba(102, 126, 234, 0.3);
            border-radius: 8px;
            font-size: 1.05rem;
            font-family: 'Inter', sans-serif;
            background: rgba(255, 255, 255, 0.8);
            transition: all 0.3s ease;
        }

        input[type="text"]:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 20px rgba(102, 126, 234, 0.2);
        }

        .check-button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #ffffff;
            border: none;
            padding: 12px 30px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1.1rem;
            font-weight: 600;
            margin: 15px 5px 10px 5px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }

        .check-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
        }

        .feedback {
            padding: 15px 20px;
            border-radius: 12px;
            margin: 15px 0;
            font-weight: 500;
            font-size: 1.05rem;
            display: none;
        }

        .feedback.correct {
            background: rgba(72, 187, 120, 0.1);
            color: #2f855a;
            border: 1px solid rgba(72, 187, 120, 0.3);
            display: block;
        }

        .feedback.incorrect {
            background: rgba(245, 101, 101, 0.1);
            color: #c53030;
            border: 1px solid rgba(245, 101, 101, 0.3);
            display: block;
        }

        ul {
            margin-left: 25px;
            line-height: 1.6;
        }

        li {
            margin: 6px 0;
            font-size: 1.05rem;
            color: #2d3748;
        }

        li strong {
            color: #667eea;
        }

        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin: 12px 0;
        }

        .comparison-table th {
            background: #667eea;
            color: white;
            padding: 10px;
            font-size: 1.05rem;
            font-weight: 600;
        }

        .comparison-table td {
            padding: 10px;
            border: 1px solid #e2e8f0;
            font-size: 1rem;
            text-align: center;
        }

        .comparison-table tr:nth-child(even) {
            background: #f7fafc;
        }

        .explanation-box::-webkit-scrollbar {
            width: 8px;
        }

        .explanation-box::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }

        .explanation-box::-webkit-scrollbar-thumb {
            background: #667eea;
            border-radius: 10px;
        }

        .explanation-box::-webkit-scrollbar-thumb:hover {
            background: #5568d3;
        }

        .formula-box {
            background: #e6fffa;
            border: 2px solid #319795;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            text-align: center;
            font-size: 1.3rem;
        }

        .grid-examples {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .grid-card {
            background: white;
            padding: 15px;
            border-radius: 10px;
            border: 2px solid #e2e8f0;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .grid-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .reading-text {
            background: #f7fafc;
            padding: 20px;
            border-radius: 10px;
            line-height: 1.9;
            margin: 15px 0;
            border: 2px solid #e2e8f0;
        }

        .reading-text p {
            margin: 12px 0;
        }

        .highlight-question {
            background: #bee3f8;
            padding: 2px 6px;
            border-radius: 4px;
            font-weight: bold;
        }

        .highlight-answer {
            background: #c6f6d5;
            padding: 2px 6px;
            border-radius: 4px;
            font-weight: bold;
        }

        .example-sentence {
            font-size: 1.1rem;
            margin: 10px 0;
            padding: 10px;
            background: white;
            border-radius: 8px;
            border-left: 3px solid #667eea;
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="header-left">
            <h1>B1-48: Second Conditional - Imaginary Present/Future</h1>
            <div class="website">
                <a href="https://www.mimlanguageservices.com/" target="_blank">mimlanguageservices</a>
            </div>
        </div>
        <a href="https://www.mimlanguageservices.com/" target="_blank">
            <img src="https://static.wixstatic.com/media/593d03_8958d96b0f6d4d1ea9dffa7f89bffe8b~mv2.png" alt="ESL Logo" class="header-image">
        </a>
    </div>

    <div class="container">
        <div class="navigation">
            <div class="nav-item active" onclick="showSection('explanation', this)">Explanation</div>
            <div class="nav-item" onclick="showSection('examples', this)">Examples</div>
            <div class="nav-item" onclick="showSection('reading', this)">Reading</div>
            <div class="nav-item" onclick="showSection('media', this)">Media</div>
            <div class="nav-item" onclick="showSection('practice', this)">Practice</div>
            <div class="nav-item" onclick="showSection('writing', this)">Writing</div>
        </div>

        <div class="content">
            <!-- Explanation Section -->
            <div class="section active" id="explanation">
                <div class="slideshow-container">
                    <div class="slide-content-wrapper">
                        <button class="slide-arrow prev" onclick="changeSlide(-1)">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                                <polyline points="15 18 9 12 15 6"></polyline>
                            </svg>
                        </button>
                        <button class="slide-arrow next" onclick="changeSlide(1)">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                                <polyline points="9 18 15 12 9 6"></polyline>
                            </svg>
                        </button>

                        <div class="slide active" data-section="explanation">
                            <h2>Welcome to Second Conditional!</h2>
                            <div class="explanation-box">
                                <p style="font-size: 1.2rem; text-align: center; margin: 20px 0;">
                                    Today we will learn the <span class="yes-no">SECOND CONDITIONAL</span> in English!
                                </p>
                                <p style="font-size: 1.1rem; text-align: center;">
                                    This structure describes IMAGINARY or UNLIKELY situations in the present or future.
                                </p>
                                <div class="formula-box">
                                    <span class="auxiliary">IF</span> + <span class="verb">PAST SIMPLE</span>, <span class="subject">WOULD</span> + <span class="verb">BASE VERB</span>
                                </div>
                                <p style="text-align: center; font-size: 1.1rem;">
                                    Example: If I <strong>had</strong> a million dollars, I <strong>would buy</strong> a house. / If she <strong>were</strong> here, she <strong>would help</strong> us.
                                </p>
                            </div>
                        </div>

                        <div class="slide" data-section="explanation">
                            <h2>How to Form the Second Conditional</h2>
                            <div class="explanation-box">
                                <h3>The Structure</h3>

                                <div class="formula-box">
                                    <span class="auxiliary">IF</span> + <span class="subject">subject</span> + <span class="verb">past simple</span>, <span class="subject">subject</span> + <span class="auxiliary">would</span> + <span class="verb">base verb</span>
                                </div>

                                <table class="comparison-table">
                                    <tr>
                                        <th>If Clause (Imaginary Condition)</th>
                                        <th>Result Clause</th>
                                        <th>Full Sentence</th>
                                    </tr>
                                    <tr>
                                        <td>If I had money</td>
                                        <td>I would travel</td>
                                        <td>If I had money, I would travel.</td>
                                    </tr>
                                    <tr>
                                        <td>If she were rich</td>
                                        <td>she would help people</td>
                                        <td>If she were rich, she would help people.</td>
                                    </tr>
                                    <tr>
                                        <td>If we lived in Paris</td>
                                        <td>we would visit museums</td>
                                        <td>If we lived in Paris, we would visit museums.</td>
                                    </tr>
                                </table>

                                <div class="rule-box">
                                    <h4>Remember:</h4>
                                    <p>• IF clause = PAST SIMPLE (but refers to now/future!)</p>
                                    <p>• Result clause = WOULD + base verb</p>
                                    <p>• The situation is IMAGINARY or UNLIKELY</p>
                                </div>
                            </div>
                        </div>

                        <div class="slide" data-section="explanation">
                            <h2>Special Case: "Were" for All Subjects</h2>
                            <div class="explanation-box">
                                <h3>Use "were" instead of "was" in formal Second Conditional</h3>

                                <div class="formula-box">
                                    <span class="auxiliary">IF</span> + I/he/she/it + <span class="verb">WERE</span>
                                </div>

                                <table class="comparison-table">
                                    <tr>
                                        <th>Formal (Correct)</th>
                                        <th>Informal (Also accepted)</th>
                                    </tr>
                                    <tr>
                                        <td>If I were rich, I would travel the world.</td>
                                        <td>If I was rich, I would travel the world.</td>
                                    </tr>
                                    <tr>
                                        <td>If he were here, he would know what to do.</td>
                                        <td>If he was here, he would know what to do.</td>
                                    </tr>
                                    <tr>
                                        <td>If she were the boss, she would change things.</td>
                                        <td>If she was the boss, she would change things.</td>
                                    </tr>
                                </table>

                                <div class="rule-box">
                                    <h4>Key Point:</h4>
                                    <p>• Use "WERE" for all subjects (I, he, she, it, we, you, they)</p>
                                    <p>• This is the grammatically correct form</p>
                                    <p>• "Was" is acceptable in casual speech</p>
                                </div>
                            </div>
                        </div>

                        <div class="slide" data-section="explanation">
                            <h2>Use 1: Imaginary Present Situations</h2>
                            <div class="explanation-box">
                                <h3>Talking about things that are NOT true now</h3>

                                <div class="formula-box">
                                    <span class="auxiliary">IF</span> + <span class="verb">imaginary condition</span>, <span class="auxiliary">WOULD</span> + <span class="verb">imaginary result</span>
                                </div>

                                <table class="comparison-table">
                                    <tr>
                                        <th>Second Conditional</th>
                                        <th>Reality</th>
                                    </tr>
                                    <tr>
                                        <td>If I had a car, I would drive to work.</td>
                                        <td>But I don't have a car, so I can't drive to work.</td>
                                    </tr>
                                    <tr>
                                        <td>If she spoke French, she would get the job.</td>
                                        <td>But she doesn't speak French, so she won't get it.</td>
                                    </tr>
                                    <tr>
                                        <td>If we lived near the beach, we would swim every day.</td>
                                        <td>But we don't live near the beach, so we don't swim daily.</td>
                                    </tr>
                                </table>

                                <div class="rule-box">
                                    <h4>Key Point:</h4>
                                    <p>• The situation is OPPOSITE to reality</p>
                                    <p>• We use it to imagine different circumstances</p>
                                    <p>• It's about the PRESENT, not the past!</p>
                                </div>
                            </div>
                        </div>

                        <div class="slide" data-section="explanation">
                            <h2>Use 2: Unlikely Future Situations</h2>
                            <div class="explanation-box">
                                <h3>Talking about things that probably won't happen</h3>

                                <div class="formula-box">
                                    <span class="auxiliary">IF</span> + <span class="verb">unlikely condition</span>, <span class="auxiliary">WOULD</span> + <span class="verb">result</span>
                                </div>

                                <table class="comparison-table">
                                    <tr>
                                        <th>Second Conditional (unlikely)</th>
                                        <th>First Conditional (possible)</th>
                                    </tr>
                                    <tr>
                                        <td>If I won the lottery, I would quit my job.</td>
                                        <td>If I finish early, I will go home.</td>
                                    </tr>
                                    <tr>
                                        <td>Very unlikely to happen</td>
                                        <td>Real possibility</td>
                                    </tr>
                                    <tr>
                                        <td>If aliens landed on Earth, we would be shocked.</td>
                                        <td>If it rains, I will take an umbrella.</td>
                                    </tr>
                                    <tr>
                                        <td>Almost impossible</td>
                                        <td>Might really happen</td>
                                    </tr>
                                </table>

                                <div class="rule-box">
                                    <h4>Key Point:</h4>
                                    <p>• Use Second Conditional for UNLIKELY events</p>
                                    <p>• Use First Conditional for POSSIBLE events</p>
                                    <p>• It's about probability, not just grammar</p>
                                </div>
                            </div>
                        </div>

                        <div class="slide" data-section="explanation">
                            <h2>Common Mistakes</h2>
                            <div class="explanation-box">
                                <h3>Mistake 1: Using "would" in the IF clause</h3>
                                <div class="example-box">
                                    <p>❌ If I <del>would have</del> money, I would travel. → ✅ If I <strong>had</strong> money, I would travel.</p>
                                    <p><strong>Note:</strong> Never use "would" in the IF clause!</p>
                                </div>

                                <h3>Mistake 2: Using present tense instead of past</h3>
                                <div class="example-box">
                                    <p>❌ If I <del>have</del> time, I would help. → ✅ If I <strong>had</strong> time, I would help.</p>
                                    <p><strong>Note:</strong> IF clause needs PAST SIMPLE, not present</p>
                                </div>

                                <h3>Mistake 3: Confusing First and Second Conditional</h3>
                                <div class="example-box">
                                    <p>❌ If I have a million dollars (real), I would buy a house (imaginary).</p>
                                    <p>✅ If I <strong>had</strong> a million dollars, I <strong>would buy</strong> a house. (both imaginary)</p>
                                    <p>✅ If I <strong>win</strong> the lottery, I <strong>will buy</strong> a house. (both real possibility)</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="slide-indicators" id="explanation-indicators">
                        <span class="indicator-dot active" onclick="goToSlide(1)"></span>
                        <span class="indicator-dot" onclick="goToSlide(2)"></span>
                        <span class="indicator-dot" onclick="goToSlide(3)"></span>
                        <span class="indicator-dot" onclick="goToSlide(4)"></span>
                        <span class="indicator-dot" onclick="goToSlide(5)"></span>
                        <span class="indicator-dot" onclick="goToSlide(6)"></span>
                    </div>
                </div>
            </div>

            <!-- Examples Section -->
            <div class="section" id="examples">
                <div class="slideshow-container">
                    <div class="slide-content-wrapper">
                        <button class="slide-arrow prev" onclick="changeSlide(-1)">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                                <polyline points="15 18 9 12 15 6"></polyline>
                            </svg>
                        </button>
                        <button class="slide-arrow next" onclick="changeSlide(1)">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                                <polyline points="9 18 15 12 9 6"></polyline>
                            </svg>
                        </button>

                        <div class="slide active" data-section="examples">
                            <h2>Detailed Examples: Dreams and Wishes</h2>
                            <div class="explanation-box">
                                <div class="grid-examples">
                                    <div class="grid-card">
                                        <strong>Money & Wealth:</strong><br><br>
                                        • If I won the lottery, I <strong>would travel</strong> the world.<br>
                                        • If I were rich, I <strong>would donate</strong> to charity.<br>
                                    </div>
                                    <div class="grid-card">
                                        <strong>Different Life:</strong><br><br>
                                        • If I lived in Paris, I <strong>would learn</strong> French.<br>
                                        • If I had more time, I <strong>would exercise</strong> daily.<br>
                                    </div>
                                    <div class="grid-card">
                                        <strong>Superpowers:</strong><br><br>
                                        • If I could fly, I <strong>would visit</strong> every country.<br>
                                        • If I were invisible, I <strong>would play</strong> pranks.<br>
                                    </div>
                                    <div class="grid-card">
                                        <strong>Advice:</strong><br><br>
                                        • If I were you, I <strong>would apologize</strong>.<br>
                                        • If I were in your position, I <strong>would quit</strong>.<br>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="slide" data-section="examples">
                            <h2>First Conditional vs. Second Conditional</h2>
                            <div class="explanation-box">
                                <table class="comparison-table">
                                    <tr>
                                        <th>First Conditional (Real/Possible)</th>
                                        <th>Second Conditional (Imaginary/Unlikely)</th>
                                    </tr>
                                    <tr>
                                        <td>If it rains tomorrow, I will stay home.</td>
                                        <td>If it rained every day, I would move.</td>
                                    </tr>
                                    <tr>
                                        <td>It might really rain - real possibility</td>
                                        <td>It doesn't rain every day - imaginary</td>
                                    </tr>
                                    <tr>
                                        <td>If I see him, I will tell him.</td>
                                        <td>If I saw him every day, I would be happy.</td>
                                    </tr>
                                    <tr>
                                        <td>I might see him - possible</td>
                                        <td>I don't see him every day - imaginary</td>
                                    </tr>
                                    <tr>
                                        <td>If you study hard, you will pass.</td>
                                        <td>If you studied harder, you would get better grades.</td>
                                    </tr>
                                    <tr>
                                        <td>You can study hard - it's possible</td>
                                        <td>You don't study hard enough now - contrary to reality</td>
                                    </tr>
                                </table>

                                <div class="rule-box">
                                    <h4>Remember:</h4>
                                    <p>• FIRST CONDITIONAL = Real possibility (if/will)</p>
                                    <p>• SECOND CONDITIONAL = Imaginary/unlikely (if/would)</p>
                                </div>
                            </div>
                        </div>

                        <div class="slide" data-section="examples">
                            <h2>Second Conditional with Other Modals</h2>
                            <div class="explanation-box">
                                <h3>Not just "would" - use other modals too!</h3>
                                <div class="example-box">
                                    <p>• <strong>COULD:</strong> If I had wings, I <strong>could</strong> fly.</p>
                                    <p>• <strong>MIGHT:</strong> If she knew the truth, she <strong>might</strong> be angry.</p>
                                    <p>• <strong>SHOULD:</strong> If you were sick, you <strong>should</strong> see a doctor.</p>
                                    <p>• <strong>Common phrase:</strong> If I were you, I would/wouldn't...</p>
                                </div>

                                <div class="rule-box">
                                    <h4>Remember:</h4>
                                    <p>• The IF clause stays in PAST SIMPLE</p>
                                    <p>• You can change the modal in the result clause</p>
                                    <p>• "If I were you" is used for giving advice</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="slide-indicators" id="examples-indicators">
                        <span class="indicator-dot active" onclick="goToSlide(1)"></span>
                        <span class="indicator-dot" onclick="goToSlide(2)"></span>
                        <span class="indicator-dot" onclick="goToSlide(3)"></span>
                    </div>
                </div>
            </div>

            <!-- Reading Section -->
            <div class="section" id="reading">
                <div class="slideshow-container">
                    <div class="slide-content-wrapper">
                        <button class="slide-arrow prev" onclick="changeSlide(-1)">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                                <polyline points="15 18 9 12 15 6"></polyline>
                            </svg>
                        </button>
                        <button class="slide-arrow next" onclick="changeSlide(1)">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                                <polyline points="9 18 15 12 9 6"></polyline>
                            </svg>
                        </button>

                        <div class="slide active" data-section="reading">
                            <h2>Reading: Dreams of a Different Life</h2>
                            <div class="explanation-box">
                                <div class="reading-text">
                                    <p><strong>Marcus's Daydreams</strong></p>

                                    <p>Marcus often thinks about how his life could be different. He loves to imagine impossible scenarios and unlikely situations.</p>

                                    <p><span class="highlight-question">If Marcus won the lottery</span>, he <span class="highlight-answer">would quit</span> his boring office job immediately. He <span class="highlight-answer">would buy</span> a beautiful villa by the ocean and spend his days reading books on the beach. <span class="highlight-question">If he had</span> all that money, he <span class="highlight-answer">would also help</span> his family and donate to charity.</p>

                                    <p>Sometimes Marcus dreams about having special abilities. <span class="highlight-question">If he could fly</span>, he <span class="highlight-answer">would travel</span> to every country in the world without paying for plane tickets. <span class="highlight-question">If he were invisible</span>, he <span class="highlight-answer">would sneak</span> into concerts and shows for free, though he knows that would be wrong!</p>

                                    <p>Marcus also thinks about moving to a different place. <span class="highlight-question">If he lived in Japan</span>, he <span class="highlight-answer">would learn</span> Japanese and study martial arts. <span class="highlight-question">If he had</span> the courage to move abroad, his life <span class="highlight-answer">would be</span> completely different. But for now, he's too afraid to leave his hometown.</p>

                                    <p>When Marcus talks to his friends about their problems, he often gives advice. He says things like, "<span class="highlight-question">If I were you</span>, I <span class="highlight-answer">would talk</span> to your boss," or "<span class="highlight-question">If I were in your position</span>, I <span class="highlight-answer">would look</span> for a new job." It's easier to give advice than to make big changes in his own life.</p>

                                    <p>Deep down, Marcus knows these are just dreams. He doesn't have millions of dollars, he can't fly, and he probably won't move to Japan. But it's fun to imagine. <span class="highlight-question">If life were</span> more exciting, maybe he <span class="highlight-answer">wouldn't need</span> to daydream so much!</p>
                                </div>
                            </div>
                        </div>

                        <div class="slide" data-section="reading">
                            <h2>Reading Analysis</h2>
                            <div class="explanation-box">
                                <h3>Notice the Pattern:</h3>
                                <div class="example-box">
                                    <p>• All situations are IMAGINARY or OPPOSITE to reality</p>
                                    <p>• IF clause uses PAST SIMPLE</p>
                                    <p>• Result clause uses WOULD + base verb</p>
                                    <p>• Shows dreams, wishes, and unlikely scenarios</p>
                                </div>

                                <h3>Key Sentences Explained:</h3>
                                <div class="example-box">
                                    <p>• "If Marcus won the lottery, he <strong>would quit</strong>" - He hasn't won, so he can't quit</p>
                                    <p>• "If he could fly, he <strong>would travel</strong>" - He can't fly, so this is impossible</p>
                                    <p>• "If I were you, I <strong>would talk</strong>" - Classic advice structure</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="slide-indicators" id="reading-indicators">
                        <span class="indicator-dot active" onclick="goToSlide(1)"></span>
                        <span class="indicator-dot" onclick="goToSlide(2)"></span>
                    </div>
                </div>
            </div>

            <!-- Media Section -->
            <div class="section" id="media">
                <div class="slideshow-container">
                    <div class="slide-content-wrapper">
                        <button class="slide-arrow prev" onclick="changeSlide(-1)">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                                <polyline points="15 18 9 12 15 6"></polyline>
                            </svg>
                        </button>
                        <button class="slide-arrow next" onclick="changeSlide(1)">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                                <polyline points="9 18 15 12 9 6"></polyline>
                            </svg>
                        </button>

                        <div class="slide active" data-section="media">
                            <h2>Video: Second Conditional Explained</h2>
                            <div class="explanation-box">
                                <p style="font-size: 1.1rem; margin-bottom: 20px;">Watch this video about the Second Conditional:</p>
                                <div style="text-align: center; margin: 30px 0;">
                                    <iframe width="800" height="450"
                                        src="https://www.youtube.com/embed/SQNLkSdmNMo"
                                        style="border-radius: 15px; box-shadow: 0 8px 30px rgba(0,0,0,0.2);"
                                        frameborder="0"
                                        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                                        allowfullscreen>
                                    </iframe>
                                </div>
                                <p style="font-size: 1rem; color: #666; text-align: center; font-style: italic;">
                                    Learn how to form and use the Second Conditional
                                </p>
                            </div>
                        </div>

                        <div class="slide" data-section="media">
                            <h2>Video: Second Conditional Practice</h2>
                            <div class="explanation-box">
                                <p style="font-size: 1.1rem; margin-bottom: 20px;">Second Conditional with exercises:</p>
                                <div style="text-align: center; margin: 30px 0;">
                                    <iframe width="800" height="450"
                                        src="https://www.youtube.com/embed/S_0ysQ3H1rY"
                                        style="border-radius: 15px; box-shadow: 0 8px 30px rgba(0,0,0,0.2);"
                                        frameborder="0"
                                        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                                        allowfullscreen>
                                    </iframe>
                                </div>
                                <p style="font-size: 1rem; color: #666; text-align: center; font-style: italic;">
                                    Understanding when to use Second Conditional
                                </p>
                            </div>
                        </div>
                    </div>
                    <div class="slide-indicators" id="media-indicators">
                        <span class="indicator-dot active" onclick="goToSlide(1)"></span>
                        <span class="indicator-dot" onclick="goToSlide(2)"></span>
                    </div>
                </div>
            </div>

            <!-- Practice Section -->
            <div class="section" id="practice">
                <div class="slideshow-container">
                    <div class="slide-content-wrapper">
                        <button class="slide-arrow prev" onclick="changeSlide(-1)">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                                <polyline points="15 18 9 12 15 6"></polyline>
                            </svg>
                        </button>
                        <button class="slide-arrow next" onclick="changeSlide(1)">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                                <polyline points="9 18 15 12 9 6"></polyline>
                            </svg>
                        </button>

                        <div class="slide active" data-section="practice">
                            <h2>Practice 1: Complete the IF clause</h2>
                            <div class="exercise-container">
                                <div class="question-box">
                                    <p>"If I ___ rich, I would buy a yacht." (be)</p>
                                    <input type="text" id="q1" placeholder="Type: were or was" onkeypress="if(event.key==='Enter') checkAnswer1()">
                                    <button class="check-button" onclick="checkAnswer1()">Check Answer</button>
                                    <div id="feedback1" class="feedback"></div>
                                </div>
                            </div>
                        </div>

                        <div class="slide" data-section="practice">
                            <h2>Practice 2: Result clause</h2>
                            <div class="exercise-container">
                                <div class="question-box">
                                    <p>"If you had a car, you ___ ___ to work." (would + drive)</p>
                                    <input type="text" id="q2" placeholder="Type: would drive" onkeypress="if(event.key==='Enter') checkAnswer2()">
                                    <button class="check-button" onclick="checkAnswer2()">Check Answer</button>
                                    <div id="feedback2" class="feedback"></div>
                                </div>
                            </div>
                        </div>

                        <div class="slide" data-section="practice">
                            <h2>Practice 3: Complete both parts</h2>
                            <div class="exercise-container">
                                <div class="question-box">
                                    <p>"If she ___ French, she ___ ___ the job." (speak / would + get)</p>
                                    <input type="text" id="q3" placeholder="Type: spoke, would get" onkeypress="if(event.key==='Enter') checkAnswer3()">
                                    <button class="check-button" onclick="checkAnswer3()">Check Answer</button>
                                    <div id="feedback3" class="feedback"></div>
                                </div>
                            </div>
                        </div>

                        <div class="slide" data-section="practice">
                            <h2>Practice 4: Fix the mistake</h2>
                            <div class="exercise-container">
                                <div class="question-box">
                                    <p>Fix: "If I would have time, I would help you." → "___"</p>
                                    <input type="text" id="q4" placeholder="Type the correct sentence" onkeypress="if(event.key==='Enter') checkAnswer4()">
                                    <button class="check-button" onclick="checkAnswer4()">Check Answer</button>
                                    <div id="feedback4" class="feedback"></div>
                                </div>
                            </div>
                        </div>

                        <div class="slide" data-section="practice">
                            <h2>Practice 5: First or Second Conditional?</h2>
                            <div class="exercise-container">
                                <div class="question-box">
                                    <p>"If I ___ the lottery, I would quit my job." (win - unlikely event)</p>
                                    <input type="text" id="q5" placeholder="Type: won" onkeypress="if(event.key==='Enter') checkAnswer5()">
                                    <button class="check-button" onclick="checkAnswer5()">Check Answer</button>
                                    <div id="feedback5" class="feedback"></div>
                                </div>
                            </div>
                        </div>

                        <div class="slide" data-section="practice">
                            <h2>Practice 6: Giving advice</h2>
                            <div class="exercise-container">
                                <div class="question-box">
                                    <p>"If I ___ you, I would apologize." (be)</p>
                                    <input type="text" id="q6" placeholder="Type: were" onkeypress="if(event.key==='Enter') checkAnswer6()">
                                    <button class="check-button" onclick="checkAnswer6()">Check Answer</button>
                                    <div id="feedback6" class="feedback"></div>
                                </div>
                            </div>
                        </div>

                        <div class="slide" data-section="practice">
                            <h2>Practice 7: Negative form</h2>
                            <div class="exercise-container">
                                <div class="question-box">
                                    <p>"If I ___ ___ so busy, I would exercise more." (not + be)</p>
                                    <input type="text" id="q7" placeholder="Type: weren't or wasn't" onkeypress="if(event.key==='Enter') checkAnswer7()">
                                    <button class="check-button" onclick="checkAnswer7()">Check Answer</button>
                                    <div id="feedback7" class="feedback"></div>
                                </div>
                            </div>
                        </div>

                        <div class="slide" data-section="practice">
                            <h2>Practice 8: Your own sentence</h2>
                            <div class="exercise-container">
                                <div class="question-box">
                                    <p>"If I could fly, I ___ ___." (complete with your own idea)</p>
                                    <input type="text" id="q8" placeholder="Type: would + verb..." onkeypress="if(event.key==='Enter') checkAnswer8()">
                                    <button class="check-button" onclick="checkAnswer8()">Check Answer</button>
                                    <div id="feedback8" class="feedback"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="slide-indicators" id="practice-indicators">
                        <span class="indicator-dot active" onclick="goToSlide(1)"></span>
                        <span class="indicator-dot" onclick="goToSlide(2)"></span>
                        <span class="indicator-dot" onclick="goToSlide(3)"></span>
                        <span class="indicator-dot" onclick="goToSlide(4)"></span>
                        <span class="indicator-dot" onclick="goToSlide(5)"></span>
                        <span class="indicator-dot" onclick="goToSlide(6)"></span>
                        <span class="indicator-dot" onclick="goToSlide(7)"></span>
                        <span class="indicator-dot" onclick="goToSlide(8)"></span>
                    </div>
                </div>
            </div>

            <!-- Writing Section -->
            <div class="section" id="writing">
                <div class="slideshow-container">
                    <div class="slide-content-wrapper">
                        <button class="slide-arrow prev" onclick="changeSlide(-1)">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                                <polyline points="15 18 9 12 15 6"></polyline>
                            </svg>
                        </button>
                        <button class="slide-arrow next" onclick="changeSlide(1)">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                                <polyline points="9 18 15 12 9 6"></polyline>
                            </svg>
                        </button>

                        <div class="slide active" data-section="writing" style="overflow-y: auto;">
                            <h2>Writing Practice</h2>
                            <div class="explanation-box">
                                <h3>Write about your dreams and imaginary situations</h3>
                                <p style="margin-bottom: 15px;">Use the Second Conditional to describe what you would do in imaginary situations.</p>
                                <div class="question-box">
                                    <textarea id="writing1" rows="8" style="width: 100%; padding: 12px; border: 2px solid rgba(102, 126, 234, 0.3); border-radius: 8px; font-size: 1.05rem; font-family: 'Inter', sans-serif; resize: vertical;" spellcheck="true" placeholder="If I won the lottery, I would buy a big house. If I could fly, I would visit every country. If I were famous..."></textarea>
                                    <div style="display: flex; gap: 10px; margin-top: 10px;">
                                        <button class="check-button" onclick="checkGrammar()">Check Grammar</button>
                                        <button id="send-teacher-btn" class="check-button" onclick="sendToTeacher()" style="background: linear-gradient(135deg, #48bb78 0%, #38a169 100%); opacity: 0.5; cursor: not-allowed;" disabled>Send to Teacher</button>
                                    </div>
                                    <div id="grammar-feedback" style="margin-top: 15px; padding: 15px; border-radius: 8px; display: none;"></div>
                                    <p style="font-size: 0.95rem; color: #666; margin-top: 10px;">Example: If I had a time machine, I would visit the past. If I were invisible, I would play pranks on my friends.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="slide-indicators" id="writing-indicators">
                        <span class="indicator-dot active" onclick="goToSlide(1)"></span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let currentSlide = 1;
        let currentSection = 'explanation';

        function showSection(sectionName, element) {
            const sections = document.querySelectorAll('.section');
            sections.forEach(section => section.classList.remove('active'));

            const navItems = document.querySelectorAll('.nav-item');
            navItems.forEach(item => item.classList.remove('active'));

            document.getElementById(sectionName).classList.add('active');

            if (element) {
                element.classList.add('active');
            }

            currentSection = sectionName;
            currentSlide = 1;

            setTimeout(() => {
                const activeSection = document.querySelector('.section.active');
                const inputField = activeSection.querySelector('input[type="text"]');
                if (inputField) {
                    inputField.focus();
                }
            }, 100);
        }

        function changeSlide(direction) {
            const activeSection = document.querySelector('.section.active');
            const slides = activeSection.querySelectorAll('.slide');
            const dots = activeSection.querySelectorAll('.indicator-dot');

            if (slides.length === 1) return;

            slides[currentSlide - 1].classList.remove('active');
            dots[currentSlide - 1].classList.remove('active');

            currentSlide += direction;

            if (currentSlide > slides.length) {
                currentSlide = 1;
            }
            if (currentSlide < 1) {
                currentSlide = slides.length;
            }

            slides[currentSlide - 1].classList.add('active');
            dots[currentSlide - 1].classList.add('active');

            setTimeout(() => {
                const activeSlide = slides[currentSlide - 1];
                const inputField = activeSlide.querySelector('input[type="text"]');
                if (inputField) {
                    inputField.focus();
                    inputField.value = '';
                }
            }, 100);
        }

        function goToSlide(slideNum) {
            const activeSection = document.querySelector('.section.active');
            const slides = activeSection.querySelectorAll('.slide');
            const dots = activeSection.querySelectorAll('.indicator-dot');

            slides[currentSlide - 1].classList.remove('active');
            dots[currentSlide - 1].classList.remove('active');

            currentSlide = slideNum;

            slides[currentSlide - 1].classList.add('active');
            dots[currentSlide - 1].classList.add('active');
        }

        document.addEventListener('keydown', function(e) {
            if (e.key === 'ArrowLeft') {
                changeSlide(-1);
            } else if (e.key === 'ArrowRight') {
                changeSlide(1);
            }
        });

        function checkAnswer1() {
            const answer = document.getElementById('q1').value.trim().toLowerCase();
            const feedback = document.getElementById('feedback1');

            if (answer === 'were' || answer === 'was') {
                feedback.className = 'feedback correct';
                feedback.textContent = '✓ Correct! "were" is formal, "was" is informal but accepted.';
                setTimeout(() => { changeSlide(1); }, 1500);
            } else {
                feedback.className = 'feedback incorrect';
                feedback.textContent = '✗ Use past simple: were (formal) or was (informal)';
            }
        }

        function checkAnswer2() {
            const answer = document.getElementById('q2').value.trim().toLowerCase();
            const feedback = document.getElementById('feedback2');

            if (answer === 'would drive' || answer === "'d drive") {
                feedback.className = 'feedback correct';
                feedback.textContent = '✓ Excellent! "would drive" - Result uses WOULD + base verb.';
                setTimeout(() => { changeSlide(1); }, 1500);
            } else {
                feedback.className = 'feedback incorrect';
                feedback.textContent = '✗ Use would + base verb: would drive';
            }
        }

        function checkAnswer3() {
            const answer = document.getElementById('q3').value.trim().toLowerCase();
            const feedback = document.getElementById('feedback3');

            if (answer === 'spoke, would get' || answer === 'spoke,would get' || answer === "spoke, 'd get") {
                feedback.className = 'feedback correct';
                feedback.textContent = '✓ Perfect! "spoke, would get"';
                setTimeout(() => { changeSlide(1); }, 1500);
            } else {
                feedback.className = 'feedback incorrect';
                feedback.textContent = '✗ Use: spoke, would get';
            }
        }

        function checkAnswer4() {
            const answer = document.getElementById('q4').value.trim().toLowerCase();
            const feedback = document.getElementById('feedback4');

            if (answer === 'if i had time, i would help you' || answer === 'if i had time, i would help you.' || answer === "if i had time, i'd help you" || answer === "if i had time, i'd help you.") {
                feedback.className = 'feedback correct';
                feedback.textContent = '✓ Great! Don\'t use "would" in the IF clause.';
                setTimeout(() => { changeSlide(1); }, 1500);
            } else {
                feedback.className = 'feedback incorrect';
                feedback.textContent = '✗ Correct form: If I had time, I would help you';
            }
        }

        function checkAnswer5() {
            const answer = document.getElementById('q5').value.trim().toLowerCase();
            const feedback = document.getElementById('feedback5');

            if (answer === 'won') {
                feedback.className = 'feedback correct';
                feedback.textContent = '✓ Perfect! "won" - Past simple for unlikely event.';
                setTimeout(() => { changeSlide(1); }, 1500);
            } else {
                feedback.className = 'feedback incorrect';
                feedback.textContent = '✗ Use past simple for unlikely events: won';
            }
        }

        function checkAnswer6() {
            const answer = document.getElementById('q6').value.trim().toLowerCase();
            const feedback = document.getElementById('feedback6');

            if (answer === 'were') {
                feedback.className = 'feedback correct';
                feedback.textContent = '✓ Excellent! "If I were you" is the classic advice phrase.';
                setTimeout(() => { changeSlide(1); }, 1500);
            } else {
                feedback.className = 'feedback incorrect';
                feedback.textContent = '✗ Use: were (If I were you is the standard phrase)';
            }
        }

        function checkAnswer7() {
            const answer = document.getElementById('q7').value.trim().toLowerCase();
            const feedback = document.getElementById('feedback7');

            if (answer === "weren't" || answer === "wasn't" || answer === 'were not' || answer === 'was not') {
                feedback.className = 'feedback correct';
                feedback.textContent = '✓ Correct! "weren\'t" is formal, "wasn\'t" is informal.';
                setTimeout(() => { changeSlide(1); }, 1500);
            } else {
                feedback.className = 'feedback incorrect';
                feedback.textContent = '✗ Use: weren\'t (formal) or wasn\'t (informal)';
            }
        }

        function checkAnswer8() {
            const answer = document.getElementById('q8').value.trim().toLowerCase();
            const feedback = document.getElementById('feedback8');

            if (answer.includes('would') || answer.includes("'d")) {
                feedback.className = 'feedback correct';
                feedback.textContent = '✓ Great! You used "would" in the result clause!';
                setTimeout(() => { changeSlide(1); }, 1500);
            } else {
                feedback.className = 'feedback incorrect';
                feedback.textContent = '✗ Remember to use "would" + base verb in the result';
            }
        }

        async function checkGrammar() {
            const text = document.getElementById('writing1').value;
            const feedbackDiv = document.getElementById('grammar-feedback');
            const textarea = document.getElementById('writing1');

            if (!text.trim()) {
                feedbackDiv.style.display = 'block';
                feedbackDiv.style.background = 'rgba(245, 101, 101, 0.1)';
                feedbackDiv.style.border = '1px solid rgba(245, 101, 101, 0.3)';
                feedbackDiv.style.color = '#c53030';
                feedbackDiv.innerHTML = '✗ Please write some sentences first!';
                return;
            }

            textarea.style.display = 'none';
            window.grammarCheckResult = { original: text, corrected: '' };

            feedbackDiv.style.display = 'block';
            feedbackDiv.style.background = 'rgba(102, 126, 234, 0.1)';
            feedbackDiv.style.border = '1px solid rgba(102, 126, 234, 0.3)';
            feedbackDiv.style.color = '#667eea';
            feedbackDiv.innerHTML = '⏳ Checking your grammar and spelling...';

            try {
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=AIzaSyBTH0NmDb3cqjrY6p7YROPIJel-iCxSxzs`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        contents: [{
                            parts: [{
                                text: `You are a strict grammar checker. Fix grammar and spelling errors. Do not change the meaning, style, or add punctuation unless absolutely necessary. Profanities are acceptable, but don't use shortened informal words like "cuz" or "wanna"\n\nText: "${text}"\n\nReturn only the corrected text with minimal changes.`
                            }]
                        }]
                    })
                });

                const data = await response.json();
                const correctedText = data.candidates?.[0]?.content?.parts?.[0]?.text?.trim() || text;

                if (correctedText !== text && correctedText.toLowerCase() !== text.toLowerCase()) {
                    const originalWords = text.split(/(\s+)/);
                    const correctedWords = correctedText.split(/(\s+)/);
                    let highlightedText = '';

                    originalWords.forEach((word, i) => {
                        if (word.match(/\s+/)) {
                            highlightedText += word;
                        } else if (correctedWords[i] && word.toLowerCase() !== correctedWords[i].toLowerCase()) {
                            highlightedText += `<span style="color: #e53e3e; font-weight: 600; background: rgba(245, 101, 101, 0.15); padding: 2px 4px; border-radius: 3px;">${word}</span>`;
                        } else {
                            highlightedText += word;
                        }
                    });

                    let html = `
                        <div style="margin-bottom: 20px;">
                            <strong style="color: #c53030;">Your Text (errors highlighted):</strong>
                            <div style="background: white; padding: 15px; border-radius: 8px; margin-top: 10px; border: 2px solid rgba(245, 101, 101, 0.3); line-height: 1.8;">
                                ${highlightedText}
                            </div>
                        </div>
                        <div>
                            <strong style="color: #2f855a;">Corrected Text:</strong>
                            <div style="background: rgba(72, 187, 120, 0.1); padding: 15px; border-radius: 8px; margin-top: 10px; border: 2px solid rgba(72, 187, 120, 0.3); color: #2d3748; line-height: 1.8;">
                                ${correctedText}
                            </div>
                        </div>
                    `;

                    feedbackDiv.style.background = 'rgba(245, 101, 101, 0.05)';
                    feedbackDiv.style.border = '1px solid rgba(245, 101, 101, 0.3)';
                    feedbackDiv.style.color = '#2d3748';
                    feedbackDiv.innerHTML = html;

                    window.grammarCheckResult.corrected = correctedText;
                    const sendBtn = document.getElementById('send-teacher-btn');
                    sendBtn.disabled = false;
                    sendBtn.style.opacity = '1';
                    sendBtn.style.cursor = 'pointer';
                } else {
                    feedbackDiv.style.background = 'rgba(72, 187, 120, 0.1)';
                    feedbackDiv.style.border = '1px solid rgba(72, 187, 120, 0.3)';
                    feedbackDiv.style.color = '#2f855a';
                    feedbackDiv.innerHTML = '✓ Perfect! No grammar or spelling errors detected!';

                    window.grammarCheckResult.corrected = text;
                    const sendBtn = document.getElementById('send-teacher-btn');
                    sendBtn.disabled = false;
                    sendBtn.style.opacity = '1';
                    sendBtn.style.cursor = 'pointer';
                }
            } catch (error) {
                feedbackDiv.style.background = 'rgba(245, 101, 101, 0.1)';
                feedbackDiv.style.border = '1px solid rgba(245, 101, 101, 0.3)';
                feedbackDiv.style.color = '#c53030';
                feedbackDiv.innerHTML = '✗ Unable to check grammar. Error: ' + error.message;
            }
        }

        function sendToTeacher() {
            const essayTitle = "B1-48: Second Conditional - Imaginary Present/Future";
            const originalText = window.grammarCheckResult.original;
            const correctedText = window.grammarCheckResult.corrected;

            const emailBody = `Essay Title: ${essayTitle}\n\nOriginal Essay:\n${originalText}\n\nWe made some changes:\n\nCorrected Text:\n${correctedText}`;
            const mailtoLink = `mailto:?subject=${encodeURIComponent(essayTitle)}&body=${encodeURIComponent(emailBody)}`;
            window.location.href = mailtoLink;
        }
    </script>
</body>
</html>
