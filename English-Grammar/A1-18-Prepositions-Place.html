<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>A1-18: Prepositions of Place - in, on, under</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            height: 100vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 20px 40px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
        }

        .header-left {
            display: flex;
            flex-direction: column;
        }

        .header h1 {
            color: #2d3748;
            font-size: 2.5rem;
            font-weight: 700;
            margin: 0;
            letter-spacing: -0.5px;
        }

        .header .website {
            text-align: center;
            margin-top: 8px;
        }

        .header .website a {
            color: #4c51bf;
            text-decoration: none;
            font-size: 1.2rem;
            font-weight: 500;
            transition: color 0.3s ease;
        }

        .header .website a:hover {
            color: #553c9a;
        }

        .header-image {
            width: 120px;
            height: 80px;
            border-radius: 12px;
            object-fit: cover;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.15);
        }

        .container {
            display: flex;
            height: calc(100vh - 120px);
        }

        .navigation {
            width: 280px;
            background: rgba(45, 55, 72, 0.95);
            backdrop-filter: blur(10px);
            padding: 30px 20px;
            border-right: 1px solid rgba(255, 255, 255, 0.1);
        }

        .nav-item {
            padding: 16px 24px;
            margin: 8px 0;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            color: #e2e8f0;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            text-align: center;
            font-weight: 500;
            font-size: 1.1rem;
            backdrop-filter: blur(5px);
        }

        .nav-item:hover {
            background: rgba(255, 255, 255, 0.2);
            color: #ffffff;
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
        }

        .nav-item.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #ffffff;
            border-color: transparent;
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
        }

        .content {
            flex: 1;
            display: flex;
            flex-direction: column;
            height: 100%;
            overflow: hidden;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
        }

        .section {
            display: none;
            flex: 1;
            padding: 0;
            overflow: hidden;
            height: 100%;
            background: white;
        }

        .section.active {
            display: flex;
            flex-direction: column;
        }

        .slideshow-container {
            position: relative;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background: white;
            padding: 30px 80px;
        }

        .slide-content-wrapper {
            position: relative;
            width: 100%;
            max-width: 1400px;
            height: 85%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .slide {
            display: none;
            width: 100%;
            height: 100%;
            background: white;
            border-radius: 20px;
            padding: 25px 35px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .slide.active {
            display: flex;
            flex-direction: column;
            animation: slideIn 0.5s ease-in-out;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(30px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .slide-arrow {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: #8B7EC8;
            color: white;
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            z-index: 10;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }

        .slide-arrow:hover {
            background: #7366B0;
            transform: translateY(-50%) scale(1.1);
        }

        .slide-arrow.prev {
            left: -70px;
        }

        .slide-arrow.next {
            right: -70px;
        }

        .slide-indicators {
            position: absolute;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 12px;
            z-index: 10;
        }

        .indicator-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #D1D5DB;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .indicator-dot.active {
            background: #667eea;
            transform: scale(1.3);
        }

        .indicator-dot:hover {
            background: #9CA3AF;
        }

        .slide h2 {
            color: #2d3748;
            margin-bottom: 15px;
            font-size: 2rem;
            font-weight: 700;
            text-align: center;
            letter-spacing: -0.5px;
        }

        .explanation-box {
            background: transparent;
            border: none;
            border-radius: 0;
            padding: 0;
            margin-bottom: 0;
            backdrop-filter: none;
            box-shadow: none;
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow-y: auto;
            overflow-x: hidden;
        }

        .explanation-box h3 {
            color: #667eea;
            font-size: 1.3rem;
            margin-bottom: 10px;
            font-weight: 600;
        }

        .explanation-box p {
            color: #2d3748;
            line-height: 1.5;
            font-size: 1rem;
            margin-bottom: 8px;
        }

        .rule-box {
            background: #e3f2fd;
            padding: 15px 20px;
            border-radius: 10px;
            margin: 10px 0;
            border-left: 4px solid #667eea;
        }

        .rule-box h4 {
            color: #667eea;
            font-size: 1.2rem;
            margin-bottom: 8px;
            font-weight: 600;
        }

        .rule-box p {
            font-size: 1rem;
            color: #2d3748;
            margin: 5px 0;
        }

        .yes-no {
            display: inline-block;
            padding: 6px 12px;
            margin: 3px;
            border-radius: 6px;
            font-weight: 600;
            font-size: 1rem;
            background: #4299e1;
            color: white;
        }

        .auxiliary {
            display: inline-block;
            padding: 6px 12px;
            margin: 3px;
            border-radius: 6px;
            font-weight: 600;
            font-size: 1rem;
            background: #48bb78;
            color: white;
        }

        .subject {
            display: inline-block;
            padding: 6px 12px;
            margin: 3px;
            border-radius: 6px;
            font-weight: 600;
            font-size: 1rem;
            background: #9f7aea;
            color: white;
        }

        .verb {
            display: inline-block;
            padding: 6px 12px;
            margin: 3px;
            border-radius: 6px;
            font-weight: 600;
            font-size: 1rem;
            background: #ed64a6;
            color: white;
        }

        .example-box {
            background: #f7fafc;
            border-left: 4px solid #667eea;
            padding: 12px;
            border-radius: 8px;
            margin: 8px 0;
        }

        .example-box p {
            margin: 5px 0;
            font-size: 1rem;
            color: #2d3748;
        }

        .note-box {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 12px;
            margin: 10px 0;
            border-radius: 8px;
        }

        .note-box strong {
            color: #856404;
            font-size: 1rem;
        }

        .note-box p {
            color: #856404;
            margin-top: 5px;
            line-height: 1.4;
            font-size: 0.95rem;
        }

        .exercise-container {
            background: transparent;
            border: none;
            border-radius: 0;
            padding: 0;
            margin-bottom: 10px;
            backdrop-filter: none;
            box-shadow: none;
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .exercise-container h3 {
            color: #764ba2;
            font-size: 1.4rem;
            margin-bottom: 15px;
            font-weight: 600;
        }

        .question-box {
            background: #e3f2fd;
            padding: 20px;
            border-radius: 12px;
            margin: 0;
        }

        .question-box p {
            font-weight: 600;
            color: #2d3748;
            margin-bottom: 12px;
            font-size: 1.1rem;
        }

        input[type="text"] {
            width: 100%;
            padding: 12px 18px;
            margin: 8px 0;
            border: 2px solid rgba(102, 126, 234, 0.3);
            border-radius: 8px;
            font-size: 1.05rem;
            font-family: 'Inter', sans-serif;
            background: rgba(255, 255, 255, 0.8);
            transition: all 0.3s ease;
        }

        input[type="text"]:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 20px rgba(102, 126, 234, 0.2);
        }

        .check-button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #ffffff;
            border: none;
            padding: 12px 30px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1.1rem;
            font-weight: 600;
            margin: 15px 5px 10px 5px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }

        .check-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
        }

        .feedback {
            padding: 15px 20px;
            border-radius: 12px;
            margin: 15px 0;
            font-weight: 500;
            font-size: 1.05rem;
            display: none;
        }

        .feedback.correct {
            background: rgba(72, 187, 120, 0.1);
            color: #2f855a;
            border: 1px solid rgba(72, 187, 120, 0.3);
            display: block;
        }

        .feedback.incorrect {
            background: rgba(245, 101, 101, 0.1);
            color: #c53030;
            border: 1px solid rgba(245, 101, 101, 0.3);
            display: block;
        }

        ul {
            margin-left: 25px;
            line-height: 1.6;
        }

        li {
            margin: 6px 0;
            font-size: 1.05rem;
            color: #2d3748;
        }

        li strong {
            color: #667eea;
        }

        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin: 12px 0;
        }

        .comparison-table th {
            background: #667eea;
            color: white;
            padding: 10px;
            font-size: 1.05rem;
            font-weight: 600;
        }

        .comparison-table td {
            padding: 10px;
            border: 1px solid #e2e8f0;
            font-size: 1rem;
            text-align: center;
        }

        .comparison-table tr:nth-child(even) {
            background: #f7fafc;
        }

        .explanation-box::-webkit-scrollbar {
            width: 8px;
        }

        .explanation-box::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }

        .explanation-box::-webkit-scrollbar-thumb {
            background: #667eea;
            border-radius: 10px;
        }

        .explanation-box::-webkit-scrollbar-thumb:hover {
            background: #5568d3;
        }

        .formula-box {
            background: #e6fffa;
            border: 2px solid #319795;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            text-align: center;
            font-size: 1.3rem;
        }

        .grid-examples {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .grid-card {
            background: white;
            padding: 15px;
            border-radius: 10px;
            border: 2px solid #e2e8f0;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .grid-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .reading-text {
            background: #f7fafc;
            padding: 20px;
            border-radius: 10px;
            line-height: 1.9;
            margin: 15px 0;
            border: 2px solid #e2e8f0;
        }

        .reading-text p {
            margin: 12px 0;
        }

        .highlight-question {
            background: #bee3f8;
            padding: 2px 6px;
            border-radius: 4px;
            font-weight: bold;
        }

        .highlight-answer {
            background: #c6f6d5;
            padding: 2px 6px;
            border-radius: 4px;
            font-weight: bold;
        }

        .example-sentence {
            font-size: 1.1rem;
            margin: 10px 0;
            padding: 10px;
            background: white;
            border-radius: 8px;
            border-left: 3px solid #667eea;
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="header-left">
            <h1>A1-18: Prepositions of Place - in, on, under</h1>
            <div class="website">
                <a href="https://www.mimlanguageservices.com/" target="_blank">mimlanguageservices</a>
            </div>
        </div>
        <a href="https://www.mimlanguageservices.com/" target="_blank">
            <img src="https://static.wixstatic.com/media/593d03_8958d96b0f6d4d1ea9dffa7f89bffe8b~mv2.png" alt="ESL Logo" class="header-image">
        </a>
    </div>

    <div class="container">
        <div class="navigation">
            <div class="nav-item active" onclick="showSection('explanation', this)">Explanation</div>
            <div class="nav-item" onclick="showSection('examples', this)">Examples</div>
            <div class="nav-item" onclick="showSection('reading', this)">Reading</div>
            <div class="nav-item" onclick="showSection('media', this)">Media</div>
            <div class="nav-item" onclick="showSection('practice', this)">Practice</div>
            <div class="nav-item" onclick="showSection('writing', this)">Writing</div>
        </div>

        <div class="content">
            <!-- Explanation Section -->
            <div class="section active" id="explanation">
                <div class="slideshow-container">
                    <div class="slide-content-wrapper">
                        <button class="slide-arrow prev" onclick="changeSlide(-1)">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                                <polyline points="15 18 9 12 15 6"></polyline>
                            </svg>
                        </button>
                        <button class="slide-arrow next" onclick="changeSlide(1)">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                                <polyline points="9 18 15 12 9 6"></polyline>
                            </svg>
                        </button>

                        <div class="slide active" data-section="explanation">
                            <h2>Welcome to Prepositions of Place!</h2>
                            <div class="explanation-box">
                                <p style="font-size: 1.2rem; text-align: center; margin: 20px 0;">
                                    Today we will learn <span class="yes-no">PREPOSITIONS OF PLACE</span> in English!
                                </p>
                                <p style="font-size: 1.1rem; text-align: center;">
                                    These words tell us WHERE things are located.
                                </p>
                                <div class="formula-box">
                                    <span class="subject">Object</span> + <span class="verb">is</span> + <span class="auxiliary">PREPOSITION</span> + place
                                </div>
                                <p style="text-align: center; font-size: 1.1rem;">
                                    Example: The book is <strong>on</strong> the table. / The cat is <strong>under</strong> the chair.
                                </p>
                            </div>
                        </div>

                        <div class="slide" data-section="explanation">
                            <h2>IN - Inside Something</h2>
                            <div class="explanation-box">
                                <h3>Use "IN" for enclosed spaces</h3>

                                <div class="formula-box">
                                    Something is <span class="auxiliary">IN</span> a container or enclosed space
                                </div>

                                <table class="comparison-table">
                                    <tr>
                                        <th>Preposition</th>
                                        <th>Example</th>
                                        <th>Meaning</th>
                                    </tr>
                                    <tr>
                                        <td><strong>in</strong></td>
                                        <td>The books are <strong>in</strong> the bag.</td>
                                        <td>Inside the bag</td>
                                    </tr>
                                    <tr>
                                        <td><strong>in</strong></td>
                                        <td>She is <strong>in</strong> the room.</td>
                                        <td>Inside the room</td>
                                    </tr>
                                    <tr>
                                        <td><strong>in</strong></td>
                                        <td>The toys are <strong>in</strong> the box.</td>
                                        <td>Inside the box</td>
                                    </tr>
                                </table>

                                <div class="rule-box">
                                    <h4>Rule:</h4>
                                    <p>Use "IN" when something is inside an enclosed space (room, box, bag, building, etc.)</p>
                                </div>
                            </div>
                        </div>

                        <div class="slide" data-section="explanation">
                            <h2>ON - On a Surface</h2>
                            <div class="explanation-box">
                                <h3>Use "ON" for surfaces and contact</h3>

                                <div class="formula-box">
                                    Something is <span class="auxiliary">ON</span> a surface (touching it)
                                </div>

                                <table class="comparison-table">
                                    <tr>
                                        <th>Preposition</th>
                                        <th>Example</th>
                                        <th>Meaning</th>
                                    </tr>
                                    <tr>
                                        <td><strong>on</strong></td>
                                        <td>The book is <strong>on</strong> the table.</td>
                                        <td>On top of the table</td>
                                    </tr>
                                    <tr>
                                        <td><strong>on</strong></td>
                                        <td>The picture is <strong>on</strong> the wall.</td>
                                        <td>Attached to the wall</td>
                                    </tr>
                                    <tr>
                                        <td><strong>on</strong></td>
                                        <td>The keys are <strong>on</strong> the desk.</td>
                                        <td>On top of the desk</td>
                                    </tr>
                                </table>

                                <div class="rule-box">
                                    <h4>Rule:</h4>
                                    <p>Use "ON" when something is on a surface or attached to something (table, wall, floor, etc.)</p>
                                </div>
                            </div>
                        </div>

                        <div class="slide" data-section="explanation">
                            <h2>UNDER - Below Something</h2>
                            <div class="explanation-box">
                                <h3>Use "UNDER" for things below/beneath</h3>

                                <div class="formula-box">
                                    Something is <span class="auxiliary">UNDER</span> another object (below it)
                                </div>

                                <table class="comparison-table">
                                    <tr>
                                        <th>Preposition</th>
                                        <th>Example</th>
                                        <th>Meaning</th>
                                    </tr>
                                    <tr>
                                        <td><strong>under</strong></td>
                                        <td>The cat is <strong>under</strong> the table.</td>
                                        <td>Below the table</td>
                                    </tr>
                                    <tr>
                                        <td><strong>under</strong></td>
                                        <td>The shoes are <strong>under</strong> the bed.</td>
                                        <td>Beneath the bed</td>
                                    </tr>
                                    <tr>
                                        <td><strong>under</strong></td>
                                        <td>The ball is <strong>under</strong> the chair.</td>
                                        <td>Below the chair</td>
                                    </tr>
                                </table>

                                <div class="rule-box">
                                    <h4>Rule:</h4>
                                    <p>Use "UNDER" when something is below or beneath another object.</p>
                                </div>
                            </div>
                        </div>

                        <div class="slide" data-section="explanation">
                            <h2>More Prepositions of Place</h2>
                            <div class="explanation-box">
                                <h3>Additional common prepositions:</h3>

                                <div class="example-box">
                                    <p><strong>NEXT TO</strong> - beside something</p>
                                    <div class="example-sentence">The lamp is <strong>next to</strong> the bed.</div>
                                    <div class="example-sentence">I sit <strong>next to</strong> Sarah in class.</div>
                                </div>

                                <div class="example-box">
                                    <p><strong>BETWEEN</strong> - in the middle of two things</p>
                                    <div class="example-sentence">The cafe is <strong>between</strong> the bank and the bookstore.</div>
                                    <div class="example-sentence">Tom sits <strong>between</strong> Anna and Mike.</div>
                                </div>

                                <div class="example-box">
                                    <p><strong>BEHIND</strong> - at the back of something</p>
                                    <div class="example-sentence">The car is <strong>behind</strong> the house.</div>
                                    <div class="example-sentence">The cat is hiding <strong>behind</strong> the door.</div>
                                </div>

                                <div class="example-box">
                                    <p><strong>IN FRONT OF</strong> - before something</p>
                                    <div class="example-sentence">There's a tree <strong>in front of</strong> the building.</div>
                                    <div class="example-sentence">She's standing <strong>in front of</strong> the mirror.</div>
                                </div>
                            </div>
                        </div>

                        <div class="slide" data-section="explanation">
                            <h2>Above and Below</h2>
                            <div class="explanation-box">
                                <h3>ABOVE and BELOW for vertical positions:</h3>

                                <div class="example-box">
                                    <p><strong>ABOVE</strong> - higher than something (not touching)</p>
                                    <div class="example-sentence">The clock is <strong>above</strong> the door.</div>
                                    <div class="example-sentence">The helicopter is flying <strong>above</strong> the building.</div>
                                    <div class="example-sentence">The shelf is <strong>above</strong> the desk.</div>
                                </div>

                                <div class="example-box">
                                    <p><strong>BELOW</strong> - lower than something (not touching)</p>
                                    <div class="example-sentence">The parking lot is <strong>below</strong> the building.</div>
                                    <div class="example-sentence">The temperature is <strong>below</strong> zero.</div>
                                    <div class="example-sentence">The valley is <strong>below</strong> the mountain.</div>
                                </div>

                                <div class="rule-box">
                                    <h4>Note:</h4>
                                    <p>ABOVE/BELOW = not touching. ON/UNDER = touching or very close.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="slide-indicators" id="explanation-indicators">
                        <span class="indicator-dot active" onclick="goToSlide(1)"></span>
                        <span class="indicator-dot" onclick="goToSlide(2)"></span>
                        <span class="indicator-dot" onclick="goToSlide(3)"></span>
                        <span class="indicator-dot" onclick="goToSlide(4)"></span>
                        <span class="indicator-dot" onclick="goToSlide(5)"></span>
                        <span class="indicator-dot" onclick="goToSlide(6)"></span>
                    </div>
                </div>
            </div>

            <!-- Examples Section -->
            <div class="section" id="examples">
                <div class="slideshow-container">
                    <div class="slide-content-wrapper">
                        <button class="slide-arrow prev" onclick="changeSlide(-1)">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                                <polyline points="15 18 9 12 15 6"></polyline>
                            </svg>
                        </button>
                        <button class="slide-arrow next" onclick="changeSlide(1)">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                                <polyline points="9 18 15 12 9 6"></polyline>
                            </svg>
                        </button>

                        <div class="slide active" data-section="examples">
                            <h2>Describing a Bedroom</h2>
                            <div class="explanation-box">
                                <h3>Using prepositions to describe a room:</h3>
                                <div class="grid-examples">
                                    <div class="grid-card">
                                        <strong>IN the room:</strong><br><br>
                                        The clothes are <strong>in</strong> the wardrobe.<br>
                                        The books are <strong>in</strong> the drawer.<br>
                                        My phone is <strong>in</strong> my bag.
                                    </div>
                                    <div class="grid-card">
                                        <strong>ON surfaces:</strong><br><br>
                                        The lamp is <strong>on</strong> the bedside table.<br>
                                        The poster is <strong>on</strong> the wall.<br>
                                        The rug is <strong>on</strong> the floor.
                                    </div>
                                </div>

                                <h3>More room descriptions:</h3>
                                <div class="grid-examples">
                                    <div class="grid-card">
                                        <strong>UNDER things:</strong><br><br>
                                        The shoes are <strong>under</strong> the bed.<br>
                                        The cat is <strong>under</strong> the blanket.<br>
                                        My slippers are <strong>under</strong> the chair.
                                    </div>
                                    <div class="grid-card">
                                        <strong>Other positions:</strong><br><br>
                                        The desk is <strong>next to</strong> the window.<br>
                                        The bed is <strong>between</strong> two tables.<br>
                                        The mirror is <strong>above</strong> the dresser.
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="slide" data-section="examples">
                            <h2>Describing a Kitchen</h2>
                            <div class="explanation-box">
                                <table class="comparison-table">
                                    <tr>
                                        <th>Preposition</th>
                                        <th>Kitchen Example</th>
                                        <th>Location</th>
                                    </tr>
                                    <tr>
                                        <td><strong>in</strong></td>
                                        <td>The milk is <strong>in</strong> the refrigerator.</td>
                                        <td>Inside</td>
                                    </tr>
                                    <tr>
                                        <td><strong>on</strong></td>
                                        <td>The plates are <strong>on</strong> the counter.</td>
                                        <td>On top</td>
                                    </tr>
                                    <tr>
                                        <td><strong>under</strong></td>
                                        <td>The pots are <strong>under</strong> the sink.</td>
                                        <td>Below</td>
                                    </tr>
                                    <tr>
                                        <td><strong>next to</strong></td>
                                        <td>The stove is <strong>next to</strong> the sink.</td>
                                        <td>Beside</td>
                                    </tr>
                                </table>

                                <h3>More kitchen prepositions:</h3>
                                <div class="example-box">
                                    <p>The cups are <strong>in</strong> the cupboard.</p>
                                    <p>The cutting board is <strong>on</strong> the table.</p>
                                    <p>The trash can is <strong>under</strong> the counter.</p>
                                    <p>The microwave is <strong>above</strong> the stove.</p>
                                </div>
                            </div>
                        </div>

                        <div class="slide" data-section="examples">
                            <h2>Describing an Office</h2>
                            <div class="explanation-box">
                                <h3>Office locations:</h3>

                                <div class="example-box">
                                    <p><strong>IN containers:</strong></p>
                                    <p>• The documents are <strong>in</strong> the filing cabinet.</p>
                                    <p>• The pens are <strong>in</strong> the pen holder.</p>
                                    <p>• The coffee is <strong>in</strong> the mug.</p>
                                    <p>• The staff are <strong>in</strong> the meeting room.</p>
                                </div>

                                <div class="example-box">
                                    <p><strong>ON surfaces:</strong></p>
                                    <p>• The computer is <strong>on</strong> the desk.</p>
                                    <p>• The calendar is <strong>on</strong> the wall.</p>
                                    <p>• The folders are <strong>on</strong> the shelf.</p>
                                    <p>• The keyboard is <strong>on</strong> the desk.</p>
                                </div>

                                <div class="example-box">
                                    <p><strong>Other positions:</strong></p>
                                    <p>• The printer is <strong>next to</strong> the photocopier.</p>
                                    <p>• The chair is <strong>in front of</strong> the desk.</p>
                                    <p>• The wastepaper basket is <strong>under</strong> the desk.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="slide-indicators" id="examples-indicators">
                        <span class="indicator-dot active" onclick="goToSlide(1)"></span>
                        <span class="indicator-dot" onclick="goToSlide(2)"></span>
                        <span class="indicator-dot" onclick="goToSlide(3)"></span>
                    </div>
                </div>
            </div>

            <!-- Reading Section -->
            <div class="section" id="reading">
                <div class="slideshow-container">
                    <div class="slide-content-wrapper">
                        <button class="slide-arrow prev" onclick="changeSlide(-1)">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                                <polyline points="15 18 9 12 15 6"></polyline>
                            </svg>
                        </button>
                        <button class="slide-arrow next" onclick="changeSlide(1)">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                                <polyline points="9 18 15 12 9 6"></polyline>
                            </svg>
                        </button>

                        <div class="slide active" data-section="reading">
                            <h2>Reading: Finding Things at Home</h2>
                            <div class="explanation-box">
                                <div class="reading-text">
                                    <p><strong>Mom helps her son find his things:</strong></p>

                                    <p>Tom: Mom, where are my shoes?<br>
                                    Mom: They're <span class="highlight-answer">under the bed</span>.</p>

                                    <p>Tom: Thanks! And where's my school bag?<br>
                                    Mom: It's <span class="highlight-answer">on the chair</span> in your room.</p>

                                    <p>Tom: I can't find my keys either.<br>
                                    Mom: Look <span class="highlight-answer">in the drawer</span> next to your bed.</p>

                                    <p>Tom: Found them! What about my jacket?<br>
                                    Mom: It's hanging <span class="highlight-answer">behind the door</span>.</p>

                                    <p>Tom: Perfect! And my phone?<br>
                                    Mom: I saw it <span class="highlight-answer">on the table</span> in the kitchen.</p>

                                    <p>Tom: Where's the remote control?<br>
                                    Mom: It's <span class="highlight-answer">between the cushions</span> on the sofa.</p>

                                    <p>Tom: Thanks, Mom! You always know where everything is!<br>
                                    Mom: That's because I put things <span class="highlight-answer">in the right place</span>!</p>
                                </div>
                            </div>
                        </div>

                        <div class="slide" data-section="reading">
                            <h2>Prepositions from the Reading</h2>
                            <div class="explanation-box">
                                <h3>Prepositions used in the conversation:</h3>
                                <div class="example-box">
                                    <p><strong>UNDER:</strong> under the bed</p>
                                    <p>• The shoes are below/beneath the bed</p>
                                </div>

                                <div class="example-box">
                                    <p><strong>ON:</strong> on the chair, on the table</p>
                                    <p>• The bag/phone are on top of surfaces</p>
                                </div>

                                <div class="example-box">
                                    <p><strong>IN:</strong> in the drawer, in the right place</p>
                                    <p>• The keys are inside the drawer</p>
                                </div>

                                <div class="example-box">
                                    <p><strong>BEHIND:</strong> behind the door</p>
                                    <p>• The jacket is at the back of the door</p>
                                </div>

                                <div class="example-box">
                                    <p><strong>BETWEEN:</strong> between the cushions</p>
                                    <p>• The remote is in the middle of two cushions</p>
                                </div>

                                <div class="rule-box">
                                    <h4>Notice:</h4>
                                    <p>We use prepositions of place to describe exactly WHERE things are located!</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="slide-indicators" id="reading-indicators">
                        <span class="indicator-dot active" onclick="goToSlide(1)"></span>
                        <span class="indicator-dot" onclick="goToSlide(2)"></span>
                    </div>
                </div>
            </div>

            <!-- Media Section -->
            <div class="section" id="media">
                <div class="slideshow-container">
                    <div class="slide-content-wrapper">
                        <button class="slide-arrow prev" onclick="changeSlide(-1)">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                                <polyline points="15 18 9 12 15 6"></polyline>
                            </svg>
                        </button>
                        <button class="slide-arrow next" onclick="changeSlide(1)">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                                <polyline points="9 18 15 12 9 6"></polyline>
                            </svg>
                        </button>

                        <div class="slide active" data-section="media">
                            <h2>Video: Prepositions of Place</h2>
                            <div class="explanation-box">
                                <p style="font-size: 1.1rem; margin-bottom: 20px;">Watch this video about prepositions of place:</p>
                                <div style="text-align: center; margin: 30px 0;">
                                    <iframe width="800" height="450"
                                        src="https://www.youtube.com/embed/qgs1eNKF18g"
                                        style="border-radius: 15px; box-shadow: 0 8px 30px rgba(0,0,0,0.2);"
                                        frameborder="0"
                                        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                                        allowfullscreen>
                                    </iframe>
                                </div>
                                <p style="font-size: 1rem; color: #666; text-align: center; font-style: italic;">
                                    Learn prepositions of place with clear examples
                                </p>
                            </div>
                        </div>

                        <div class="slide" data-section="media">
                            <h2>Video: In, On, Under Song</h2>
                            <div class="explanation-box">
                                <p style="font-size: 1.1rem; margin-bottom: 20px;">Watch this fun song about in, on, and under:</p>
                                <div style="text-align: center; margin: 30px 0;">
                                    <iframe width="800" height="450"
                                        src="https://www.youtube.com/embed/1c_JTwh7p4U"
                                        style="border-radius: 15px; box-shadow: 0 8px 30px rgba(0,0,0,0.2);"
                                        frameborder="0"
                                        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                                        allowfullscreen>
                                    </iframe>
                                </div>
                                <p style="font-size: 1rem; color: #666; text-align: center; font-style: italic;">
                                    Learn prepositions with a catchy song
                                </p>
                            </div>
                        </div>
                    </div>
                    <div class="slide-indicators" id="media-indicators">
                        <span class="indicator-dot active" onclick="goToSlide(1)"></span>
                        <span class="indicator-dot" onclick="goToSlide(2)"></span>
                    </div>
                </div>
            </div>

            <!-- Practice Section -->
            <div class="section" id="practice">
                <div class="slideshow-container">
                    <div class="slide-content-wrapper">
                        <button class="slide-arrow prev" onclick="changeSlide(-1)">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                                <polyline points="15 18 9 12 15 6"></polyline>
                            </svg>
                        </button>
                        <button class="slide-arrow next" onclick="changeSlide(1)">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                                <polyline points="9 18 15 12 9 6"></polyline>
                            </svg>
                        </button>

                        <div class="slide active" data-section="practice">
                            <h2>Practice 1: IN</h2>
                            <div class="exercise-container">
                                <div class="question-box">
                                    <p>The books are ___ the bag. (in, on, or under?)</p>
                                    <input type="text" id="q1" placeholder="Type: in" onkeypress="if(event.key==='Enter') checkAnswer1()">
                                    <button class="check-button" onclick="checkAnswer1()">Check Answer</button>
                                    <div id="feedback1" class="feedback"></div>
                                </div>
                            </div>
                        </div>

                        <div class="slide" data-section="practice">
                            <h2>Practice 2: ON</h2>
                            <div class="exercise-container">
                                <div class="question-box">
                                    <p>The cup is ___ the table. (in, on, or under?)</p>
                                    <input type="text" id="q2" placeholder="Type: on" onkeypress="if(event.key==='Enter') checkAnswer2()">
                                    <button class="check-button" onclick="checkAnswer2()">Check Answer</button>
                                    <div id="feedback2" class="feedback"></div>
                                </div>
                            </div>
                        </div>

                        <div class="slide" data-section="practice">
                            <h2>Practice 3: UNDER</h2>
                            <div class="exercise-container">
                                <div class="question-box">
                                    <p>The cat is ___ the chair. (in, on, or under?)</p>
                                    <input type="text" id="q3" placeholder="Type: under" onkeypress="if(event.key==='Enter') checkAnswer3()">
                                    <button class="check-button" onclick="checkAnswer3()">Check Answer</button>
                                    <div id="feedback3" class="feedback"></div>
                                </div>
                            </div>
                        </div>

                        <div class="slide" data-section="practice">
                            <h2>Practice 4: NEXT TO</h2>
                            <div class="exercise-container">
                                <div class="question-box">
                                    <p>The lamp is ___ ___ the bed. (2 words)</p>
                                    <input type="text" id="q4" placeholder="Type: next to" onkeypress="if(event.key==='Enter') checkAnswer4()">
                                    <button class="check-button" onclick="checkAnswer4()">Check Answer</button>
                                    <div id="feedback4" class="feedback"></div>
                                </div>
                            </div>
                        </div>

                        <div class="slide" data-section="practice">
                            <h2>Practice 5: BETWEEN</h2>
                            <div class="exercise-container">
                                <div class="question-box">
                                    <p>The chair is ___ the two desks.</p>
                                    <input type="text" id="q5" placeholder="Type: between" onkeypress="if(event.key==='Enter') checkAnswer5()">
                                    <button class="check-button" onclick="checkAnswer5()">Check Answer</button>
                                    <div id="feedback5" class="feedback"></div>
                                </div>
                            </div>
                        </div>

                        <div class="slide" data-section="practice">
                            <h2>Practice 6: BEHIND</h2>
                            <div class="exercise-container">
                                <div class="question-box">
                                    <p>The car is ___ the house.</p>
                                    <input type="text" id="q6" placeholder="Type: behind" onkeypress="if(event.key==='Enter') checkAnswer6()">
                                    <button class="check-button" onclick="checkAnswer6()">Check Answer</button>
                                    <div id="feedback6" class="feedback"></div>
                                </div>
                            </div>
                        </div>

                        <div class="slide" data-section="practice">
                            <h2>Practice 7: IN FRONT OF</h2>
                            <div class="exercise-container">
                                <div class="question-box">
                                    <p>The tree is ___ ___ ___ the building. (3 words)</p>
                                    <input type="text" id="q7" placeholder="Type: in front of" onkeypress="if(event.key==='Enter') checkAnswer7()">
                                    <button class="check-button" onclick="checkAnswer7()">Check Answer</button>
                                    <div id="feedback7" class="feedback"></div>
                                </div>
                            </div>
                        </div>

                        <div class="slide" data-section="practice">
                            <h2>Practice 8: ABOVE</h2>
                            <div class="exercise-container">
                                <div class="question-box">
                                    <p>The clock is ___ the door.</p>
                                    <input type="text" id="q8" placeholder="Type: above" onkeypress="if(event.key==='Enter') checkAnswer8()">
                                    <button class="check-button" onclick="checkAnswer8()">Check Answer</button>
                                    <div id="feedback8" class="feedback"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="slide-indicators" id="practice-indicators">
                        <span class="indicator-dot active" onclick="goToSlide(1)"></span>
                        <span class="indicator-dot" onclick="goToSlide(2)"></span>
                        <span class="indicator-dot" onclick="goToSlide(3)"></span>
                        <span class="indicator-dot" onclick="goToSlide(4)"></span>
                        <span class="indicator-dot" onclick="goToSlide(5)"></span>
                        <span class="indicator-dot" onclick="goToSlide(6)"></span>
                        <span class="indicator-dot" onclick="goToSlide(7)"></span>
                        <span class="indicator-dot" onclick="goToSlide(8)"></span>
                    </div>
                </div>
            </div>

            <!-- Writing Section -->
            <div class="section" id="writing">
                <div class="slideshow-container">
                    <div class="slide-content-wrapper">
                        <button class="slide-arrow prev" onclick="changeSlide(-1)">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                                <polyline points="15 18 9 12 15 6"></polyline>
                            </svg>
                        </button>
                        <button class="slide-arrow next" onclick="changeSlide(1)">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                                <polyline points="9 18 15 12 9 6"></polyline>
                            </svg>
                        </button>

                        <div class="slide active" data-section="writing" style="overflow-y: auto;">
                            <h2>Writing Practice</h2>
                            <div class="explanation-box">
                                <h3>Describe your bedroom using prepositions of place</h3>
                                <p style="margin-bottom: 15px;">Write 10 sentences describing where things are in your bedroom. Use different prepositions (in, on, under, next to, between, behind, in front of, above).</p>
                                <div class="question-box">
                                    <textarea id="writing1" rows="8" style="width: 100%; padding: 12px; border: 2px solid rgba(102, 126, 234, 0.3); border-radius: 8px; font-size: 1.05rem; font-family: 'Inter', sans-serif; resize: vertical;" spellcheck="true" placeholder="My bed is in the middle of the room. The lamp is on the bedside table. My shoes are under the bed..."></textarea>
                                    <div style="display: flex; gap: 10px; margin-top: 10px;">
                                        <button class="check-button" onclick="checkGrammar()">Check Grammar</button>
                                        <button id="send-teacher-btn" class="check-button" onclick="sendToTeacher()" style="background: linear-gradient(135deg, #48bb78 0%, #38a169 100%); opacity: 0.5; cursor: not-allowed;" disabled>Send to Teacher</button>
                                    </div>
                                    <div id="grammar-feedback" style="margin-top: 15px; padding: 15px; border-radius: 8px; display: none;"></div>
                                    <p style="font-size: 0.95rem; color: #666; margin-top: 10px;">Example: My bed is in the middle of the room. The lamp is on the bedside table. My shoes are under the bed.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="slide-indicators" id="writing-indicators">
                        <span class="indicator-dot active" onclick="goToSlide(1)"></span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let currentSlide = 1;
        let currentSection = 'explanation';

        function showSection(sectionName, element) {
            const sections = document.querySelectorAll('.section');
            sections.forEach(section => section.classList.remove('active'));

            const navItems = document.querySelectorAll('.nav-item');
            navItems.forEach(item => item.classList.remove('active'));

            document.getElementById(sectionName).classList.add('active');

            if (element) {
                element.classList.add('active');
            }

            currentSection = sectionName;
            currentSlide = 1;

            setTimeout(() => {
                const activeSection = document.querySelector('.section.active');
                const inputField = activeSection.querySelector('input[type="text"]');
                if (inputField) {
                    inputField.focus();
                }
            }, 100);
        }

        function changeSlide(direction) {
            const activeSection = document.querySelector('.section.active');
            const slides = activeSection.querySelectorAll('.slide');
            const dots = activeSection.querySelectorAll('.indicator-dot');

            if (slides.length === 1) return;

            slides[currentSlide - 1].classList.remove('active');
            dots[currentSlide - 1].classList.remove('active');

            currentSlide += direction;

            if (currentSlide > slides.length) {
                currentSlide = 1;
            }
            if (currentSlide < 1) {
                currentSlide = slides.length;
            }

            slides[currentSlide - 1].classList.add('active');
            dots[currentSlide - 1].classList.add('active');

            setTimeout(() => {
                const activeSlide = slides[currentSlide - 1];
                const inputField = activeSlide.querySelector('input[type="text"]');
                if (inputField) {
                    inputField.focus();
                    inputField.value = '';
                }
            }, 100);
        }

        function goToSlide(slideNum) {
            const activeSection = document.querySelector('.section.active');
            const slides = activeSection.querySelectorAll('.slide');
            const dots = activeSection.querySelectorAll('.indicator-dot');

            slides[currentSlide - 1].classList.remove('active');
            dots[currentSlide - 1].classList.remove('active');

            currentSlide = slideNum;

            slides[currentSlide - 1].classList.add('active');
            dots[currentSlide - 1].classList.add('active');
        }

        document.addEventListener('keydown', function(e) {
            if (e.key === 'ArrowLeft') {
                changeSlide(-1);
            } else if (e.key === 'ArrowRight') {
                changeSlide(1);
            }
        });

        function checkAnswer1() {
            const answer = document.getElementById('q1').value.trim().toLowerCase();
            const feedback = document.getElementById('feedback1');

            if (answer === 'in') {
                feedback.className = 'feedback correct';
                feedback.textContent = '✓ Perfect! The books are IN the bag (inside).';
                setTimeout(() => { changeSlide(1); }, 1500);
            } else {
                feedback.className = 'feedback incorrect';
                feedback.textContent = '✗ Not quite. Use "in" for things inside containers.';
            }
        }

        function checkAnswer2() {
            const answer = document.getElementById('q2').value.trim().toLowerCase();
            const feedback = document.getElementById('feedback2');

            if (answer === 'on') {
                feedback.className = 'feedback correct';
                feedback.textContent = '✓ Excellent! The cup is ON the table (on the surface).';
                setTimeout(() => { changeSlide(1); }, 1500);
            } else {
                feedback.className = 'feedback incorrect';
                feedback.textContent = '✗ Use "on" for things on surfaces.';
            }
        }

        function checkAnswer3() {
            const answer = document.getElementById('q3').value.trim().toLowerCase();
            const feedback = document.getElementById('feedback3');

            if (answer === 'under') {
                feedback.className = 'feedback correct';
                feedback.textContent = '✓ Correct! The cat is UNDER the chair (below it).';
                setTimeout(() => { changeSlide(1); }, 1500);
            } else {
                feedback.className = 'feedback incorrect';
                feedback.textContent = '✗ The answer is "under" - below or beneath.';
            }
        }

        function checkAnswer4() {
            const answer = document.getElementById('q4').value.trim().toLowerCase();
            const feedback = document.getElementById('feedback4');

            if (answer === 'next to') {
                feedback.className = 'feedback correct';
                feedback.textContent = '✓ Perfect! The lamp is NEXT TO the bed (beside it).';
                setTimeout(() => { changeSlide(1); }, 1500);
            } else {
                feedback.className = 'feedback incorrect';
                feedback.textContent = '✗ The answer is "next to" - beside something.';
            }
        }

        function checkAnswer5() {
            const answer = document.getElementById('q5').value.trim().toLowerCase();
            const feedback = document.getElementById('feedback5');

            if (answer === 'between') {
                feedback.className = 'feedback correct';
                feedback.textContent = '✓ Correct! The chair is BETWEEN the two desks.';
                setTimeout(() => { changeSlide(1); }, 1500);
            } else {
                feedback.className = 'feedback incorrect';
                feedback.textContent = '✗ Use "between" for things in the middle of two objects.';
            }
        }

        function checkAnswer6() {
            const answer = document.getElementById('q6').value.trim().toLowerCase();
            const feedback = document.getElementById('feedback6');

            if (answer === 'behind') {
                feedback.className = 'feedback correct';
                feedback.textContent = '✓ Great! The car is BEHIND the house (at the back).';
                setTimeout(() => { changeSlide(1); }, 1500);
            } else {
                feedback.className = 'feedback incorrect';
                feedback.textContent = '✗ Use "behind" for things at the back of something.';
            }
        }

        function checkAnswer7() {
            const answer = document.getElementById('q7').value.trim().toLowerCase();
            const feedback = document.getElementById('feedback7');

            if (answer === "in front of") {
                feedback.className = 'feedback correct';
                feedback.textContent = '✓ Perfect! The tree is IN FRONT OF the building.';
                setTimeout(() => { changeSlide(1); }, 1500);
            } else {
                feedback.className = 'feedback incorrect';
                feedback.textContent = '✗ The answer is "in front of" (before something).';
            }
        }

        function checkAnswer8() {
            const answer = document.getElementById('q8').value.trim().toLowerCase();
            const feedback = document.getElementById('feedback8');

            if (answer === 'above') {
                feedback.className = 'feedback correct';
                feedback.textContent = '✓ Excellent! The clock is ABOVE the door (higher, not touching).';
                setTimeout(() => { changeSlide(1); }, 1500);
            } else {
                feedback.className = 'feedback incorrect';
                feedback.textContent = '✗ Use "above" for things higher than something else.';
            }
        }

        async function checkGrammar() {
            const text = document.getElementById('writing1').value;
            const feedbackDiv = document.getElementById('grammar-feedback');
            const textarea = document.getElementById('writing1');

            if (!text.trim()) {
                feedbackDiv.style.display = 'block';
                feedbackDiv.style.background = 'rgba(245, 101, 101, 0.1)';
                feedbackDiv.style.border = '1px solid rgba(245, 101, 101, 0.3)';
                feedbackDiv.style.color = '#c53030';
                feedbackDiv.innerHTML = '✗ Please write some sentences first!';
                return;
            }

            textarea.style.display = 'none';
            window.grammarCheckResult = { original: text, corrected: '' };

            feedbackDiv.style.display = 'block';
            feedbackDiv.style.background = 'rgba(102, 126, 234, 0.1)';
            feedbackDiv.style.border = '1px solid rgba(102, 126, 234, 0.3)';
            feedbackDiv.style.color = '#667eea';
            feedbackDiv.innerHTML = '⏳ Checking your grammar and spelling...';

            try {
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=AIzaSyBTH0NmDb3cqjrY6p7YROPIJel-iCxSxzs`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        contents: [{
                            parts: [{
                                text: `You are a strict grammar checker. Fix grammar and spelling errors. Do not change the meaning, style, or add punctuation unless absolutely necessary. Profanities are acceptable, but don't use shortened informal words like "cuz" or "wanna"\n\nText: "${text}"\n\nReturn only the corrected text with minimal changes.`
                            }]
                        }]
                    })
                });

                const data = await response.json();
                const correctedText = data.candidates?.[0]?.content?.parts?.[0]?.text?.trim() || text;

                if (correctedText !== text && correctedText.toLowerCase() !== text.toLowerCase()) {
                    const originalWords = text.split(/(\s+)/);
                    const correctedWords = correctedText.split(/(\s+)/);
                    let highlightedText = '';

                    originalWords.forEach((word, i) => {
                        if (word.match(/\s+/)) {
                            highlightedText += word;
                        } else if (correctedWords[i] && word.toLowerCase() !== correctedWords[i].toLowerCase()) {
                            highlightedText += `<span style="color: #e53e3e; font-weight: 600; background: rgba(245, 101, 101, 0.15); padding: 2px 4px; border-radius: 3px;">${word}</span>`;
                        } else {
                            highlightedText += word;
                        }
                    });

                    let html = `
                        <div style="margin-bottom: 20px;">
                            <strong style="color: #c53030;">Your Text (errors highlighted):</strong>
                            <div style="background: white; padding: 15px; border-radius: 8px; margin-top: 10px; border: 2px solid rgba(245, 101, 101, 0.3); line-height: 1.8;">
                                ${highlightedText}
                            </div>
                        </div>
                        <div>
                            <strong style="color: #2f855a;">Corrected Text:</strong>
                            <div style="background: rgba(72, 187, 120, 0.1); padding: 15px; border-radius: 8px; margin-top: 10px; border: 2px solid rgba(72, 187, 120, 0.3); color: #2d3748; line-height: 1.8;">
                                ${correctedText}
                            </div>
                        </div>
                    `;

                    feedbackDiv.style.background = 'rgba(245, 101, 101, 0.05)';
                    feedbackDiv.style.border = '1px solid rgba(245, 101, 101, 0.3)';
                    feedbackDiv.style.color = '#2d3748';
                    feedbackDiv.innerHTML = html;

                    window.grammarCheckResult.corrected = correctedText;
                    const sendBtn = document.getElementById('send-teacher-btn');
                    sendBtn.disabled = false;
                    sendBtn.style.opacity = '1';
                    sendBtn.style.cursor = 'pointer';
                } else {
                    feedbackDiv.style.background = 'rgba(72, 187, 120, 0.1)';
                    feedbackDiv.style.border = '1px solid rgba(72, 187, 120, 0.3)';
                    feedbackDiv.style.color = '#2f855a';
                    feedbackDiv.innerHTML = '✓ Perfect! No grammar or spelling errors detected!';

                    window.grammarCheckResult.corrected = text;
                    const sendBtn = document.getElementById('send-teacher-btn');
                    sendBtn.disabled = false;
                    sendBtn.style.opacity = '1';
                    sendBtn.style.cursor = 'pointer';
                }
            } catch (error) {
                feedbackDiv.style.background = 'rgba(245, 101, 101, 0.1)';
                feedbackDiv.style.border = '1px solid rgba(245, 101, 101, 0.3)';
                feedbackDiv.style.color = '#c53030';
                feedbackDiv.innerHTML = '✗ Unable to check grammar. Error: ' + error.message;
            }
        }

        function sendToTeacher() {
            const essayTitle = "A1-18: Prepositions of Place - in, on, under";
            const originalText = window.grammarCheckResult.original;
            const correctedText = window.grammarCheckResult.corrected;

            const emailBody = `Essay Title: ${essayTitle}\n\nOriginal Essay:\n${originalText}\n\nWe made some changes:\n\nCorrected Text:\n${correctedText}`;
            const mailtoLink = `mailto:?subject=${encodeURIComponent(essayTitle)}&body=${encodeURIComponent(emailBody)}`;
            window.location.href = mailtoLink;
        }
    </script>
</body>
</html>
