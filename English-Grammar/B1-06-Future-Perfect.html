<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>B1-46: Future Perfect - Actions Completed by a Time</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            height: 100vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 20px 40px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
        }

        .header-left {
            display: flex;
            flex-direction: column;
        }

        .header h1 {
            color: #2d3748;
            font-size: 2.5rem;
            font-weight: 700;
            margin: 0;
            letter-spacing: -0.5px;
        }

        .header .website {
            text-align: center;
            margin-top: 8px;
        }

        .header .website a {
            color: #4c51bf;
            text-decoration: none;
            font-size: 1.2rem;
            font-weight: 500;
            transition: color 0.3s ease;
        }

        .header .website a:hover {
            color: #553c9a;
        }

        .header-image {
            width: 120px;
            height: 80px;
            border-radius: 12px;
            object-fit: cover;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.15);
        }

        .container {
            display: flex;
            height: calc(100vh - 120px);
        }

        .navigation {
            width: 280px;
            background: rgba(45, 55, 72, 0.95);
            backdrop-filter: blur(10px);
            padding: 30px 20px;
            border-right: 1px solid rgba(255, 255, 255, 0.1);
        }

        .nav-item {
            padding: 16px 24px;
            margin: 8px 0;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            color: #e2e8f0;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            text-align: center;
            font-weight: 500;
            font-size: 1.1rem;
            backdrop-filter: blur(5px);
        }

        .nav-item:hover {
            background: rgba(255, 255, 255, 0.2);
            color: #ffffff;
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
        }

        .nav-item.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #ffffff;
            border-color: transparent;
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
        }

        .content {
            flex: 1;
            display: flex;
            flex-direction: column;
            height: 100%;
            overflow: hidden;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
        }

        .section {
            display: none;
            flex: 1;
            padding: 0;
            overflow: hidden;
            height: 100%;
            background: white;
        }

        .section.active {
            display: flex;
            flex-direction: column;
        }

        .slideshow-container {
            position: relative;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background: white;
            padding: 30px 80px;
        }

        .slide-content-wrapper {
            position: relative;
            width: 100%;
            max-width: 1400px;
            height: 85%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .slide {
            display: none;
            width: 100%;
            height: 100%;
            background: white;
            border-radius: 20px;
            padding: 25px 35px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .slide.active {
            display: flex;
            flex-direction: column;
            animation: slideIn 0.5s ease-in-out;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(30px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .slide-arrow {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: #8B7EC8;
            color: white;
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            z-index: 10;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }

        .slide-arrow:hover {
            background: #7366B0;
            transform: translateY(-50%) scale(1.1);
        }

        .slide-arrow.prev {
            left: -70px;
        }

        .slide-arrow.next {
            right: -70px;
        }

        .slide-indicators {
            position: absolute;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 12px;
            z-index: 10;
        }

        .indicator-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #D1D5DB;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .indicator-dot.active {
            background: #667eea;
            transform: scale(1.3);
        }

        .indicator-dot:hover {
            background: #9CA3AF;
        }

        .slide h2 {
            color: #2d3748;
            margin-bottom: 15px;
            font-size: 2rem;
            font-weight: 700;
            text-align: center;
            letter-spacing: -0.5px;
        }

        .explanation-box {
            background: transparent;
            border: none;
            border-radius: 0;
            padding: 0;
            margin-bottom: 0;
            backdrop-filter: none;
            box-shadow: none;
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow-y: auto;
            overflow-x: hidden;
        }

        .explanation-box h3 {
            color: #667eea;
            font-size: 1.3rem;
            margin-bottom: 10px;
            font-weight: 600;
        }

        .explanation-box p {
            color: #2d3748;
            line-height: 1.5;
            font-size: 1rem;
            margin-bottom: 8px;
        }

        .rule-box {
            background: #e3f2fd;
            padding: 15px 20px;
            border-radius: 10px;
            margin: 10px 0;
            border-left: 4px solid #667eea;
        }

        .rule-box h4 {
            color: #667eea;
            font-size: 1.2rem;
            margin-bottom: 8px;
            font-weight: 600;
        }

        .rule-box p {
            font-size: 1rem;
            color: #2d3748;
            margin: 5px 0;
        }

        .yes-no {
            display: inline-block;
            padding: 6px 12px;
            margin: 3px;
            border-radius: 6px;
            font-weight: 600;
            font-size: 1rem;
            background: #4299e1;
            color: white;
        }

        .auxiliary {
            display: inline-block;
            padding: 6px 12px;
            margin: 3px;
            border-radius: 6px;
            font-weight: 600;
            font-size: 1rem;
            background: #48bb78;
            color: white;
        }

        .subject {
            display: inline-block;
            padding: 6px 12px;
            margin: 3px;
            border-radius: 6px;
            font-weight: 600;
            font-size: 1rem;
            background: #9f7aea;
            color: white;
        }

        .verb {
            display: inline-block;
            padding: 6px 12px;
            margin: 3px;
            border-radius: 6px;
            font-weight: 600;
            font-size: 1rem;
            background: #ed64a6;
            color: white;
        }

        .example-box {
            background: #f7fafc;
            border-left: 4px solid #667eea;
            padding: 12px;
            border-radius: 8px;
            margin: 8px 0;
        }

        .example-box p {
            margin: 5px 0;
            font-size: 1rem;
            color: #2d3748;
        }

        .note-box {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 12px;
            margin: 10px 0;
            border-radius: 8px;
        }

        .note-box strong {
            color: #856404;
            font-size: 1rem;
        }

        .note-box p {
            color: #856404;
            margin-top: 5px;
            line-height: 1.4;
            font-size: 0.95rem;
        }

        .exercise-container {
            background: transparent;
            border: none;
            border-radius: 0;
            padding: 0;
            margin-bottom: 10px;
            backdrop-filter: none;
            box-shadow: none;
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .exercise-container h3 {
            color: #764ba2;
            font-size: 1.4rem;
            margin-bottom: 15px;
            font-weight: 600;
        }

        .question-box {
            background: #e3f2fd;
            padding: 20px;
            border-radius: 12px;
            margin: 0;
        }

        .question-box p {
            font-weight: 600;
            color: #2d3748;
            margin-bottom: 12px;
            font-size: 1.1rem;
        }

        input[type="text"] {
            width: 100%;
            padding: 12px 18px;
            margin: 8px 0;
            border: 2px solid rgba(102, 126, 234, 0.3);
            border-radius: 8px;
            font-size: 1.05rem;
            font-family: 'Inter', sans-serif;
            background: rgba(255, 255, 255, 0.8);
            transition: all 0.3s ease;
        }

        input[type="text"]:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 20px rgba(102, 126, 234, 0.2);
        }

        .check-button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #ffffff;
            border: none;
            padding: 12px 30px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1.1rem;
            font-weight: 600;
            margin: 15px 5px 10px 5px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }

        .check-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
        }

        .feedback {
            padding: 15px 20px;
            border-radius: 12px;
            margin: 15px 0;
            font-weight: 500;
            font-size: 1.05rem;
            display: none;
        }

        .feedback.correct {
            background: rgba(72, 187, 120, 0.1);
            color: #2f855a;
            border: 1px solid rgba(72, 187, 120, 0.3);
            display: block;
        }

        .feedback.incorrect {
            background: rgba(245, 101, 101, 0.1);
            color: #c53030;
            border: 1px solid rgba(245, 101, 101, 0.3);
            display: block;
        }

        ul {
            margin-left: 25px;
            line-height: 1.6;
        }

        li {
            margin: 6px 0;
            font-size: 1.05rem;
            color: #2d3748;
        }

        li strong {
            color: #667eea;
        }

        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin: 12px 0;
        }

        .comparison-table th {
            background: #667eea;
            color: white;
            padding: 10px;
            font-size: 1.05rem;
            font-weight: 600;
        }

        .comparison-table td {
            padding: 10px;
            border: 1px solid #e2e8f0;
            font-size: 1rem;
            text-align: center;
        }

        .comparison-table tr:nth-child(even) {
            background: #f7fafc;
        }

        .explanation-box::-webkit-scrollbar {
            width: 8px;
        }

        .explanation-box::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }

        .explanation-box::-webkit-scrollbar-thumb {
            background: #667eea;
            border-radius: 10px;
        }

        .explanation-box::-webkit-scrollbar-thumb:hover {
            background: #5568d3;
        }

        .formula-box {
            background: #e6fffa;
            border: 2px solid #319795;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            text-align: center;
            font-size: 1.3rem;
        }

        .grid-examples {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .grid-card {
            background: white;
            padding: 15px;
            border-radius: 10px;
            border: 2px solid #e2e8f0;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .grid-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .reading-text {
            background: #f7fafc;
            padding: 20px;
            border-radius: 10px;
            line-height: 1.9;
            margin: 15px 0;
            border: 2px solid #e2e8f0;
        }

        .reading-text p {
            margin: 12px 0;
        }

        .highlight-question {
            background: #bee3f8;
            padding: 2px 6px;
            border-radius: 4px;
            font-weight: bold;
        }

        .highlight-answer {
            background: #c6f6d5;
            padding: 2px 6px;
            border-radius: 4px;
            font-weight: bold;
        }

        .example-sentence {
            font-size: 1.1rem;
            margin: 10px 0;
            padding: 10px;
            background: white;
            border-radius: 8px;
            border-left: 3px solid #667eea;
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="header-left">
            <h1>B1-46: Future Perfect - Actions Completed by a Time</h1>
            <div class="website">
                <a href="https://www.mimlanguageservices.com/" target="_blank">mimlanguageservices</a>
            </div>
        </div>
        <a href="https://www.mimlanguageservices.com/" target="_blank">
            <img src="https://static.wixstatic.com/media/593d03_8958d96b0f6d4d1ea9dffa7f89bffe8b~mv2.png" alt="ESL Logo" class="header-image">
        </a>
    </div>

    <div class="container">
        <div class="navigation">
            <div class="nav-item active" onclick="showSection('explanation', this)">Explanation</div>
            <div class="nav-item" onclick="showSection('examples', this)">Examples</div>
            <div class="nav-item" onclick="showSection('reading', this)">Reading</div>
            <div class="nav-item" onclick="showSection('media', this)">Media</div>
            <div class="nav-item" onclick="showSection('practice', this)">Practice</div>
            <div class="nav-item" onclick="showSection('writing', this)">Writing</div>
        </div>

        <div class="content">
            <!-- Explanation Section -->
            <div class="section active" id="explanation">
                <div class="slideshow-container">
                    <div class="slide-content-wrapper">
                        <button class="slide-arrow prev" onclick="changeSlide(-1)">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                                <polyline points="15 18 9 12 15 6"></polyline>
                            </svg>
                        </button>
                        <button class="slide-arrow next" onclick="changeSlide(1)">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                                <polyline points="9 18 15 12 9 6"></polyline>
                            </svg>
                        </button>

                        <div class="slide active" data-section="explanation">
                            <h2>Welcome to Future Perfect!</h2>
                            <div class="explanation-box">
                                <p style="font-size: 1.2rem; text-align: center; margin: 20px 0;">
                                    Today we will learn the <span class="yes-no">FUTURE PERFECT</span> in English!
                                </p>
                                <p style="font-size: 1.1rem; text-align: center;">
                                    This tense describes actions that will be completed BEFORE a specific time in the future.
                                </p>
                                <div class="formula-box">
                                    <span class="auxiliary">WILL HAVE</span> + <span class="verb">PAST PARTICIPLE</span>
                                </div>
                                <p style="text-align: center; font-size: 1.1rem;">
                                    Example: By 6 PM, I <strong>will have finished</strong> my work. / By next year, she <strong>will have graduated</strong>.
                                </p>
                            </div>
                        </div>

                        <div class="slide" data-section="explanation">
                            <h2>How to Form the Future Perfect</h2>
                            <div class="explanation-box">
                                <h3>The Structure</h3>

                                <div class="formula-box">
                                    <span class="subject">Subject</span> + <span class="auxiliary">will have</span> + <span class="verb">past participle</span>
                                </div>

                                <table class="comparison-table">
                                    <tr>
                                        <th>Subject</th>
                                        <th>Auxiliary</th>
                                        <th>Past Participle</th>
                                        <th>Full Sentence</th>
                                    </tr>
                                    <tr>
                                        <td>I/You/We/They</td>
                                        <td>will have</td>
                                        <td>finished</td>
                                        <td>I will have finished.</td>
                                    </tr>
                                    <tr>
                                        <td>He/She/It</td>
                                        <td>will have</td>
                                        <td>graduated</td>
                                        <td>She will have graduated.</td>
                                    </tr>
                                    <tr>
                                        <td>We</td>
                                        <td>will have</td>
                                        <td>completed</td>
                                        <td>We will have completed.</td>
                                    </tr>
                                </table>

                                <div class="rule-box">
                                    <h4>Remember:</h4>
                                    <p>• Regular verbs: finish → finish<strong>ed</strong>, work → work<strong>ed</strong></p>
                                    <p>• Irregular verbs: go → <strong>gone</strong>, eat → <strong>eaten</strong>, write → <strong>written</strong></p>
                                    <p>• Same form for all subjects</p>
                                </div>
                            </div>
                        </div>

                        <div class="slide" data-section="explanation">
                            <h2>Use 1: Completed Actions Before a Future Time</h2>
                            <div class="explanation-box">
                                <h3>Actions that will finish before a deadline</h3>

                                <div class="formula-box">
                                    <span class="yes-no">BY</span> + <span class="auxiliary">will have</span> + <span class="verb">past participle</span>
                                </div>

                                <table class="comparison-table">
                                    <tr>
                                        <th>Future Perfect</th>
                                        <th>Meaning</th>
                                    </tr>
                                    <tr>
                                        <td>By 6 PM, I will have finished my work.</td>
                                        <td>The work will be complete before 6 PM arrives</td>
                                    </tr>
                                    <tr>
                                        <td>By next year, she will have graduated.</td>
                                        <td>Her graduation will be complete before next year</td>
                                    </tr>
                                    <tr>
                                        <td>By Friday, we will have completed the project.</td>
                                        <td>The project will be done before Friday</td>
                                    </tr>
                                </table>

                                <div class="rule-box">
                                    <h4>Key Point:</h4>
                                    <p>• The action will be FINISHED before the future time</p>
                                    <p>• Use BY to indicate the deadline</p>
                                    <p>• Focus on COMPLETION, not duration</p>
                                </div>
                            </div>
                        </div>

                        <div class="slide" data-section="explanation">
                            <h2>Use 2: Duration Up to a Future Point</h2>
                            <div class="explanation-box">
                                <h3>Showing how long something will have lasted</h3>

                                <div class="formula-box">
                                    <span class="auxiliary">will have</span> + <span class="verb">past participle</span> + <span class="yes-no">FOR/SINCE</span>
                                </div>

                                <table class="comparison-table">
                                    <tr>
                                        <th>Sentence</th>
                                        <th>Meaning</th>
                                    </tr>
                                    <tr>
                                        <td>By next month, I will have worked here for 10 years.</td>
                                        <td>Shows total duration up to that point</td>
                                    </tr>
                                    <tr>
                                        <td>By tomorrow, we will have been married for 25 years.</td>
                                        <td>The duration continues until that moment</td>
                                    </tr>
                                    <tr>
                                        <td>By 2030, scientists will have discovered many planets.</td>
                                        <td>Multiple discoveries by that year</td>
                                    </tr>
                                </table>

                                <div class="rule-box">
                                    <h4>Key Point:</h4>
                                    <p>• Shows duration UP TO a future point</p>
                                    <p>• Use FOR (duration) or SINCE (starting point)</p>
                                    <p>• Emphasizes the completed time period</p>
                                </div>
                            </div>
                        </div>

                        <div class="slide" data-section="explanation">
                            <h2>Common Time Expressions</h2>
                            <div class="explanation-box">
                                <h3>Key time markers with Future Perfect:</h3>

                                <div class="example-box">
                                    <p>• <strong>by [time/date]</strong> - By Friday, I will have finished the report.</p>
                                    <p>• <strong>by the time</strong> - By the time you arrive, I will have left.</p>
                                    <p>• <strong>by then</strong> - The movie starts at 8. By then, everyone will have arrived.</p>
                                    <p>• <strong>in [time period]'s time</strong> - In three years' time, he will have saved enough.</p>
                                    <p>• <strong>before</strong> - I will have eaten before you come home.</p>
                                </div>

                                <div class="rule-box">
                                    <h4>Remember:</h4>
                                    <p>• Use BY (not AT) with Future Perfect</p>
                                    <p>• BY = before or at that time</p>
                                    <p>• Focus on the DEADLINE</p>
                                </div>
                            </div>
                        </div>

                        <div class="slide" data-section="explanation">
                            <h2>Common Mistakes</h2>
                            <div class="explanation-box">
                                <h3>Mistake 1: Confusing with Future Continuous</h3>
                                <div class="example-box">
                                    <p>❌ By 6 PM, I <del>will be finishing</del> my work. → ✅ By 6 PM, I <strong>will have finished</strong> my work.</p>
                                    <p><strong>Note:</strong> Future Perfect = completed before the time</p>
                                </div>

                                <h3>Mistake 2: Forgetting "have"</h3>
                                <div class="example-box">
                                    <p>❌ By tomorrow, I <del>will finished</del>. → ✅ By tomorrow, I <strong>will have finished</strong>.</p>
                                    <p><strong>Note:</strong> Need: will + have + past participle</p>
                                </div>

                                <h3>Mistake 3: Using wrong time expressions</h3>
                                <div class="example-box">
                                    <p>❌ I will have finished <del>at</del> 6 PM. → ✅ I will have finished <strong>by</strong> 6 PM.</p>
                                    <p><strong>Note:</strong> Use "by" not "at" with Future Perfect</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="slide-indicators" id="explanation-indicators">
                        <span class="indicator-dot active" onclick="goToSlide(1)"></span>
                        <span class="indicator-dot" onclick="goToSlide(2)"></span>
                        <span class="indicator-dot" onclick="goToSlide(3)"></span>
                        <span class="indicator-dot" onclick="goToSlide(4)"></span>
                        <span class="indicator-dot" onclick="goToSlide(5)"></span>
                        <span class="indicator-dot" onclick="goToSlide(6)"></span>
                    </div>
                </div>
            </div>

            <!-- Examples Section -->
            <div class="section" id="examples">
                <div class="slideshow-container">
                    <div class="slide-content-wrapper">
                        <button class="slide-arrow prev" onclick="changeSlide(-1)">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                                <polyline points="15 18 9 12 15 6"></polyline>
                            </svg>
                        </button>
                        <button class="slide-arrow next" onclick="changeSlide(1)">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                                <polyline points="9 18 15 12 9 6"></polyline>
                            </svg>
                        </button>

                        <div class="slide active" data-section="examples">
                            <h2>Detailed Examples: Deadlines and Achievements</h2>
                            <div class="explanation-box">
                                <div class="grid-examples">
                                    <div class="grid-card">
                                        <strong>Work Deadline:</strong><br><br>
                                        • By Friday, we <strong>will have completed</strong> the project.<br>
                                        • By tomorrow, I <strong>will have sent</strong> all emails.<br>
                                    </div>
                                    <div class="grid-card">
                                        <strong>Life Achievement:</strong><br><br>
                                        • By age 30, I <strong>will have visited</strong> 20 countries.<br>
                                        • By next year, she <strong>will have learned</strong> Spanish.<br>
                                    </div>
                                    <div class="grid-card">
                                        <strong>Education:</strong><br><br>
                                        • By 2026, she <strong>will have earned</strong> her PhD.<br>
                                        • By graduation, he <strong>will have studied</strong> for 4 years.<br>
                                    </div>
                                    <div class="grid-card">
                                        <strong>Time Duration:</strong><br><br>
                                        • By next month, they <strong>will have lived</strong> here for 5 years.<br>
                                        • By December, we <strong>will have known</strong> each other for 10 years.<br>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="slide" data-section="examples">
                            <h2>Contrast: Simple Future vs. Future Perfect</h2>
                            <div class="explanation-box">
                                <table class="comparison-table">
                                    <tr>
                                        <th>Simple Future (Will)</th>
                                        <th>Future Perfect</th>
                                    </tr>
                                    <tr>
                                        <td>I will finish my homework.</td>
                                        <td>By 6 PM, I will have finished my homework.</td>
                                    </tr>
                                    <tr>
                                        <td>Just a future action, no deadline</td>
                                        <td>Completed BEFORE 6 PM</td>
                                    </tr>
                                    <tr>
                                        <td>She will graduate next year.</td>
                                        <td>By next June, she will have graduated.</td>
                                    </tr>
                                    <tr>
                                        <td>Action happening next year</td>
                                        <td>Completed BEFORE June</td>
                                    </tr>
                                    <tr>
                                        <td>They will leave tomorrow.</td>
                                        <td>By tomorrow evening, they will have left.</td>
                                    </tr>
                                    <tr>
                                        <td>Simple future event</td>
                                        <td>Already gone by then</td>
                                    </tr>
                                </table>

                                <div class="rule-box">
                                    <h4>Remember:</h4>
                                    <p>• WILL = simple future action</p>
                                    <p>• FUTURE PERFECT = completed before a deadline</p>
                                </div>
                            </div>
                        </div>

                        <div class="slide" data-section="examples">
                            <h2>Future Perfect for Predictions and Certainty</h2>
                            <div class="explanation-box">
                                <h3>Making confident predictions:</h3>
                                <div class="example-box">
                                    <p>• <strong>Technology:</strong> By 2030, electric cars <strong>will have replaced</strong> most gas vehicles.</p>
                                    <p>• <strong>Environment:</strong> By the end of this century, many species <strong>will have disappeared</strong>.</p>
                                    <p>• <strong>Personal Growth:</strong> By this time next year, you <strong>will have learned</strong> to speak Spanish fluently.</p>
                                    <p>• <strong>Career:</strong> By age 40, he <strong>will have become</strong> CEO of the company.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="slide-indicators" id="examples-indicators">
                        <span class="indicator-dot active" onclick="goToSlide(1)"></span>
                        <span class="indicator-dot" onclick="goToSlide(2)"></span>
                        <span class="indicator-dot" onclick="goToSlide(3)"></span>
                    </div>
                </div>
            </div>

            <!-- Reading Section -->
            <div class="section" id="reading">
                <div class="slideshow-container">
                    <div class="slide-content-wrapper">
                        <button class="slide-arrow prev" onclick="changeSlide(-1)">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                                <polyline points="15 18 9 12 15 6"></polyline>
                            </svg>
                        </button>
                        <button class="slide-arrow next" onclick="changeSlide(1)">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                                <polyline points="9 18 15 12 9 6"></polyline>
                            </svg>
                        </button>

                        <div class="slide active" data-section="reading">
                            <h2>Reading: Looking Ahead to 2030</h2>
                            <div class="explanation-box">
                                <div class="reading-text">
                                    <p><strong>Sarah's Goals and Dreams</strong></p>

                                    <p>Sarah is 25 years old and loves making plans. She has created a list of goals she wants to achieve by the year 2030. She's confident that by then, she <span class="highlight-question">will have accomplished</span> many amazing things.</p>

                                    <p>First, regarding her education, by 2030 she <span class="highlight-question">will have completed</span> her master's degree in environmental science. She's already started the program and knows she can finish it within five years.</p>

                                    <p>For her career, Sarah hopes that by that time, she <span class="highlight-question">will have worked</span> for several major environmental organizations. She also believes she <span class="highlight-question">will have published</span> at least three research papers in scientific journals.</p>

                                    <p>On a personal level, Sarah dreams of travel. By 2030, she <span class="highlight-question">will have visited</span> all seven continents. So far, she's been to three, so she needs to visit four more. She's particularly excited about Antarctica!</p>

                                    <p>Sarah also has financial goals. By the end of this decade, she <span class="highlight-question">will have saved</span> enough money to buy her first house. She's been saving carefully and investing wisely.</p>

                                    <p>Finally, by 2030, Sarah <span class="highlight-question">will have learned</span> to speak three foreign languages fluently. She's currently studying Spanish and plans to start French and Mandarin soon. By then, she <span class="highlight-question">will have become</span> the person she always dreamed of being.</p>
                                </div>
                            </div>
                        </div>

                        <div class="slide" data-section="reading">
                            <h2>Reading Analysis</h2>
                            <div class="explanation-box">
                                <h3>Notice the Pattern:</h3>
                                <div class="example-box">
                                    <p>• All actions will be completed BEFORE 2030</p>
                                    <p>• Shows goals with clear deadlines</p>
                                    <p>• Expresses confidence about future achievements</p>
                                    <p>• Uses "by" to indicate the deadline</p>
                                </div>

                                <h3>Key Sentences Explained:</h3>
                                <div class="example-box">
                                    <p>• "By 2030, she <strong>will have accomplished</strong> many things" - All achievements completed before 2030 arrives</p>
                                    <p>• "She <strong>will have visited</strong> all seven continents" - The traveling will be finished by that time</p>
                                    <p>• "She <strong>will have saved</strong> enough money" - The saving process completed by the deadline</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="slide-indicators" id="reading-indicators">
                        <span class="indicator-dot active" onclick="goToSlide(1)"></span>
                        <span class="indicator-dot" onclick="goToSlide(2)"></span>
                    </div>
                </div>
            </div>

            <!-- Media Section -->
            <div class="section" id="media">
                <div class="slideshow-container">
                    <div class="slide-content-wrapper">
                        <button class="slide-arrow prev" onclick="changeSlide(-1)">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                                <polyline points="15 18 9 12 15 6"></polyline>
                            </svg>
                        </button>
                        <button class="slide-arrow next" onclick="changeSlide(1)">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                                <polyline points="9 18 15 12 9 6"></polyline>
                            </svg>
                        </button>

                        <div class="slide active" data-section="media">
                            <h2>Video: Future Perfect Explained</h2>
                            <div class="explanation-box">
                                <p style="font-size: 1.1rem; margin-bottom: 20px;">Watch this video about the Future Perfect:</p>
                                <div style="text-align: center; margin: 30px 0;">
                                    <iframe width="800" height="450"
                                        src="https://www.youtube.com/embed/rSLE76_E0tc"
                                        style="border-radius: 15px; box-shadow: 0 8px 30px rgba(0,0,0,0.2);"
                                        frameborder="0"
                                        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                                        allowfullscreen>
                                    </iframe>
                                </div>
                                <p style="font-size: 1rem; color: #666; text-align: center; font-style: italic;">
                                    Learn how to form and use the Future Perfect tense
                                </p>
                            </div>
                        </div>

                        <div class="slide" data-section="media">
                            <h2>Video: Future Perfect Practice</h2>
                            <div class="explanation-box">
                                <p style="font-size: 1.1rem; margin-bottom: 20px;">Future Perfect with exercises:</p>
                                <div style="text-align: center; margin: 30px 0;">
                                    <iframe width="800" height="450"
                                        src="https://www.youtube.com/embed/hQ-LScEqG-s"
                                        style="border-radius: 15px; box-shadow: 0 8px 30px rgba(0,0,0,0.2);"
                                        frameborder="0"
                                        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                                        allowfullscreen>
                                    </iframe>
                                </div>
                                <p style="font-size: 1rem; color: #666; text-align: center; font-style: italic;">
                                    Understanding when to use Future Perfect
                                </p>
                            </div>
                        </div>
                    </div>
                    <div class="slide-indicators" id="media-indicators">
                        <span class="indicator-dot active" onclick="goToSlide(1)"></span>
                        <span class="indicator-dot" onclick="goToSlide(2)"></span>
                    </div>
                </div>
            </div>

            <!-- Practice Section -->
            <div class="section" id="practice">
                <div class="slideshow-container">
                    <div class="slide-content-wrapper">
                        <button class="slide-arrow prev" onclick="changeSlide(-1)">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                                <polyline points="15 18 9 12 15 6"></polyline>
                            </svg>
                        </button>
                        <button class="slide-arrow next" onclick="changeSlide(1)">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                                <polyline points="9 18 15 12 9 6"></polyline>
                            </svg>
                        </button>

                        <div class="slide active" data-section="practice">
                            <h2>Practice 1: Complete the form</h2>
                            <div class="exercise-container">
                                <div class="question-box">
                                    <p>"By next month, I ___ ___ my course." (will have + finish)</p>
                                    <input type="text" id="q1" placeholder="Type: will have finished" onkeypress="if(event.key==='Enter') checkAnswer1()">
                                    <button class="check-button" onclick="checkAnswer1()">Check Answer</button>
                                    <div id="feedback1" class="feedback"></div>
                                </div>
                            </div>
                        </div>

                        <div class="slide" data-section="practice">
                            <h2>Practice 2: Past participle</h2>
                            <div class="exercise-container">
                                <div class="question-box">
                                    <p>"By 2025, they ___ ___ here for 10 years." (will have + live)</p>
                                    <input type="text" id="q2" placeholder="Type: will have lived" onkeypress="if(event.key==='Enter') checkAnswer2()">
                                    <button class="check-button" onclick="checkAnswer2()">Check Answer</button>
                                    <div id="feedback2" class="feedback"></div>
                                </div>
                            </div>
                        </div>

                        <div class="slide" data-section="practice">
                            <h2>Practice 3: Complete the sentence</h2>
                            <div class="exercise-container">
                                <div class="question-box">
                                    <p>"By 6 PM, she ___ ___ all her tasks." (will have + complete)</p>
                                    <input type="text" id="q3" placeholder="Type: will have completed" onkeypress="if(event.key==='Enter') checkAnswer3()">
                                    <button class="check-button" onclick="checkAnswer3()">Check Answer</button>
                                    <div id="feedback3" class="feedback"></div>
                                </div>
                            </div>
                        </div>

                        <div class="slide" data-section="practice">
                            <h2>Practice 4: Will or Future Perfect?</h2>
                            <div class="exercise-container">
                                <div class="question-box">
                                    <p>"By tomorrow, I ___ the report." (will finish / will have finished)</p>
                                    <input type="text" id="q4" placeholder="Type the correct form" onkeypress="if(event.key==='Enter') checkAnswer4()">
                                    <button class="check-button" onclick="checkAnswer4()">Check Answer</button>
                                    <div id="feedback4" class="feedback"></div>
                                </div>
                            </div>
                        </div>

                        <div class="slide" data-section="practice">
                            <h2>Practice 5: Form with irregular verb</h2>
                            <div class="exercise-container">
                                <div class="question-box">
                                    <p>"By the time you arrive, we ___ ___." (will have + leave)</p>
                                    <input type="text" id="q5" placeholder="Type: will have left" onkeypress="if(event.key==='Enter') checkAnswer5()">
                                    <button class="check-button" onclick="checkAnswer5()">Check Answer</button>
                                    <div id="feedback5" class="feedback"></div>
                                </div>
                            </div>
                        </div>

                        <div class="slide" data-section="practice">
                            <h2>Practice 6: Fix the mistake</h2>
                            <div class="exercise-container">
                                <div class="question-box">
                                    <p>Fix: "By tomorrow, I will finished." → "___"</p>
                                    <input type="text" id="q6" placeholder="Type the correct sentence" onkeypress="if(event.key==='Enter') checkAnswer6()">
                                    <button class="check-button" onclick="checkAnswer6()">Check Answer</button>
                                    <div id="feedback6" class="feedback"></div>
                                </div>
                            </div>
                        </div>

                        <div class="slide" data-section="practice">
                            <h2>Practice 7: Choose the time marker</h2>
                            <div class="exercise-container">
                                <div class="question-box">
                                    <p>"___ next year, he will have graduated." (By/At/In?)</p>
                                    <input type="text" id="q7" placeholder="Type: By" onkeypress="if(event.key==='Enter') checkAnswer7()">
                                    <button class="check-button" onclick="checkAnswer7()">Check Answer</button>
                                    <div id="feedback7" class="feedback"></div>
                                </div>
                            </div>
                        </div>

                        <div class="slide" data-section="practice">
                            <h2>Practice 8: Complete with duration</h2>
                            <div class="exercise-container">
                                <div class="question-box">
                                    <p>"By the end of the year, we ___ ___ the project." (complete)</p>
                                    <input type="text" id="q8" placeholder="Type: will have completed" onkeypress="if(event.key==='Enter') checkAnswer8()">
                                    <button class="check-button" onclick="checkAnswer8()">Check Answer</button>
                                    <div id="feedback8" class="feedback"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="slide-indicators" id="practice-indicators">
                        <span class="indicator-dot active" onclick="goToSlide(1)"></span>
                        <span class="indicator-dot" onclick="goToSlide(2)"></span>
                        <span class="indicator-dot" onclick="goToSlide(3)"></span>
                        <span class="indicator-dot" onclick="goToSlide(4)"></span>
                        <span class="indicator-dot" onclick="goToSlide(5)"></span>
                        <span class="indicator-dot" onclick="goToSlide(6)"></span>
                        <span class="indicator-dot" onclick="goToSlide(7)"></span>
                        <span class="indicator-dot" onclick="goToSlide(8)"></span>
                    </div>
                </div>
            </div>

            <!-- Writing Section -->
            <div class="section" id="writing">
                <div class="slideshow-container">
                    <div class="slide-content-wrapper">
                        <button class="slide-arrow prev" onclick="changeSlide(-1)">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                                <polyline points="15 18 9 12 15 6"></polyline>
                            </svg>
                        </button>
                        <button class="slide-arrow next" onclick="changeSlide(1)">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                                <polyline points="9 18 15 12 9 6"></polyline>
                            </svg>
                        </button>

                        <div class="slide active" data-section="writing" style="overflow-y: auto;">
                            <h2>Writing Practice</h2>
                            <div class="explanation-box">
                                <h3>Write about your goals for the future</h3>
                                <p style="margin-bottom: 15px;">Use the Future Perfect to describe what you will have accomplished by a specific time.</p>
                                <div class="question-box">
                                    <textarea id="writing1" rows="8" style="width: 100%; padding: 12px; border: 2px solid rgba(102, 126, 234, 0.3); border-radius: 8px; font-size: 1.05rem; font-family: 'Inter', sans-serif; resize: vertical;" spellcheck="true" placeholder="By the year 2030, I will have achieved many goals. By then, I will have completed my degree. By age 30, I will have saved enough money..."></textarea>
                                    <div style="display: flex; gap: 10px; margin-top: 10px;">
                                        <button class="check-button" onclick="checkGrammar()">Check Grammar</button>
                                        <button id="send-teacher-btn" class="check-button" onclick="sendToTeacher()" style="background: linear-gradient(135deg, #48bb78 0%, #38a169 100%); opacity: 0.5; cursor: not-allowed;" disabled>Send to Teacher</button>
                                    </div>
                                    <div id="grammar-feedback" style="margin-top: 15px; padding: 15px; border-radius: 8px; display: none;"></div>
                                    <p style="font-size: 0.95rem; color: #666; margin-top: 10px;">Example: By 2030, I will have completed my master's degree. By then, I will have visited 20 countries.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="slide-indicators" id="writing-indicators">
                        <span class="indicator-dot active" onclick="goToSlide(1)"></span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let currentSlide = 1;
        let currentSection = 'explanation';

        function showSection(sectionName, element) {
            const sections = document.querySelectorAll('.section');
            sections.forEach(section => section.classList.remove('active'));

            const navItems = document.querySelectorAll('.nav-item');
            navItems.forEach(item => item.classList.remove('active'));

            document.getElementById(sectionName).classList.add('active');

            if (element) {
                element.classList.add('active');
            }

            currentSection = sectionName;
            currentSlide = 1;

            setTimeout(() => {
                const activeSection = document.querySelector('.section.active');
                const inputField = activeSection.querySelector('input[type="text"]');
                if (inputField) {
                    inputField.focus();
                }
            }, 100);
        }

        function changeSlide(direction) {
            const activeSection = document.querySelector('.section.active');
            const slides = activeSection.querySelectorAll('.slide');
            const dots = activeSection.querySelectorAll('.indicator-dot');

            if (slides.length === 1) return;

            slides[currentSlide - 1].classList.remove('active');
            dots[currentSlide - 1].classList.remove('active');

            currentSlide += direction;

            if (currentSlide > slides.length) {
                currentSlide = 1;
            }
            if (currentSlide < 1) {
                currentSlide = slides.length;
            }

            slides[currentSlide - 1].classList.add('active');
            dots[currentSlide - 1].classList.add('active');

            setTimeout(() => {
                const activeSlide = slides[currentSlide - 1];
                const inputField = activeSlide.querySelector('input[type="text"]');
                if (inputField) {
                    inputField.focus();
                    inputField.value = '';
                }
            }, 100);
        }

        function goToSlide(slideNum) {
            const activeSection = document.querySelector('.section.active');
            const slides = activeSection.querySelectorAll('.slide');
            const dots = activeSection.querySelectorAll('.indicator-dot');

            slides[currentSlide - 1].classList.remove('active');
            dots[currentSlide - 1].classList.remove('active');

            currentSlide = slideNum;

            slides[currentSlide - 1].classList.add('active');
            dots[currentSlide - 1].classList.add('active');
        }

        document.addEventListener('keydown', function(e) {
            if (e.key === 'ArrowLeft') {
                changeSlide(-1);
            } else if (e.key === 'ArrowRight') {
                changeSlide(1);
            }
        });

        function checkAnswer1() {
            const answer = document.getElementById('q1').value.trim().toLowerCase();
            const feedback = document.getElementById('feedback1');

            if (answer === 'will have finished' || answer === "'ll have finished") {
                feedback.className = 'feedback correct';
                feedback.textContent = '✓ Perfect! "will have finished" - Use WILL HAVE with past participle.';
                setTimeout(() => { changeSlide(1); }, 1500);
            } else {
                feedback.className = 'feedback incorrect';
                feedback.textContent = '✗ Use WILL HAVE + past participle: will have finished';
            }
        }

        function checkAnswer2() {
            const answer = document.getElementById('q2').value.trim().toLowerCase();
            const feedback = document.getElementById('feedback2');

            if (answer === 'will have lived' || answer === "'ll have lived") {
                feedback.className = 'feedback correct';
                feedback.textContent = '✓ Excellent! "will have lived" - Past participle of live is lived.';
                setTimeout(() => { changeSlide(1); }, 1500);
            } else {
                feedback.className = 'feedback incorrect';
                feedback.textContent = '✗ Use will have + lived: will have lived';
            }
        }

        function checkAnswer3() {
            const answer = document.getElementById('q3').value.trim().toLowerCase();
            const feedback = document.getElementById('feedback3');

            if (answer === 'will have completed' || answer === "'ll have completed") {
                feedback.className = 'feedback correct';
                feedback.textContent = '✓ Correct! "will have completed"';
                setTimeout(() => { changeSlide(1); }, 1500);
            } else {
                feedback.className = 'feedback incorrect';
                feedback.textContent = '✗ Use will have + completed: will have completed';
            }
        }

        function checkAnswer4() {
            const answer = document.getElementById('q4').value.trim().toLowerCase();
            const feedback = document.getElementById('feedback4');

            if (answer === 'will have finished' || answer === "'ll have finished") {
                feedback.className = 'feedback correct';
                feedback.textContent = '✓ Perfect! Use Future Perfect with "by": will have finished';
                setTimeout(() => { changeSlide(1); }, 1500);
            } else {
                feedback.className = 'feedback incorrect';
                feedback.textContent = '✗ Use Future Perfect for completed action with "by": will have finished';
            }
        }

        function checkAnswer5() {
            const answer = document.getElementById('q5').value.trim().toLowerCase();
            const feedback = document.getElementById('feedback5');

            if (answer === 'will have left' || answer === "'ll have left") {
                feedback.className = 'feedback correct';
                feedback.textContent = '✓ Correct! "will have left" - left is past participle of leave.';
                setTimeout(() => { changeSlide(1); }, 1500);
            } else {
                feedback.className = 'feedback incorrect';
                feedback.textContent = '✗ Use: will have left (leave-left-left)';
            }
        }

        function checkAnswer6() {
            const answer = document.getElementById('q6').value.trim().toLowerCase();
            const feedback = document.getElementById('feedback6');

            if (answer === 'by tomorrow, i will have finished' || answer === 'by tomorrow, i will have finished.') {
                feedback.className = 'feedback correct';
                feedback.textContent = '✓ Great! Need "have" between will and finished.';
                setTimeout(() => { changeSlide(1); }, 1500);
            } else {
                feedback.className = 'feedback incorrect';
                feedback.textContent = '✗ Correct form: By tomorrow, I will have finished';
            }
        }

        function checkAnswer7() {
            const answer = document.getElementById('q7').value.trim().toLowerCase();
            const feedback = document.getElementById('feedback7');

            if (answer === 'by') {
                feedback.className = 'feedback correct';
                feedback.textContent = '✓ Perfect! "By" - Use BY with Future Perfect.';
                setTimeout(() => { changeSlide(1); }, 1500);
            } else {
                feedback.className = 'feedback incorrect';
                feedback.textContent = '✗ Use BY (not at or in) with Future Perfect: By next year';
            }
        }

        function checkAnswer8() {
            const answer = document.getElementById('q8').value.trim().toLowerCase();
            const feedback = document.getElementById('feedback8');

            if (answer === 'will have completed' || answer === "'ll have completed") {
                feedback.className = 'feedback correct';
                feedback.textContent = '✓ Excellent! "will have completed"';
                setTimeout(() => { changeSlide(1); }, 1500);
            } else {
                feedback.className = 'feedback incorrect';
                feedback.textContent = '✗ Use will have + past participle: will have completed';
            }
        }

        async function checkGrammar() {
            const text = document.getElementById('writing1').value;
            const feedbackDiv = document.getElementById('grammar-feedback');
            const textarea = document.getElementById('writing1');

            if (!text.trim()) {
                feedbackDiv.style.display = 'block';
                feedbackDiv.style.background = 'rgba(245, 101, 101, 0.1)';
                feedbackDiv.style.border = '1px solid rgba(245, 101, 101, 0.3)';
                feedbackDiv.style.color = '#c53030';
                feedbackDiv.innerHTML = '✗ Please write some sentences first!';
                return;
            }

            textarea.style.display = 'none';
            window.grammarCheckResult = { original: text, corrected: '' };

            feedbackDiv.style.display = 'block';
            feedbackDiv.style.background = 'rgba(102, 126, 234, 0.1)';
            feedbackDiv.style.border = '1px solid rgba(102, 126, 234, 0.3)';
            feedbackDiv.style.color = '#667eea';
            feedbackDiv.innerHTML = '⏳ Checking your grammar and spelling...';

            try {
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=AIzaSyBTH0NmDb3cqjrY6p7YROPIJel-iCxSxzs`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        contents: [{
                            parts: [{
                                text: `You are a strict grammar checker. Fix grammar and spelling errors. Do not change the meaning, style, or add punctuation unless absolutely necessary. Profanities are acceptable, but don't use shortened informal words like "cuz" or "wanna"\n\nText: "${text}"\n\nReturn only the corrected text with minimal changes.`
                            }]
                        }]
                    })
                });

                const data = await response.json();
                const correctedText = data.candidates?.[0]?.content?.parts?.[0]?.text?.trim() || text;

                if (correctedText !== text && correctedText.toLowerCase() !== text.toLowerCase()) {
                    const originalWords = text.split(/(\s+)/);
                    const correctedWords = correctedText.split(/(\s+)/);
                    let highlightedText = '';

                    originalWords.forEach((word, i) => {
                        if (word.match(/\s+/)) {
                            highlightedText += word;
                        } else if (correctedWords[i] && word.toLowerCase() !== correctedWords[i].toLowerCase()) {
                            highlightedText += `<span style="color: #e53e3e; font-weight: 600; background: rgba(245, 101, 101, 0.15); padding: 2px 4px; border-radius: 3px;">${word}</span>`;
                        } else {
                            highlightedText += word;
                        }
                    });

                    let html = `
                        <div style="margin-bottom: 20px;">
                            <strong style="color: #c53030;">Your Text (errors highlighted):</strong>
                            <div style="background: white; padding: 15px; border-radius: 8px; margin-top: 10px; border: 2px solid rgba(245, 101, 101, 0.3); line-height: 1.8;">
                                ${highlightedText}
                            </div>
                        </div>
                        <div>
                            <strong style="color: #2f855a;">Corrected Text:</strong>
                            <div style="background: rgba(72, 187, 120, 0.1); padding: 15px; border-radius: 8px; margin-top: 10px; border: 2px solid rgba(72, 187, 120, 0.3); color: #2d3748; line-height: 1.8;">
                                ${correctedText}
                            </div>
                        </div>
                    `;

                    feedbackDiv.style.background = 'rgba(245, 101, 101, 0.05)';
                    feedbackDiv.style.border = '1px solid rgba(245, 101, 101, 0.3)';
                    feedbackDiv.style.color = '#2d3748';
                    feedbackDiv.innerHTML = html;

                    window.grammarCheckResult.corrected = correctedText;
                    const sendBtn = document.getElementById('send-teacher-btn');
                    sendBtn.disabled = false;
                    sendBtn.style.opacity = '1';
                    sendBtn.style.cursor = 'pointer';
                } else {
                    feedbackDiv.style.background = 'rgba(72, 187, 120, 0.1)';
                    feedbackDiv.style.border = '1px solid rgba(72, 187, 120, 0.3)';
                    feedbackDiv.style.color = '#2f855a';
                    feedbackDiv.innerHTML = '✓ Perfect! No grammar or spelling errors detected!';

                    window.grammarCheckResult.corrected = text;
                    const sendBtn = document.getElementById('send-teacher-btn');
                    sendBtn.disabled = false;
                    sendBtn.style.opacity = '1';
                    sendBtn.style.cursor = 'pointer';
                }
            } catch (error) {
                feedbackDiv.style.background = 'rgba(245, 101, 101, 0.1)';
                feedbackDiv.style.border = '1px solid rgba(245, 101, 101, 0.3)';
                feedbackDiv.style.color = '#c53030';
                feedbackDiv.innerHTML = '✗ Unable to check grammar. Error: ' + error.message;
            }
        }

        function sendToTeacher() {
            const essayTitle = "B1-46: Future Perfect - Actions Completed by a Time";
            const originalText = window.grammarCheckResult.original;
            const correctedText = window.grammarCheckResult.corrected;

            const emailBody = `Essay Title: ${essayTitle}\n\nOriginal Essay:\n${originalText}\n\nWe made some changes:\n\nCorrected Text:\n${correctedText}`;
            const mailtoLink = `mailto:?subject=${encodeURIComponent(essayTitle)}&body=${encodeURIComponent(emailBody)}`;
            window.location.href = mailtoLink;
        }
    </script>
</body>
</html>
