<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>B1-42: Present Perfect Continuous - Duration, Recent Actions</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            height: 100vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 20px 40px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
        }

        .header-left {
            display: flex;
            flex-direction: column;
        }

        .header h1 {
            color: #2d3748;
            font-size: 2.5rem;
            font-weight: 700;
            margin: 0;
            letter-spacing: -0.5px;
        }

        .header .website {
            text-align: center;
            margin-top: 8px;
        }

        .header .website a {
            color: #4c51bf;
            text-decoration: none;
            font-size: 1.2rem;
            font-weight: 500;
            transition: color 0.3s ease;
        }

        .header .website a:hover {
            color: #553c9a;
        }

        .header-image {
            width: 120px;
            height: 80px;
            border-radius: 12px;
            object-fit: cover;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.15);
        }

        .container {
            display: flex;
            height: calc(100vh - 120px);
        }

        .navigation {
            width: 280px;
            background: rgba(45, 55, 72, 0.95);
            backdrop-filter: blur(10px);
            padding: 30px 20px;
            border-right: 1px solid rgba(255, 255, 255, 0.1);
        }

        .nav-item {
            padding: 16px 24px;
            margin: 8px 0;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            color: #e2e8f0;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            text-align: center;
            font-weight: 500;
            font-size: 1.1rem;
            backdrop-filter: blur(5px);
        }

        .nav-item:hover {
            background: rgba(255, 255, 255, 0.2);
            color: #ffffff;
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
        }

        .nav-item.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #ffffff;
            border-color: transparent;
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
        }

        .content {
            flex: 1;
            display: flex;
            flex-direction: column;
            height: 100%;
            overflow: hidden;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
        }

        .section {
            display: none;
            flex: 1;
            padding: 0;
            overflow: hidden;
            height: 100%;
            background: white;
        }

        .section.active {
            display: flex;
            flex-direction: column;
        }

        .slideshow-container {
            position: relative;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background: white;
            padding: 30px 80px;
        }

        .slide-content-wrapper {
            position: relative;
            width: 100%;
            max-width: 1400px;
            height: 85%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .slide {
            display: none;
            width: 100%;
            height: 100%;
            background: white;
            border-radius: 20px;
            padding: 25px 35px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .slide.active {
            display: flex;
            flex-direction: column;
            animation: slideIn 0.5s ease-in-out;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(30px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .slide-arrow {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: #8B7EC8;
            color: white;
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            z-index: 10;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }

        .slide-arrow:hover {
            background: #7366B0;
            transform: translateY(-50%) scale(1.1);
        }

        .slide-arrow.prev {
            left: -70px;
        }

        .slide-arrow.next {
            right: -70px;
        }

        .slide-indicators {
            position: absolute;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 12px;
            z-index: 10;
        }

        .indicator-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #D1D5DB;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .indicator-dot.active {
            background: #667eea;
            transform: scale(1.3);
        }

        .indicator-dot:hover {
            background: #9CA3AF;
        }

        .slide h2 {
            color: #2d3748;
            margin-bottom: 15px;
            font-size: 2rem;
            font-weight: 700;
            text-align: center;
            letter-spacing: -0.5px;
        }

        .explanation-box {
            background: transparent;
            border: none;
            border-radius: 0;
            padding: 0;
            margin-bottom: 0;
            backdrop-filter: none;
            box-shadow: none;
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow-y: auto;
            overflow-x: hidden;
        }

        .explanation-box h3 {
            color: #667eea;
            font-size: 1.3rem;
            margin-bottom: 10px;
            font-weight: 600;
        }

        .explanation-box p {
            color: #2d3748;
            line-height: 1.5;
            font-size: 1rem;
            margin-bottom: 8px;
        }

        .rule-box {
            background: #e3f2fd;
            padding: 15px 20px;
            border-radius: 10px;
            margin: 10px 0;
            border-left: 4px solid #667eea;
        }

        .rule-box h4 {
            color: #667eea;
            font-size: 1.2rem;
            margin-bottom: 8px;
            font-weight: 600;
        }

        .rule-box p {
            font-size: 1rem;
            color: #2d3748;
            margin: 5px 0;
        }

        .yes-no {
            display: inline-block;
            padding: 6px 12px;
            margin: 3px;
            border-radius: 6px;
            font-weight: 600;
            font-size: 1rem;
            background: #4299e1;
            color: white;
        }

        .auxiliary {
            display: inline-block;
            padding: 6px 12px;
            margin: 3px;
            border-radius: 6px;
            font-weight: 600;
            font-size: 1rem;
            background: #48bb78;
            color: white;
        }

        .subject {
            display: inline-block;
            padding: 6px 12px;
            margin: 3px;
            border-radius: 6px;
            font-weight: 600;
            font-size: 1rem;
            background: #9f7aea;
            color: white;
        }

        .verb {
            display: inline-block;
            padding: 6px 12px;
            margin: 3px;
            border-radius: 6px;
            font-weight: 600;
            font-size: 1rem;
            background: #ed64a6;
            color: white;
        }

        .example-box {
            background: #f7fafc;
            border-left: 4px solid #667eea;
            padding: 12px;
            border-radius: 8px;
            margin: 8px 0;
        }

        .example-box p {
            margin: 5px 0;
            font-size: 1rem;
            color: #2d3748;
        }

        .note-box {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 12px;
            margin: 10px 0;
            border-radius: 8px;
        }

        .note-box strong {
            color: #856404;
            font-size: 1rem;
        }

        .note-box p {
            color: #856404;
            margin-top: 5px;
            line-height: 1.4;
            font-size: 0.95rem;
        }

        .exercise-container {
            background: transparent;
            border: none;
            border-radius: 0;
            padding: 0;
            margin-bottom: 10px;
            backdrop-filter: none;
            box-shadow: none;
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .exercise-container h3 {
            color: #764ba2;
            font-size: 1.4rem;
            margin-bottom: 15px;
            font-weight: 600;
        }

        .question-box {
            background: #e3f2fd;
            padding: 20px;
            border-radius: 12px;
            margin: 0;
        }

        .question-box p {
            font-weight: 600;
            color: #2d3748;
            margin-bottom: 12px;
            font-size: 1.1rem;
        }

        input[type="text"] {
            width: 100%;
            padding: 12px 18px;
            margin: 8px 0;
            border: 2px solid rgba(102, 126, 234, 0.3);
            border-radius: 8px;
            font-size: 1.05rem;
            font-family: 'Inter', sans-serif;
            background: rgba(255, 255, 255, 0.8);
            transition: all 0.3s ease;
        }

        input[type="text"]:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 20px rgba(102, 126, 234, 0.2);
        }

        .check-button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #ffffff;
            border: none;
            padding: 12px 30px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1.1rem;
            font-weight: 600;
            margin: 15px 5px 10px 5px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }

        .check-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
        }

        .feedback {
            padding: 15px 20px;
            border-radius: 12px;
            margin: 15px 0;
            font-weight: 500;
            font-size: 1.05rem;
            display: none;
        }

        .feedback.correct {
            background: rgba(72, 187, 120, 0.1);
            color: #2f855a;
            border: 1px solid rgba(72, 187, 120, 0.3);
            display: block;
        }

        .feedback.incorrect {
            background: rgba(245, 101, 101, 0.1);
            color: #c53030;
            border: 1px solid rgba(245, 101, 101, 0.3);
            display: block;
        }

        ul {
            margin-left: 25px;
            line-height: 1.6;
        }

        li {
            margin: 6px 0;
            font-size: 1.05rem;
            color: #2d3748;
        }

        li strong {
            color: #667eea;
        }

        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin: 12px 0;
        }

        .comparison-table th {
            background: #667eea;
            color: white;
            padding: 10px;
            font-size: 1.05rem;
            font-weight: 600;
        }

        .comparison-table td {
            padding: 10px;
            border: 1px solid #e2e8f0;
            font-size: 1rem;
            text-align: center;
        }

        .comparison-table tr:nth-child(even) {
            background: #f7fafc;
        }

        .explanation-box::-webkit-scrollbar {
            width: 8px;
        }

        .explanation-box::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }

        .explanation-box::-webkit-scrollbar-thumb {
            background: #667eea;
            border-radius: 10px;
        }

        .explanation-box::-webkit-scrollbar-thumb:hover {
            background: #5568d3;
        }

        .formula-box {
            background: #e6fffa;
            border: 2px solid #319795;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            text-align: center;
            font-size: 1.3rem;
        }

        .grid-examples {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .grid-card {
            background: white;
            padding: 15px;
            border-radius: 10px;
            border: 2px solid #e2e8f0;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .grid-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .reading-text {
            background: #f7fafc;
            padding: 20px;
            border-radius: 10px;
            line-height: 1.9;
            margin: 15px 0;
            border: 2px solid #e2e8f0;
        }

        .reading-text p {
            margin: 12px 0;
        }

        .highlight-question {
            background: #bee3f8;
            padding: 2px 6px;
            border-radius: 4px;
            font-weight: bold;
        }

        .highlight-answer {
            background: #c6f6d5;
            padding: 2px 6px;
            border-radius: 4px;
            font-weight: bold;
        }

        .example-sentence {
            font-size: 1.1rem;
            margin: 10px 0;
            padding: 10px;
            background: white;
            border-radius: 8px;
            border-left: 3px solid #667eea;
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="header-left">
            <h1>B1-42: Present Perfect Continuous - Duration, Recent Actions</h1>
            <div class="website">
                <a href="https://www.mimlanguageservices.com/" target="_blank">mimlanguageservices</a>
            </div>
        </div>
        <a href="https://www.mimlanguageservices.com/" target="_blank">
            <img src="https://static.wixstatic.com/media/593d03_8958d96b0f6d4d1ea9dffa7f89bffe8b~mv2.png" alt="ESL Logo" class="header-image">
        </a>
    </div>

    <div class="container">
        <div class="navigation">
            <div class="nav-item active" onclick="showSection('explanation', this)">Explanation</div>
            <div class="nav-item" onclick="showSection('examples', this)">Examples</div>
            <div class="nav-item" onclick="showSection('reading', this)">Reading</div>
            <div class="nav-item" onclick="showSection('media', this)">Media</div>
            <div class="nav-item" onclick="showSection('practice', this)">Practice</div>
            <div class="nav-item" onclick="showSection('writing', this)">Writing</div>
        </div>

        <div class="content">
            <!-- Explanation Section -->
            <div class="section active" id="explanation">
                <div class="slideshow-container">
                    <div class="slide-content-wrapper">
                        <button class="slide-arrow prev" onclick="changeSlide(-1)">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                                <polyline points="15 18 9 12 15 6"></polyline>
                            </svg>
                        </button>
                        <button class="slide-arrow next" onclick="changeSlide(1)">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                                <polyline points="9 18 15 12 9 6"></polyline>
                            </svg>
                        </button>

                        <div class="slide active" data-section="explanation">
                            <h2>Welcome to Present Perfect Continuous!</h2>
                            <div class="explanation-box">
                                <p style="font-size: 1.2rem; text-align: center; margin: 20px 0;">
                                    Today we will learn the <span class="yes-no">PRESENT PERFECT CONTINUOUS</span> in English!
                                </p>
                                <p style="font-size: 1.1rem; text-align: center;">
                                    This tense emphasizes the DURATION and ONGOING nature of actions.
                                </p>
                                <div class="formula-box">
                                    <span class="auxiliary">HAVE/HAS BEEN</span> + <span class="verb">VERB + ING</span>
                                </div>
                                <p style="text-align: center; font-size: 1.1rem;">
                                    Example: I <strong>have been studying</strong> for 3 hours. / She <strong>has been working</strong> all day.
                                </p>
                            </div>
                        </div>

                        <div class="slide" data-section="explanation">
                            <h2>How to Form the Present Perfect Continuous</h2>
                            <div class="explanation-box">
                                <h3>The Structure</h3>

                                <div class="formula-box">
                                    <span class="subject">Subject</span> + <span class="auxiliary">have/has been</span> + <span class="verb">verb + ing</span>
                                </div>

                                <table class="comparison-table">
                                    <tr>
                                        <th>Subject</th>
                                        <th>Auxiliary</th>
                                        <th>Verb + ING</th>
                                        <th>Full Sentence</th>
                                    </tr>
                                    <tr>
                                        <td>I/You/We/They</td>
                                        <td>have been</td>
                                        <td>studying</td>
                                        <td>I have been studying.</td>
                                    </tr>
                                    <tr>
                                        <td>He/She/It</td>
                                        <td>has been</td>
                                        <td>working</td>
                                        <td>She has been working.</td>
                                    </tr>
                                    <tr>
                                        <td>We</td>
                                        <td>have been</td>
                                        <td>waiting</td>
                                        <td>We have been waiting.</td>
                                    </tr>
                                </table>

                                <div class="rule-box">
                                    <h4>Remember:</h4>
                                    <p>• Add <strong>-ing</strong> to the verb: work → work<strong>ing</strong>, play → play<strong>ing</strong></p>
                                    <p>• Drop final -e: make → mak<strong>ing</strong>, write → writ<strong>ing</strong></p>
                                    <p>• Double consonant: run → runn<strong>ing</strong>, sit → sitt<strong>ing</strong></p>
                                </div>
                            </div>
                        </div>

                        <div class="slide" data-section="explanation">
                            <h2>Use 1: Duration of Ongoing Actions</h2>
                            <div class="explanation-box">
                                <h3>Actions that started in the past and are STILL HAPPENING now</h3>

                                <div class="formula-box">
                                    <span class="auxiliary">have/has been</span> + <span class="verb">verb + ing</span> + <span class="yes-no">FOR/SINCE</span>
                                </div>

                                <table class="comparison-table">
                                    <tr>
                                        <th>Present Perfect Continuous</th>
                                        <th>Meaning</th>
                                    </tr>
                                    <tr>
                                        <td>I have been studying for 3 hours.</td>
                                        <td>I started 3 hours ago and I'm STILL studying now</td>
                                    </tr>
                                    <tr>
                                        <td>She has been working since 9am.</td>
                                        <td>She started at 9am and she's STILL working now</td>
                                    </tr>
                                    <tr>
                                        <td>They have been waiting for 30 minutes.</td>
                                        <td>They started 30 minutes ago and are STILL waiting</td>
                                    </tr>
                                </table>

                                <div class="rule-box">
                                    <h4>Key Point:</h4>
                                    <p>• The action is STILL IN PROGRESS right now</p>
                                    <p>• We emphasize HOW LONG the action has been happening</p>
                                    <p>• Use FOR (duration) or SINCE (starting point)</p>
                                </div>
                            </div>
                        </div>

                        <div class="slide" data-section="explanation">
                            <h2>Use 2: Recent Actions with Visible Results</h2>
                            <div class="explanation-box">
                                <h3>Actions that just finished with evidence NOW</h3>

                                <div class="formula-box">
                                    <span class="auxiliary">have/has been</span> + <span class="verb">verb + ing</span> (recently finished)
                                </div>

                                <table class="comparison-table">
                                    <tr>
                                        <th>Sentence</th>
                                        <th>Evidence/Result</th>
                                    </tr>
                                    <tr>
                                        <td>I have been running.</td>
                                        <td>I'm sweating, I'm tired (you can see I just ran)</td>
                                    </tr>
                                    <tr>
                                        <td>She has been cooking.</td>
                                        <td>The kitchen smells like food (evidence of cooking)</td>
                                    </tr>
                                    <tr>
                                        <td>They have been painting.</td>
                                        <td>They have paint on their clothes (visible evidence)</td>
                                    </tr>
                                </table>

                                <div class="rule-box">
                                    <h4>Key Point:</h4>
                                    <p>• The action just finished or recently stopped</p>
                                    <p>• There is EVIDENCE or VISIBLE RESULTS in the present</p>
                                    <p>• We can see, smell, or notice the effects NOW</p>
                                </div>
                            </div>
                        </div>

                        <div class="slide" data-section="explanation">
                            <h2>Present Perfect Simple vs Continuous</h2>
                            <div class="explanation-box">
                                <h3>When to use SIMPLE vs CONTINUOUS?</h3>

                                <table class="comparison-table">
                                    <tr>
                                        <th>Present Perfect Simple</th>
                                        <th>Present Perfect Continuous</th>
                                    </tr>
                                    <tr>
                                        <td>I <strong>have read</strong> 3 books.</td>
                                        <td>I <strong>have been reading</strong> all day.</td>
                                    </tr>
                                    <tr>
                                        <td>Focus: COMPLETED action/result</td>
                                        <td>Focus: DURATION/ongoing activity</td>
                                    </tr>
                                    <tr>
                                        <td>She <strong>has lived</strong> here for 5 years.</td>
                                        <td>She <strong>has been living</strong> here for 5 years.</td>
                                    </tr>
                                    <tr>
                                        <td>Focus: STATE (permanent)</td>
                                        <td>Focus: TEMPORARY situation</td>
                                    </tr>
                                    <tr>
                                        <td>I <strong>have cleaned</strong> the house.</td>
                                        <td>I <strong>have been cleaning</strong> the house.</td>
                                    </tr>
                                    <tr>
                                        <td>Finished! (the house is clean)</td>
                                        <td>Still in progress or just finished</td>
                                    </tr>
                                </table>

                                <div class="rule-box">
                                    <h4>Remember:</h4>
                                    <p>• SIMPLE = completed action, result, experience</p>
                                    <p>• CONTINUOUS = duration, ongoing, temporary, recent activity</p>
                                </div>
                            </div>
                        </div>

                        <div class="slide" data-section="explanation">
                            <h2>Common Mistakes</h2>
                            <div class="explanation-box">
                                <h3>❌ Mistake 1: Using stative verbs in continuous</h3>
                                <div class="example-box">
                                    <p>❌ I <del>have been knowing</del> her for years. → ✅ I <strong>have known</strong> her for years.</p>
                                    <p>❌ He <del>has been having</del> a car since 2020. → ✅ He <strong>has had</strong> a car since 2020.</p>
                                    <p><strong>Note:</strong> Don't use continuous with: know, have, be, like, love, want, need, understand</p>
                                </div>

                                <h3>❌ Mistake 2: Forgetting "been"</h3>
                                <div class="example-box">
                                    <p>❌ I <del>have studying</del> for 2 hours. → ✅ I <strong>have been studying</strong> for 2 hours.</p>
                                    <p>❌ She <del>has working</del> all day. → ✅ She <strong>has been working</strong> all day.</p>
                                </div>

                                <h3>❌ Mistake 3: Wrong form of verb</h3>
                                <div class="example-box">
                                    <p>❌ They have been <del>run</del>. → ✅ They have been <strong>running</strong>.</p>
                                    <p>❌ I have been <del>to study</del>. → ✅ I have been <strong>studying</strong>.</p>
                                </div>

                                <h3>❌ Mistake 4: Using it for completed actions with numbers</h3>
                                <div class="example-box">
                                    <p>❌ I <del>have been reading</del> 3 books. → ✅ I <strong>have read</strong> 3 books. (use Simple for completed count)</p>
                                    <p>✅ I have been reading for 3 hours. (duration = continuous OK)</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="slide-indicators" id="explanation-indicators">
                        <span class="indicator-dot active" onclick="goToSlide(1)"></span>
                        <span class="indicator-dot" onclick="goToSlide(2)"></span>
                        <span class="indicator-dot" onclick="goToSlide(3)"></span>
                        <span class="indicator-dot" onclick="goToSlide(4)"></span>
                        <span class="indicator-dot" onclick="goToSlide(5)"></span>
                        <span class="indicator-dot" onclick="goToSlide(6)"></span>
                    </div>
                </div>
            </div>

            <!-- Examples Section -->
            <div class="section" id="examples">
                <div class="slideshow-container">
                    <div class="slide-content-wrapper">
                        <button class="slide-arrow prev" onclick="changeSlide(-1)">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                                <polyline points="15 18 9 12 15 6"></polyline>
                            </svg>
                        </button>
                        <button class="slide-arrow next" onclick="changeSlide(1)">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                                <polyline points="9 18 15 12 9 6"></polyline>
                            </svg>
                        </button>

                        <div class="slide active" data-section="examples">
                            <h2>Duration Examples</h2>
                            <div class="explanation-box">
                                <h3>Ongoing actions with FOR/SINCE:</h3>
                                <div class="grid-examples">
                                    <div class="grid-card">
                                        <strong>With FOR (duration):</strong><br><br>
                                        • I <strong>have been studying</strong> for 3 hours.<br>
                                        • She <strong>has been working</strong> for 8 hours.<br>
                                        • They <strong>have been waiting</strong> for 20 minutes.<br>
                                        • We <strong>have been talking</strong> for a long time.
                                    </div>
                                    <div class="grid-card">
                                        <strong>With SINCE (starting point):</strong><br><br>
                                        • I <strong>have been studying</strong> since 2pm.<br>
                                        • She <strong>has been working</strong> since this morning.<br>
                                        • They <strong>have been waiting</strong> since 5 o'clock.<br>
                                        • We <strong>have been talking</strong> since yesterday.
                                    </div>
                                </div>

                                <h3>All Day/All Week/All Morning:</h3>
                                <div class="grid-examples">
                                    <div class="grid-card">
                                        <strong>Time Expressions:</strong><br><br>
                                        • I <strong>have been working</strong> all day.<br>
                                        • She <strong>has been sleeping</strong> all morning.<br>
                                        • They <strong>have been training</strong> all week.<br>
                                        • He <strong>has been practicing</strong> all afternoon.
                                    </div>
                                    <div class="grid-card">
                                        <strong>How long...?</strong><br><br>
                                        • How long <strong>have you been studying</strong>?<br>
                                        • How long <strong>has she been living</strong> there?<br>
                                        • How long <strong>have they been waiting</strong>?<br>
                                        • How long <strong>has he been working</strong>?
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="slide" data-section="examples">
                            <h2>Recent Actions with Results</h2>
                            <div class="explanation-box">
                                <h3>Actions just finished with visible evidence:</h3>

                                <table class="comparison-table">
                                    <tr>
                                        <th>Statement</th>
                                        <th>Evidence/Result</th>
                                    </tr>
                                    <tr>
                                        <td>I have been running.</td>
                                        <td>I'm tired, I'm sweating</td>
                                    </tr>
                                    <tr>
                                        <td>She has been crying.</td>
                                        <td>Her eyes are red</td>
                                    </tr>
                                    <tr>
                                        <td>They have been cooking.</td>
                                        <td>The kitchen smells amazing</td>
                                    </tr>
                                    <tr>
                                        <td>He has been painting.</td>
                                        <td>He has paint on his hands</td>
                                    </tr>
                                    <tr>
                                        <td>We have been cleaning.</td>
                                        <td>The house looks better now</td>
                                    </tr>
                                </table>

                                <h3>Complete Sentences:</h3>
                                <div class="example-box">
                                    <p>• You look tired! <strong>Have you been working</strong> hard?</p>
                                    <p>• Your hands are dirty. <strong>Have you been gardening</strong>?</p>
                                    <p>• She <strong>has been studying</strong> - that's why she looks exhausted.</p>
                                    <p>• They <strong>have been playing</strong> soccer - they're all sweaty!</p>
                                    <p>• It <strong>has been raining</strong> - the streets are wet.</p>
                                </div>
                            </div>
                        </div>

                        <div class="slide" data-section="examples">
                            <h2>Simple vs Continuous Comparison</h2>
                            <div class="explanation-box">
                                <h3>Understanding the difference:</h3>

                                <table class="comparison-table">
                                    <tr>
                                        <th>Present Perfect Simple</th>
                                        <th>Present Perfect Continuous</th>
                                    </tr>
                                    <tr>
                                        <td>I <strong>have written</strong> 10 emails.</td>
                                        <td>I <strong>have been writing</strong> emails all morning.</td>
                                    </tr>
                                    <tr>
                                        <td>(completed - focus on number)</td>
                                        <td>(duration - focus on activity)</td>
                                    </tr>
                                    <tr>
                                        <td>She <strong>has painted</strong> the room.</td>
                                        <td>She <strong>has been painting</strong> the room.</td>
                                    </tr>
                                    <tr>
                                        <td>(finished - the room is done)</td>
                                        <td>(maybe still painting or just finished)</td>
                                    </tr>
                                    <tr>
                                        <td>They <strong>have lived</strong> here for 10 years.</td>
                                        <td>They <strong>have been living</strong> here for 10 years.</td>
                                    </tr>
                                    <tr>
                                        <td>(permanent situation)</td>
                                        <td>(temporary situation - might move)</td>
                                    </tr>
                                </table>

                                <div class="rule-box">
                                    <h4>Remember:</h4>
                                    <p>Use CONTINUOUS when you want to emphasize:</p>
                                    <p>• How LONG something has been happening</p>
                                    <p>• The ONGOING nature of the activity</p>
                                    <p>• RECENT actions with visible results</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="slide-indicators" id="examples-indicators">
                        <span class="indicator-dot active" onclick="goToSlide(1)"></span>
                        <span class="indicator-dot" onclick="goToSlide(2)"></span>
                        <span class="indicator-dot" onclick="goToSlide(3)"></span>
                    </div>
                </div>
            </div>

            <!-- Reading Section -->
            <div class="section" id="reading">
                <div class="slideshow-container">
                    <div class="slide-content-wrapper">
                        <button class="slide-arrow prev" onclick="changeSlide(-1)">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                                <polyline points="15 18 9 12 15 6"></polyline>
                            </svg>
                        </button>
                        <button class="slide-arrow next" onclick="changeSlide(1)">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                                <polyline points="9 18 15 12 9 6"></polyline>
                            </svg>
                        </button>

                        <div class="slide active" data-section="reading">
                            <h2>Reading: A Busy Day</h2>
                            <div class="explanation-box">
                                <div class="reading-text">
                                    <p><strong>My Busy Day Today</strong></p>

                                    <p>I'm exhausted! I <span class="highlight-question">have been working</span> since 7am this morning, and it's now 9pm. I <span class="highlight-question">have been preparing</span> for a big presentation <span class="highlight-question">for the past three days</span>.</p>

                                    <p>My colleague Sarah looks tired too. She <span class="highlight-question">has been helping</span> me all week. We <span class="highlight-question">have been staying</span> late at the office every night. Tonight, we finally finished!</p>

                                    <p>When I got home, I noticed my roommate <span class="highlight-question">has been cooking</span> - the kitchen smells amazing! He <span class="highlight-question">has been making</span> his famous pasta. I can see he <span class="highlight-question">has been cleaning</span> the apartment too - everything looks spotless.</p>

                                    <p>I called my sister. She sounds happy because she <span class="highlight-question">has been traveling</span> around Europe <span class="highlight-question">for two weeks</span>. She <span class="highlight-question">has been visiting</span> different cities and <span class="highlight-question">has been taking</span> lots of photos.</p>

                                    <p>Now I'm finally relaxing. I <span class="highlight-question">have been watching</span> TV <span class="highlight-question">for 30 minutes</span>, and I can feel myself getting sleepy. It <span class="highlight-question">has been raining</span> outside <span class="highlight-question">since this afternoon</span>, so I'm glad to be inside and warm!</p>
                                </div>
                            </div>
                        </div>

                        <div class="slide" data-section="reading">
                            <h2>Reading Analysis</h2>
                            <div class="explanation-box">
                                <h3>Duration with FOR/SINCE:</h3>
                                <div class="example-box">
                                    <p>• <strong>have been working since 7am</strong> (started at 7am, still tired NOW)</p>
                                    <p>• <strong>have been preparing for the past three days</strong> (started 3 days ago)</p>
                                    <p>• <strong>have been traveling for two weeks</strong> (duration: 2 weeks)</p>
                                    <p>• <strong>have been watching for 30 minutes</strong> (duration: 30 minutes)</p>
                                    <p>• <strong>has been raining since this afternoon</strong> (started this afternoon)</p>
                                </div>

                                <h3>Ongoing Actions (still happening or temporary):</h3>
                                <div class="example-box">
                                    <p>• <strong>has been helping</strong> me all week (temporary situation)</p>
                                    <p>• <strong>have been staying</strong> late (ongoing temporary activity)</p>
                                    <p>• <strong>has been visiting</strong> different cities (still traveling)</p>
                                    <p>• <strong>has been taking</strong> lots of photos (ongoing activity)</p>
                                </div>

                                <h3>Recent Actions with Evidence:</h3>
                                <div class="example-box">
                                    <p>• <strong>has been cooking</strong> - evidence: kitchen smells amazing</p>
                                    <p>• <strong>has been cleaning</strong> - evidence: apartment looks spotless</p>
                                    <p>• I'm exhausted - evidence I <strong>have been working</strong></p>
                                    <p>• She looks tired - she <strong>has been helping</strong></p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="slide-indicators" id="reading-indicators">
                        <span class="indicator-dot active" onclick="goToSlide(1)"></span>
                        <span class="indicator-dot" onclick="goToSlide(2)"></span>
                    </div>
                </div>
            </div>

            <!-- Media Section -->
            <div class="section" id="media">
                <div class="slideshow-container">
                    <div class="slide-content-wrapper">
                        <button class="slide-arrow prev" onclick="changeSlide(-1)">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                                <polyline points="15 18 9 12 15 6"></polyline>
                            </svg>
                        </button>
                        <button class="slide-arrow next" onclick="changeSlide(1)">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                                <polyline points="9 18 15 12 9 6"></polyline>
                            </svg>
                        </button>

                        <div class="slide active" data-section="media">
                            <h2>Video: Present Perfect Continuous</h2>
                            <div class="explanation-box">
                                <p style="font-size: 1.1rem; margin-bottom: 20px;">Watch this video about the Present Perfect Continuous:</p>
                                <div style="text-align: center; margin: 30px 0;">
                                    <iframe width="800" height="450"
                                        src="https://www.youtube.com/embed/KkDSvTh1bfM"
                                        style="border-radius: 15px; box-shadow: 0 8px 30px rgba(0,0,0,0.2);"
                                        frameborder="0"
                                        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                                        allowfullscreen>
                                    </iframe>
                                </div>
                                <p style="font-size: 1rem; color: #666; text-align: center; font-style: italic;">
                                    Learn how to form and use the Present Perfect Continuous tense
                                </p>
                            </div>
                        </div>

                        <div class="slide" data-section="media">
                            <h2>Video: Simple vs Continuous</h2>
                            <div class="explanation-box">
                                <p style="font-size: 1.1rem; margin-bottom: 20px;">Present Perfect Simple vs Continuous:</p>
                                <div style="text-align: center; margin: 30px 0;">
                                    <iframe width="800" height="450"
                                        src="https://www.youtube.com/embed/TrmaOVIa32c"
                                        style="border-radius: 15px; box-shadow: 0 8px 30px rgba(0,0,0,0.2);"
                                        frameborder="0"
                                        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                                        allowfullscreen>
                                    </iframe>
                                </div>
                                <p style="font-size: 1rem; color: #666; text-align: center; font-style: italic;">
                                    Understanding when to use Simple vs Continuous
                                </p>
                            </div>
                        </div>
                    </div>
                    <div class="slide-indicators" id="media-indicators">
                        <span class="indicator-dot active" onclick="goToSlide(1)"></span>
                        <span class="indicator-dot" onclick="goToSlide(2)"></span>
                    </div>
                </div>
            </div>

            <!-- Practice Section -->
            <div class="section" id="practice">
                <div class="slideshow-container">
                    <div class="slide-content-wrapper">
                        <button class="slide-arrow prev" onclick="changeSlide(-1)">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                                <polyline points="15 18 9 12 15 6"></polyline>
                            </svg>
                        </button>
                        <button class="slide-arrow next" onclick="changeSlide(1)">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                                <polyline points="9 18 15 12 9 6"></polyline>
                            </svg>
                        </button>

                        <div class="slide active" data-section="practice">
                            <h2>Practice 1: Complete the form</h2>
                            <div class="exercise-container">
                                <div class="question-box">
                                    <p>"I ___ ___ studying for 3 hours." (have/has + been)</p>
                                    <input type="text" id="q1" placeholder="Type: have been or has been" onkeypress="if(event.key==='Enter') checkAnswer1()">
                                    <button class="check-button" onclick="checkAnswer1()">Check Answer</button>
                                    <div id="feedback1" class="feedback"></div>
                                </div>
                            </div>
                        </div>

                        <div class="slide" data-section="practice">
                            <h2>Practice 2: Add -ing</h2>
                            <div class="exercise-container">
                                <div class="question-box">
                                    <p>"She has been ___ all day." (work + ing)</p>
                                    <input type="text" id="q2" placeholder="Type the verb with -ing" onkeypress="if(event.key==='Enter') checkAnswer2()">
                                    <button class="check-button" onclick="checkAnswer2()">Check Answer</button>
                                    <div id="feedback2" class="feedback"></div>
                                </div>
                            </div>
                        </div>

                        <div class="slide" data-section="practice">
                            <h2>Practice 3: Complete the sentence</h2>
                            <div class="exercise-container">
                                <div class="question-box">
                                    <p>"They have ___ waiting for 30 minutes." (Add the missing word)</p>
                                    <input type="text" id="q3" placeholder="Type: been" onkeypress="if(event.key==='Enter') checkAnswer3()">
                                    <button class="check-button" onclick="checkAnswer3()">Check Answer</button>
                                    <div id="feedback3" class="feedback"></div>
                                </div>
                            </div>
                        </div>

                        <div class="slide" data-section="practice">
                            <h2>Practice 4: Simple or Continuous?</h2>
                            <div class="exercise-container">
                                <div class="question-box">
                                    <p>"I ___ 5 books this month." (have read / have been reading)</p>
                                    <input type="text" id="q4" placeholder="Type the correct form" onkeypress="if(event.key==='Enter') checkAnswer4()">
                                    <button class="check-button" onclick="checkAnswer4()">Check Answer</button>
                                    <div id="feedback4" class="feedback"></div>
                                </div>
                            </div>
                        </div>

                        <div class="slide" data-section="practice">
                            <h2>Practice 5: Form the question</h2>
                            <div class="exercise-container">
                                <div class="question-box">
                                    <p>"How long ___ you ___ studying?" (Complete the question)</p>
                                    <input type="text" id="q5" placeholder="Type: have been" onkeypress="if(event.key==='Enter') checkAnswer5()">
                                    <button class="check-button" onclick="checkAnswer5()">Check Answer</button>
                                    <div id="feedback5" class="feedback"></div>
                                </div>
                            </div>
                        </div>

                        <div class="slide" data-section="practice">
                            <h2>Practice 6: Fix the mistake</h2>
                            <div class="exercise-container">
                                <div class="question-box">
                                    <p>Fix: "I have knowing her for years." → "___"</p>
                                    <input type="text" id="q6" placeholder="Type the correct sentence" onkeypress="if(event.key==='Enter') checkAnswer6()">
                                    <button class="check-button" onclick="checkAnswer6()">Check Answer</button>
                                    <div id="feedback6" class="feedback"></div>
                                </div>
                            </div>
                        </div>

                        <div class="slide" data-section="practice">
                            <h2>Practice 7: Choose the verb form</h2>
                            <div class="exercise-container">
                                <div class="question-box">
                                    <p>"She has been ___ since 9am." (run + ing - spell correctly)</p>
                                    <input type="text" id="q7" placeholder="Type the -ing form" onkeypress="if(event.key==='Enter') checkAnswer7()">
                                    <button class="check-button" onclick="checkAnswer7()">Check Answer</button>
                                    <div id="feedback7" class="feedback"></div>
                                </div>
                            </div>
                        </div>

                        <div class="slide" data-section="practice">
                            <h2>Practice 8: Complete with for/since</h2>
                            <div class="exercise-container">
                                <div class="question-box">
                                    <p>"I have been waiting ___ 2 o'clock." (for or since?)</p>
                                    <input type="text" id="q8" placeholder="Type: for or since" onkeypress="if(event.key==='Enter') checkAnswer8()">
                                    <button class="check-button" onclick="checkAnswer8()">Check Answer</button>
                                    <div id="feedback8" class="feedback"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="slide-indicators" id="practice-indicators">
                        <span class="indicator-dot active" onclick="goToSlide(1)"></span>
                        <span class="indicator-dot" onclick="goToSlide(2)"></span>
                        <span class="indicator-dot" onclick="goToSlide(3)"></span>
                        <span class="indicator-dot" onclick="goToSlide(4)"></span>
                        <span class="indicator-dot" onclick="goToSlide(5)"></span>
                        <span class="indicator-dot" onclick="goToSlide(6)"></span>
                        <span class="indicator-dot" onclick="goToSlide(7)"></span>
                        <span class="indicator-dot" onclick="goToSlide(8)"></span>
                    </div>
                </div>
            </div>

            <!-- Writing Section -->
            <div class="section" id="writing">
                <div class="slideshow-container">
                    <div class="slide-content-wrapper">
                        <button class="slide-arrow prev" onclick="changeSlide(-1)">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                                <polyline points="15 18 9 12 15 6"></polyline>
                            </svg>
                        </button>
                        <button class="slide-arrow next" onclick="changeSlide(1)">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                                <polyline points="9 18 15 12 9 6"></polyline>
                            </svg>
                        </button>

                        <div class="slide active" data-section="writing" style="overflow-y: auto;">
                            <h2>Writing Practice</h2>
                            <div class="explanation-box">
                                <h3>Write 10 sentences about recent and ongoing activities</h3>
                                <p style="margin-bottom: 15px;">Use the Present Perfect Continuous to describe what you and others have been doing.</p>
                                <div class="question-box">
                                    <textarea id="writing1" rows="8" style="width: 100%; padding: 12px; border: 2px solid rgba(102, 126, 234, 0.3); border-radius: 8px; font-size: 1.05rem; font-family: 'Inter', sans-serif; resize: vertical;" spellcheck="true" placeholder="I have been studying English for 2 years. My friend has been working all day. It has been raining since this morning..."></textarea>
                                    <div style="display: flex; gap: 10px; margin-top: 10px;">
                                        <button class="check-button" onclick="checkGrammar()">Check Grammar</button>
                                        <button id="send-teacher-btn" class="check-button" onclick="sendToTeacher()" style="background: linear-gradient(135deg, #48bb78 0%, #38a169 100%); opacity: 0.5; cursor: not-allowed;" disabled>Send to Teacher</button>
                                    </div>
                                    <div id="grammar-feedback" style="margin-top: 15px; padding: 15px; border-radius: 8px; display: none;"></div>
                                    <p style="font-size: 0.95rem; color: #666; margin-top: 10px;">Example: I have been studying for 3 hours. She has been working since 9am. They have been playing soccer all afternoon.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="slide-indicators" id="writing-indicators">
                        <span class="indicator-dot active" onclick="goToSlide(1)"></span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let currentSlide = 1;
        let currentSection = 'explanation';

        function showSection(sectionName, element) {
            const sections = document.querySelectorAll('.section');
            sections.forEach(section => section.classList.remove('active'));

            const navItems = document.querySelectorAll('.nav-item');
            navItems.forEach(item => item.classList.remove('active'));

            document.getElementById(sectionName).classList.add('active');

            if (element) {
                element.classList.add('active');
            }

            currentSection = sectionName;
            currentSlide = 1;

            setTimeout(() => {
                const activeSection = document.querySelector('.section.active');
                const inputField = activeSection.querySelector('input[type="text"]');
                if (inputField) {
                    inputField.focus();
                }
            }, 100);
        }

        function changeSlide(direction) {
            const activeSection = document.querySelector('.section.active');
            const slides = activeSection.querySelectorAll('.slide');
            const dots = activeSection.querySelectorAll('.indicator-dot');

            if (slides.length === 1) return;

            slides[currentSlide - 1].classList.remove('active');
            dots[currentSlide - 1].classList.remove('active');

            currentSlide += direction;

            if (currentSlide > slides.length) {
                currentSlide = 1;
            }
            if (currentSlide < 1) {
                currentSlide = slides.length;
            }

            slides[currentSlide - 1].classList.add('active');
            dots[currentSlide - 1].classList.add('active');

            setTimeout(() => {
                const activeSlide = slides[currentSlide - 1];
                const inputField = activeSlide.querySelector('input[type="text"]');
                if (inputField) {
                    inputField.focus();
                    inputField.value = '';
                }
            }, 100);
        }

        function goToSlide(slideNum) {
            const activeSection = document.querySelector('.section.active');
            const slides = activeSection.querySelectorAll('.slide');
            const dots = activeSection.querySelectorAll('.indicator-dot');

            slides[currentSlide - 1].classList.remove('active');
            dots[currentSlide - 1].classList.remove('active');

            currentSlide = slideNum;

            slides[currentSlide - 1].classList.add('active');
            dots[currentSlide - 1].classList.add('active');
        }

        document.addEventListener('keydown', function(e) {
            if (e.key === 'ArrowLeft') {
                changeSlide(-1);
            } else if (e.key === 'ArrowRight') {
                changeSlide(1);
            }
        });

        function checkAnswer1() {
            const answer = document.getElementById('q1').value.trim().toLowerCase();
            const feedback = document.getElementById('feedback1');

            if (answer === 'have been') {
                feedback.className = 'feedback correct';
                feedback.textContent = '✓ Perfect! "I have been studying" - Use HAVE BEEN with I/you/we/they.';
                setTimeout(() => { changeSlide(1); }, 1500);
            } else {
                feedback.className = 'feedback incorrect';
                feedback.textContent = '✗ Use HAVE BEEN with I: I have been studying';
            }
        }

        function checkAnswer2() {
            const answer = document.getElementById('q2').value.trim().toLowerCase();
            const feedback = document.getElementById('feedback2');

            if (answer === 'working') {
                feedback.className = 'feedback correct';
                feedback.textContent = '✓ Excellent! "working" - Add -ing to the verb.';
                setTimeout(() => { changeSlide(1); }, 1500);
            } else {
                feedback.className = 'feedback incorrect';
                feedback.textContent = '✗ Add -ing to work: working';
            }
        }

        function checkAnswer3() {
            const answer = document.getElementById('q3').value.trim().toLowerCase();
            const feedback = document.getElementById('feedback3');

            if (answer === 'been') {
                feedback.className = 'feedback correct';
                feedback.textContent = '✓ Correct! "have been waiting" - Don\'t forget BEEN!';
                setTimeout(() => { changeSlide(1); }, 1500);
            } else {
                feedback.className = 'feedback incorrect';
                feedback.textContent = '✗ The missing word is "been": They have been waiting';
            }
        }

        function checkAnswer4() {
            const answer = document.getElementById('q4').value.trim().toLowerCase();
            const feedback = document.getElementById('feedback4');

            if (answer === 'have read') {
                feedback.className = 'feedback correct';
                feedback.textContent = '✓ Perfect! Use Simple for completed actions with numbers: have read';
                setTimeout(() => { changeSlide(1); }, 1500);
            } else {
                feedback.className = 'feedback incorrect';
                feedback.textContent = '✗ Use Present Perfect Simple for completed count: I have read 5 books';
            }
        }

        function checkAnswer5() {
            const answer = document.getElementById('q5').value.trim().toLowerCase();
            const feedback = document.getElementById('feedback5');

            if (answer === 'have been') {
                feedback.className = 'feedback correct';
                feedback.textContent = '✓ Correct! "How long have you been studying?"';
                setTimeout(() => { changeSlide(1); }, 1500);
            } else {
                feedback.className = 'feedback incorrect';
                feedback.textContent = '✗ Use "have been": How long have you been studying?';
            }
        }

        function checkAnswer6() {
            const answer = document.getElementById('q6').value.trim().toLowerCase();
            const feedback = document.getElementById('feedback6');

            if (answer === 'i have known her for years' || answer === 'i have known her for years.') {
                feedback.className = 'feedback correct';
                feedback.textContent = '✓ Great! Don\'t use continuous with stative verbs: I have known';
                setTimeout(() => { changeSlide(1); }, 1500);
            } else {
                feedback.className = 'feedback incorrect';
                feedback.textContent = '✗ Use Present Perfect Simple (not continuous) with "know": I have known her for years';
            }
        }

        function checkAnswer7() {
            const answer = document.getElementById('q7').value.trim().toLowerCase();
            const feedback = document.getElementById('feedback7');

            if (answer === 'running') {
                feedback.className = 'feedback correct';
                feedback.textContent = '✓ Perfect! "running" - Double the n before adding -ing.';
                setTimeout(() => { changeSlide(1); }, 1500);
            } else {
                feedback.className = 'feedback incorrect';
                feedback.textContent = '✗ Double the consonant: run → running';
            }
        }

        function checkAnswer8() {
            const answer = document.getElementById('q8').value.trim().toLowerCase();
            const feedback = document.getElementById('feedback8');

            if (answer === 'since') {
                feedback.className = 'feedback correct';
                feedback.textContent = '✓ Excellent! "since 2 o\'clock" - Use SINCE with a starting point.';
                setTimeout(() => { changeSlide(1); }, 1500);
            } else {
                feedback.className = 'feedback incorrect';
                feedback.textContent = '✗ Use SINCE with a specific time: since 2 o\'clock';
            }
        }

        async function checkGrammar() {
            const text = document.getElementById('writing1').value;
            const feedbackDiv = document.getElementById('grammar-feedback');
            const textarea = document.getElementById('writing1');

            if (!text.trim()) {
                feedbackDiv.style.display = 'block';
                feedbackDiv.style.background = 'rgba(245, 101, 101, 0.1)';
                feedbackDiv.style.border = '1px solid rgba(245, 101, 101, 0.3)';
                feedbackDiv.style.color = '#c53030';
                feedbackDiv.innerHTML = '✗ Please write some sentences first!';
                return;
            }

            textarea.style.display = 'none';
            window.grammarCheckResult = { original: text, corrected: '' };

            feedbackDiv.style.display = 'block';
            feedbackDiv.style.background = 'rgba(102, 126, 234, 0.1)';
            feedbackDiv.style.border = '1px solid rgba(102, 126, 234, 0.3)';
            feedbackDiv.style.color = '#667eea';
            feedbackDiv.innerHTML = '⏳ Checking your grammar and spelling...';

            try {
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=AIzaSyBTH0NmDb3cqjrY6p7YROPIJel-iCxSxzs`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        contents: [{
                            parts: [{
                                text: `You are a strict grammar checker. Fix grammar and spelling errors. Do not change the meaning, style, or add punctuation unless absolutely necessary. Profanities are acceptable, but don't use shortened informal words like "cuz" or "wanna"\n\nText: "${text}"\n\nReturn only the corrected text with minimal changes.`
                            }]
                        }]
                    })
                });

                const data = await response.json();
                const correctedText = data.candidates?.[0]?.content?.parts?.[0]?.text?.trim() || text;

                if (correctedText !== text && correctedText.toLowerCase() !== text.toLowerCase()) {
                    const originalWords = text.split(/(\s+)/);
                    const correctedWords = correctedText.split(/(\s+)/);
                    let highlightedText = '';

                    originalWords.forEach((word, i) => {
                        if (word.match(/\s+/)) {
                            highlightedText += word;
                        } else if (correctedWords[i] && word.toLowerCase() !== correctedWords[i].toLowerCase()) {
                            highlightedText += `<span style="color: #e53e3e; font-weight: 600; background: rgba(245, 101, 101, 0.15); padding: 2px 4px; border-radius: 3px;">${word}</span>`;
                        } else {
                            highlightedText += word;
                        }
                    });

                    let html = `
                        <div style="margin-bottom: 20px;">
                            <strong style="color: #c53030;">Your Text (errors highlighted):</strong>
                            <div style="background: white; padding: 15px; border-radius: 8px; margin-top: 10px; border: 2px solid rgba(245, 101, 101, 0.3); line-height: 1.8;">
                                ${highlightedText}
                            </div>
                        </div>
                        <div>
                            <strong style="color: #2f855a;">Corrected Text:</strong>
                            <div style="background: rgba(72, 187, 120, 0.1); padding: 15px; border-radius: 8px; margin-top: 10px; border: 2px solid rgba(72, 187, 120, 0.3); color: #2d3748; line-height: 1.8;">
                                ${correctedText}
                            </div>
                        </div>
                    `;

                    feedbackDiv.style.background = 'rgba(245, 101, 101, 0.05)';
                    feedbackDiv.style.border = '1px solid rgba(245, 101, 101, 0.3)';
                    feedbackDiv.style.color = '#2d3748';
                    feedbackDiv.innerHTML = html;

                    window.grammarCheckResult.corrected = correctedText;
                    const sendBtn = document.getElementById('send-teacher-btn');
                    sendBtn.disabled = false;
                    sendBtn.style.opacity = '1';
                    sendBtn.style.cursor = 'pointer';
                } else {
                    feedbackDiv.style.background = 'rgba(72, 187, 120, 0.1)';
                    feedbackDiv.style.border = '1px solid rgba(72, 187, 120, 0.3)';
                    feedbackDiv.style.color = '#2f855a';
                    feedbackDiv.innerHTML = '✓ Perfect! No grammar or spelling errors detected!';

                    window.grammarCheckResult.corrected = text;
                    const sendBtn = document.getElementById('send-teacher-btn');
                    sendBtn.disabled = false;
                    sendBtn.style.opacity = '1';
                    sendBtn.style.cursor = 'pointer';
                }
            } catch (error) {
                feedbackDiv.style.background = 'rgba(245, 101, 101, 0.1)';
                feedbackDiv.style.border = '1px solid rgba(245, 101, 101, 0.3)';
                feedbackDiv.style.color = '#c53030';
                feedbackDiv.innerHTML = '✗ Unable to check grammar. Error: ' + error.message;
            }
        }

        function sendToTeacher() {
            const essayTitle = "B1-42: Present Perfect Continuous - Duration, Recent Actions";
            const originalText = window.grammarCheckResult.original;
            const correctedText = window.grammarCheckResult.corrected;

            const emailBody = `Essay Title: ${essayTitle}\n\nOriginal Essay:\n${originalText}\n\nWe made some changes:\n\nCorrected Text:\n${correctedText}`;
            const mailtoLink = `mailto:?subject=${encodeURIComponent(essayTitle)}&body=${encodeURIComponent(emailBody)}`;
            window.location.href = mailtoLink;
        }
    </script>
</body>
</html>