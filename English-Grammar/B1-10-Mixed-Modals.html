<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>B1-50: Mixed Modals - Possibility, Obligation, Prohibition</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            height: 100vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 20px 40px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
        }

        .header-left {
            display: flex;
            flex-direction: column;
        }

        .header h1 {
            color: #2d3748;
            font-size: 2.5rem;
            font-weight: 700;
            margin: 0;
            letter-spacing: -0.5px;
        }

        .header .website {
            text-align: center;
            margin-top: 8px;
        }

        .header .website a {
            color: #4c51bf;
            text-decoration: none;
            font-size: 1.2rem;
            font-weight: 500;
            transition: color 0.3s ease;
        }

        .header .website a:hover {
            color: #553c9a;
        }

        .header-image {
            width: 120px;
            height: 80px;
            border-radius: 12px;
            object-fit: cover;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.15);
        }

        .container {
            display: flex;
            height: calc(100vh - 120px);
        }

        .navigation {
            width: 280px;
            background: rgba(45, 55, 72, 0.95);
            backdrop-filter: blur(10px);
            padding: 30px 20px;
            border-right: 1px solid rgba(255, 255, 255, 0.1);
        }

        .nav-item {
            padding: 16px 24px;
            margin: 8px 0;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            color: #e2e8f0;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            text-align: center;
            font-weight: 500;
            font-size: 1.1rem;
            backdrop-filter: blur(5px);
        }

        .nav-item:hover {
            background: rgba(255, 255, 255, 0.2);
            color: #ffffff;
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
        }

        .nav-item.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #ffffff;
            border-color: transparent;
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
        }

        .content {
            flex: 1;
            display: flex;
            flex-direction: column;
            height: 100%;
            overflow: hidden;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
        }

        .section {
            display: none;
            flex: 1;
            padding: 0;
            overflow: hidden;
            height: 100%;
            background: white;
        }

        .section.active {
            display: flex;
            flex-direction: column;
        }

        .slideshow-container {
            position: relative;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background: white;
            padding: 30px 80px;
        }

        .slide-content-wrapper {
            position: relative;
            width: 100%;
            max-width: 1400px;
            height: 85%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .slide {
            display: none;
            width: 100%;
            height: 100%;
            background: white;
            border-radius: 20px;
            padding: 25px 35px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .slide.active {
            display: flex;
            flex-direction: column;
            animation: slideIn 0.5s ease-in-out;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(30px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .slide-arrow {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: #8B7EC8;
            color: white;
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            z-index: 10;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }

        .slide-arrow:hover {
            background: #7366B0;
            transform: translateY(-50%) scale(1.1);
        }

        .slide-arrow.prev {
            left: -70px;
        }

        .slide-arrow.next {
            right: -70px;
        }

        .slide-indicators {
            position: absolute;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 12px;
            z-index: 10;
        }

        .indicator-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #D1D5DB;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .indicator-dot.active {
            background: #667eea;
            transform: scale(1.3);
        }

        .indicator-dot:hover {
            background: #9CA3AF;
        }

        .slide h2 {
            color: #2d3748;
            margin-bottom: 15px;
            font-size: 2rem;
            font-weight: 700;
            text-align: center;
            letter-spacing: -0.5px;
        }

        .explanation-box {
            background: transparent;
            border: none;
            border-radius: 0;
            padding: 0;
            margin-bottom: 0;
            backdrop-filter: none;
            box-shadow: none;
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow-y: auto;
            overflow-x: hidden;
        }

        .explanation-box h3 {
            color: #667eea;
            font-size: 1.3rem;
            margin-bottom: 10px;
            font-weight: 600;
        }

        .explanation-box p {
            color: #2d3748;
            line-height: 1.5;
            font-size: 1rem;
            margin-bottom: 8px;
        }

        .rule-box {
            background: #e3f2fd;
            padding: 15px 20px;
            border-radius: 10px;
            margin: 10px 0;
            border-left: 4px solid #667eea;
        }

        .rule-box h4 {
            color: #667eea;
            font-size: 1.2rem;
            margin-bottom: 8px;
            font-weight: 600;
        }

        .rule-box p {
            font-size: 1rem;
            color: #2d3748;
            margin: 5px 0;
        }

        .yes-no {
            display: inline-block;
            padding: 6px 12px;
            margin: 3px;
            border-radius: 6px;
            font-weight: 600;
            font-size: 1rem;
            background: #4299e1;
            color: white;
        }

        .auxiliary {
            display: inline-block;
            padding: 6px 12px;
            margin: 3px;
            border-radius: 6px;
            font-weight: 600;
            font-size: 1rem;
            background: #48bb78;
            color: white;
        }

        .subject {
            display: inline-block;
            padding: 6px 12px;
            margin: 3px;
            border-radius: 6px;
            font-weight: 600;
            font-size: 1rem;
            background: #9f7aea;
            color: white;
        }

        .verb {
            display: inline-block;
            padding: 6px 12px;
            margin: 3px;
            border-radius: 6px;
            font-weight: 600;
            font-size: 1rem;
            background: #ed64a6;
            color: white;
        }

        .example-box {
            background: #f7fafc;
            border-left: 4px solid #667eea;
            padding: 12px;
            border-radius: 8px;
            margin: 8px 0;
        }

        .example-box p {
            margin: 5px 0;
            font-size: 1rem;
            color: #2d3748;
        }

        .note-box {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 12px;
            margin: 10px 0;
            border-radius: 8px;
        }

        .note-box strong {
            color: #856404;
            font-size: 1rem;
        }

        .note-box p {
            color: #856404;
            margin-top: 5px;
            line-height: 1.4;
            font-size: 0.95rem;
        }

        .exercise-container {
            background: transparent;
            border: none;
            border-radius: 0;
            padding: 0;
            margin-bottom: 10px;
            backdrop-filter: none;
            box-shadow: none;
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .exercise-container h3 {
            color: #764ba2;
            font-size: 1.4rem;
            margin-bottom: 15px;
            font-weight: 600;
        }

        .question-box {
            background: #e3f2fd;
            padding: 20px;
            border-radius: 12px;
            margin: 0;
        }

        .question-box p {
            font-weight: 600;
            color: #2d3748;
            margin-bottom: 12px;
            font-size: 1.1rem;
        }

        input[type="text"] {
            width: 100%;
            padding: 12px 18px;
            margin: 8px 0;
            border: 2px solid rgba(102, 126, 234, 0.3);
            border-radius: 8px;
            font-size: 1.05rem;
            font-family: 'Inter', sans-serif;
            background: rgba(255, 255, 255, 0.8);
            transition: all 0.3s ease;
        }

        input[type="text"]:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 20px rgba(102, 126, 234, 0.2);
        }

        .check-button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #ffffff;
            border: none;
            padding: 12px 30px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1.1rem;
            font-weight: 600;
            margin: 15px 5px 10px 5px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }

        .check-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
        }

        .feedback {
            padding: 15px 20px;
            border-radius: 12px;
            margin: 15px 0;
            font-weight: 500;
            font-size: 1.05rem;
            display: none;
        }

        .feedback.correct {
            background: rgba(72, 187, 120, 0.1);
            color: #2f855a;
            border: 1px solid rgba(72, 187, 120, 0.3);
            display: block;
        }

        .feedback.incorrect {
            background: rgba(245, 101, 101, 0.1);
            color: #c53030;
            border: 1px solid rgba(245, 101, 101, 0.3);
            display: block;
        }

        ul {
            margin-left: 25px;
            line-height: 1.6;
        }

        li {
            margin: 6px 0;
            font-size: 1.05rem;
            color: #2d3748;
        }

        li strong {
            color: #667eea;
        }

        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin: 12px 0;
        }

        .comparison-table th {
            background: #667eea;
            color: white;
            padding: 10px;
            font-size: 1.05rem;
            font-weight: 600;
        }

        .comparison-table td {
            padding: 10px;
            border: 1px solid #e2e8f0;
            font-size: 1rem;
            text-align: center;
        }

        .comparison-table tr:nth-child(even) {
            background: #f7fafc;
        }

        .explanation-box::-webkit-scrollbar {
            width: 8px;
        }

        .explanation-box::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }

        .explanation-box::-webkit-scrollbar-thumb {
            background: #667eea;
            border-radius: 10px;
        }

        .explanation-box::-webkit-scrollbar-thumb:hover {
            background: #5568d3;
        }

        .formula-box {
            background: #e6fffa;
            border: 2px solid #319795;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            text-align: center;
            font-size: 1.3rem;
        }

        .grid-examples {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .grid-card {
            background: white;
            padding: 15px;
            border-radius: 10px;
            border: 2px solid #e2e8f0;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .grid-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .reading-text {
            background: #f7fafc;
            padding: 20px;
            border-radius: 10px;
            line-height: 1.9;
            margin: 15px 0;
            border: 2px solid #e2e8f0;
        }

        .reading-text p {
            margin: 12px 0;
        }

        .highlight-question {
            background: #bee3f8;
            padding: 2px 6px;
            border-radius: 4px;
            font-weight: bold;
        }

        .highlight-answer {
            background: #c6f6d5;
            padding: 2px 6px;
            border-radius: 4px;
            font-weight: bold;
        }

        .example-sentence {
            font-size: 1.1rem;
            margin: 10px 0;
            padding: 10px;
            background: white;
            border-radius: 8px;
            border-left: 3px solid #667eea;
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="header-left">
            <h1>B1-50: Mixed Modals - Possibility, Obligation, Prohibition</h1>
            <div class="website">
                <a href="https://www.mimlanguageservices.com/" target="_blank">mimlanguageservices</a>
            </div>
        </div>
        <a href="https://www.mimlanguageservices.com/" target="_blank">
            <img src="https://static.wixstatic.com/media/593d03_8958d96b0f6d4d1ea9dffa7f89bffe8b~mv2.png" alt="ESL Logo" class="header-image">
        </a>
    </div>

    <div class="container">
        <div class="navigation">
            <div class="nav-item active" onclick="showSection('explanation', this)">Explanation</div>
            <div class="nav-item" onclick="showSection('examples', this)">Examples</div>
            <div class="nav-item" onclick="showSection('reading', this)">Reading</div>
            <div class="nav-item" onclick="showSection('media', this)">Media</div>
            <div class="nav-item" onclick="showSection('practice', this)">Practice</div>
            <div class="nav-item" onclick="showSection('writing', this)">Writing</div>
        </div>

        <div class="content">
            <!-- Explanation Section -->
            <div class="section active" id="explanation">
                <div class="slideshow-container">
                    <div class="slide-content-wrapper">
                        <button class="slide-arrow prev" onclick="changeSlide(-1)">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                                <polyline points="15 18 9 12 15 6"></polyline>
                            </svg>
                        </button>
                        <button class="slide-arrow next" onclick="changeSlide(1)">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                                <polyline points="9 18 15 12 9 6"></polyline>
                            </svg>
                        </button>

                        <div class="slide active" data-section="explanation">
                            <h2>Welcome to Mixed Modals!</h2>
                            <div class="explanation-box">
                                <p style="font-size: 1.2rem; text-align: center; margin: 20px 0;">
                                    Today we will learn <span class="yes-no">MODAL VERBS</span> in English!
                                </p>
                                <p style="font-size: 1.1rem; text-align: center;">
                                    Modal verbs express POSSIBILITY, OBLIGATION, PROHIBITION, PERMISSION, and ABILITY.
                                </p>
                                <div class="formula-box">
                                    <span class="subject">SUBJECT</span> + <span class="auxiliary">MODAL</span> + <span class="verb">BASE VERB</span>
                                </div>
                                <p style="text-align: center; font-size: 1.1rem;">
                                    Example: You <strong>must</strong> wear a seatbelt. / I <strong>can</strong> speak English. / You <strong>mustn't</strong> smoke here.
                                </p>
                            </div>
                        </div>

                        <div class="slide" data-section="explanation">
                            <h2>Modals of Possibility</h2>
                            <div class="explanation-box">
                                <h3>Can, Could, May, Might - Expressing possibility</h3>

                                <table class="comparison-table">
                                    <tr>
                                        <th>Modal</th>
                                        <th>Use</th>
                                        <th>Example</th>
                                    </tr>
                                    <tr>
                                        <td>CAN</td>
                                        <td>Ability / General possibility</td>
                                        <td>I can swim. / It can be cold in winter.</td>
                                    </tr>
                                    <tr>
                                        <td>COULD</td>
                                        <td>Past ability / Polite possibility</td>
                                        <td>I could swim when I was 5. / It could rain.</td>
                                    </tr>
                                    <tr>
                                        <td>MAY</td>
                                        <td>Formal possibility / Permission</td>
                                        <td>It may rain tomorrow. / You may leave now.</td>
                                    </tr>
                                    <tr>
                                        <td>MIGHT</td>
                                        <td>Weaker possibility</td>
                                        <td>I might go to the party (not sure).</td>
                                    </tr>
                                </table>

                                <div class="rule-box">
                                    <h4>Remember:</h4>
                                    <p>• CAN = I am able to do this</p>
                                    <p>• COULD = Past ability or polite suggestion</p>
                                    <p>• MAY/MIGHT = Something is possible (might is less certain)</p>
                                </div>
                            </div>
                        </div>

                        <div class="slide" data-section="explanation">
                            <h2>Modals of Obligation</h2>
                            <div class="explanation-box">
                                <h3>Must, Have to, Should - Expressing necessity</h3>

                                <table class="comparison-table">
                                    <tr>
                                        <th>Modal</th>
                                        <th>Strength</th>
                                        <th>Example</th>
                                    </tr>
                                    <tr>
                                        <td>MUST</td>
                                        <td>Strong obligation (personal/legal)</td>
                                        <td>You must wear a seatbelt. (It's the law!)</td>
                                    </tr>
                                    <tr>
                                        <td>HAVE TO</td>
                                        <td>External obligation / necessity</td>
                                        <td>I have to go to work. (My job requires it)</td>
                                    </tr>
                                    <tr>
                                        <td>SHOULD</td>
                                        <td>Advice / recommendation</td>
                                        <td>You should exercise. (It's good for you)</td>
                                    </tr>
                                    <tr>
                                        <td>OUGHT TO</td>
                                        <td>Advice (formal)</td>
                                        <td>You ought to see a doctor.</td>
                                    </tr>
                                </table>

                                <div class="rule-box">
                                    <h4>Key Differences:</h4>
                                    <p>• MUST = Strong personal feeling or law</p>
                                    <p>• HAVE TO = External rule or requirement</p>
                                    <p>• SHOULD = Advice, not obligation</p>
                                </div>
                            </div>
                        </div>

                        <div class="slide" data-section="explanation">
                            <h2>Modals of Prohibition</h2>
                            <div class="explanation-box">
                                <h3>Mustn't, Can't, Shouldn't - Saying "Don't do this!"</h3>

                                <table class="comparison-table">
                                    <tr>
                                        <th>Modal</th>
                                        <th>Meaning</th>
                                        <th>Example</th>
                                    </tr>
                                    <tr>
                                        <td>MUSTN'T</td>
                                        <td>Strong prohibition (forbidden!)</td>
                                        <td>You mustn't smoke here. (It's not allowed!)</td>
                                    </tr>
                                    <tr>
                                        <td>CAN'T</td>
                                        <td>Not allowed / Not possible</td>
                                        <td>You can't park here. (It's forbidden)</td>
                                    </tr>
                                    <tr>
                                        <td>SHOULDN'T</td>
                                        <td>Advice against doing something</td>
                                        <td>You shouldn't eat too much sugar.</td>
                                    </tr>
                                </table>

                                <div class="note-box">
                                    <strong>Important:</strong>
                                    <p>DON'T HAVE TO ≠ MUSTN'T</p>
                                    <p>• "You don't have to go" = It's not necessary (but you can if you want)</p>
                                    <p>• "You mustn't go" = It's forbidden! (Don't do it!)</p>
                                </div>

                                <div class="rule-box">
                                    <h4>Remember:</h4>
                                    <p>• MUSTN'T = It's forbidden (strong prohibition)</p>
                                    <p>• CAN'T = Not allowed or not possible</p>
                                    <p>• SHOULDN'T = It's not a good idea</p>
                                </div>
                            </div>
                        </div>

                        <div class="slide" data-section="explanation">
                            <h2>Modals of Permission</h2>
                            <div class="explanation-box">
                                <h3>Can, May, Could - Asking and giving permission</h3>

                                <table class="comparison-table">
                                    <tr>
                                        <th>Modal</th>
                                        <th>Formality</th>
                                        <th>Example</th>
                                    </tr>
                                    <tr>
                                        <td>CAN</td>
                                        <td>Informal permission</td>
                                        <td>Can I use your phone? / You can leave now.</td>
                                    </tr>
                                    <tr>
                                        <td>COULD</td>
                                        <td>Polite request</td>
                                        <td>Could I ask you a question?</td>
                                    </tr>
                                    <tr>
                                        <td>MAY</td>
                                        <td>Formal permission</td>
                                        <td>May I come in? / You may begin.</td>
                                    </tr>
                                </table>

                                <div class="rule-box">
                                    <h4>Politeness Scale:</h4>
                                    <p>• CAN I...? = Casual, informal</p>
                                    <p>• COULD I...? = Polite</p>
                                    <p>• MAY I...? = Very polite, formal</p>
                                </div>
                            </div>
                        </div>

                        <div class="slide" data-section="explanation">
                            <h2>Common Mistakes with Modals</h2>
                            <div class="explanation-box">
                                <h3>Mistake 1: Adding "to" after modals</h3>
                                <div class="example-box">
                                    <p>❌ I must <del>to</del> go. → ✅ I <strong>must go</strong>.</p>
                                    <p>❌ She can <del>to</del> speak Spanish. → ✅ She <strong>can speak</strong> Spanish.</p>
                                    <p><strong>Note:</strong> Modals are followed by BASE VERB (no "to")</p>
                                </div>

                                <h3>Mistake 2: Adding -s to modals</h3>
                                <div class="example-box">
                                    <p>❌ He <del>cans</del> swim. → ✅ He <strong>can</strong> swim.</p>
                                    <p>❌ She <del>musts</del> study. → ✅ She <strong>must</strong> study.</p>
                                    <p><strong>Note:</strong> Modals NEVER change form (no -s, -ed, -ing)</p>
                                </div>

                                <h3>Mistake 3: Confusing mustn't and don't have to</h3>
                                <div class="example-box">
                                    <p>❌ You <del>mustn't</del> come if you're busy. → ✅ You <strong>don't have to</strong> come.</p>
                                    <p><strong>Note:</strong> Mustn't = forbidden / Don't have to = not necessary</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="slide-indicators" id="explanation-indicators">
                        <span class="indicator-dot active" onclick="goToSlide(1)"></span>
                        <span class="indicator-dot" onclick="goToSlide(2)"></span>
                        <span class="indicator-dot" onclick="goToSlide(3)"></span>
                        <span class="indicator-dot" onclick="goToSlide(4)"></span>
                        <span class="indicator-dot" onclick="goToSlide(5)"></span>
                        <span class="indicator-dot" onclick="goToSlide(6)"></span>
                    </div>
                </div>
            </div>

            <!-- Examples Section -->
            <div class="section" id="examples">
                <div class="slideshow-container">
                    <div class="slide-content-wrapper">
                        <button class="slide-arrow prev" onclick="changeSlide(-1)">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                                <polyline points="15 18 9 12 15 6"></polyline>
                            </svg>
                        </button>
                        <button class="slide-arrow next" onclick="changeSlide(1)">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                                <polyline points="9 18 15 12 9 6"></polyline>
                            </svg>
                        </button>

                        <div class="slide active" data-section="examples">
                            <h2>Detailed Examples: Different Modals</h2>
                            <div class="explanation-box">
                                <div class="grid-examples">
                                    <div class="grid-card">
                                        <strong>Possibility:</strong><br><br>
                                        • I <strong>can</strong> speak three languages.<br>
                                        • It <strong>might</strong> rain tomorrow.<br>
                                    </div>
                                    <div class="grid-card">
                                        <strong>Obligation:</strong><br><br>
                                        • You <strong>must</strong> wear a uniform.<br>
                                        • I <strong>have to</strong> finish this today.<br>
                                    </div>
                                    <div class="grid-card">
                                        <strong>Prohibition:</strong><br><br>
                                        • You <strong>mustn't</strong> smoke here.<br>
                                        • You <strong>can't</strong> use phones in class.<br>
                                    </div>
                                    <div class="grid-card">
                                        <strong>Advice:</strong><br><br>
                                        • You <strong>should</strong> see a doctor.<br>
                                        • You <strong>ought to</strong> apologize.<br>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="slide" data-section="examples">
                            <h2>Modal Strength Comparison</h2>
                            <div class="explanation-box">
                                <h3>From strongest to weakest:</h3>

                                <table class="comparison-table">
                                    <tr>
                                        <th>Category</th>
                                        <th>Strongest → Weakest</th>
                                    </tr>
                                    <tr>
                                        <td><strong>Obligation</strong></td>
                                        <td>MUST > HAVE TO > SHOULD > OUGHT TO</td>
                                    </tr>
                                    <tr>
                                        <td><strong>Prohibition</strong></td>
                                        <td>MUSTN'T > CAN'T > SHOULDN'T</td>
                                    </tr>
                                    <tr>
                                        <td><strong>Possibility</strong></td>
                                        <td>CAN > COULD > MAY > MIGHT</td>
                                    </tr>
                                </table>

                                <div class="example-box">
                                    <p><strong>Obligation examples:</strong></p>
                                    <p>• You <strong>must</strong> stop at red lights. (Law - very strong!)</p>
                                    <p>• You <strong>have to</strong> arrive on time. (Rule)</p>
                                    <p>• You <strong>should</strong> eat healthy food. (Advice)</p>
                                </div>
                            </div>
                        </div>

                        <div class="slide" data-section="examples">
                            <h2>Real-Life Situations</h2>
                            <div class="explanation-box">
                                <h3>Using modals in context</h3>
                                <div class="example-box">
                                    <p><strong>At School:</strong></p>
                                    <p>• You <strong>must</strong> attend all classes. (Rule)</p>
                                    <p>• You <strong>mustn't</strong> cheat on exams. (Forbidden)</p>
                                    <p>• You <strong>should</strong> study every day. (Advice)</p>
                                    <p>• You <strong>can</strong> use the library. (Permission)</p>
                                </div>

                                <div class="example-box">
                                    <p><strong>At Work:</strong></p>
                                    <p>• You <strong>have to</strong> be on time. (Requirement)</p>
                                    <p>• You <strong>can't</strong> use your phone during meetings. (Not allowed)</p>
                                    <p>• You <strong>should</strong> dress professionally. (Recommendation)</p>
                                    <p>• You <strong>may</strong> take a break. (Permission)</p>
                                </div>

                                <div class="example-box">
                                    <p><strong>Driving:</strong></p>
                                    <p>• You <strong>must</strong> have a license. (Legal requirement)</p>
                                    <p>• You <strong>mustn't</strong> drive drunk. (Strictly forbidden)</p>
                                    <p>• You <strong>should</strong> check your mirrors. (Good practice)</p>
                                    <p>• You <strong>can</strong> park here. (It's allowed)</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="slide-indicators" id="examples-indicators">
                        <span class="indicator-dot active" onclick="goToSlide(1)"></span>
                        <span class="indicator-dot" onclick="goToSlide(2)"></span>
                        <span class="indicator-dot" onclick="goToSlide(3)"></span>
                    </div>
                </div>
            </div>

            <!-- Reading Section -->
            <div class="section" id="reading">
                <div class="slideshow-container">
                    <div class="slide-content-wrapper">
                        <button class="slide-arrow prev" onclick="changeSlide(-1)">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                                <polyline points="15 18 9 12 15 6"></polyline>
                            </svg>
                        </button>
                        <button class="slide-arrow next" onclick="changeSlide(1)">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                                <polyline points="9 18 15 12 9 6"></polyline>
                            </svg>
                        </button>

                        <div class="slide active" data-section="reading">
                            <h2>Reading: Office Rules and Guidelines</h2>
                            <div class="explanation-box">
                                <div class="reading-text">
                                    <p><strong>Employee Handbook - Rules and Recommendations</strong></p>

                                    <p>Welcome to our company! Here are the important rules and guidelines you need to follow:</p>

                                    <p><strong>Mandatory Requirements:</strong></p>
                                    <p>All employees <span class="highlight-question">must</span> <span class="highlight-answer">arrive</span> on time for their shifts. You <span class="highlight-question">have to</span> <span class="highlight-answer">sign in</span> at the front desk when you arrive. You <span class="highlight-question">must</span> <span class="highlight-answer">wear</span> your employee badge at all times while on company property.</p>

                                    <p><strong>Strict Prohibitions:</strong></p>
                                    <p>You <span class="highlight-question">mustn't</span> <span class="highlight-answer">share</span> your password with anyone. You <span class="highlight-question">can't</span> <span class="highlight-answer">use</span> your phone during important meetings. Employees <span class="highlight-question">mustn't</span> <span class="highlight-answer">smoke</span> inside the building - smoking is only allowed in designated outdoor areas.</p>

                                    <p><strong>Recommendations and Advice:</strong></p>
                                    <p>You <span class="highlight-question">should</span> <span class="highlight-answer">check</span> your email at least twice a day. Employees <span class="highlight-question">should</span> <span class="highlight-answer">dress</span> professionally for client meetings. You <span class="highlight-question">ought to</span> <span class="highlight-answer">complete</span> your training modules within the first month.</p>

                                    <p><strong>Permissions and Abilities:</strong></p>
                                    <p>You <span class="highlight-question">can</span> <span class="highlight-answer">use</span> the kitchen facilities anytime. Employees <span class="highlight-question">may</span> <span class="highlight-answer">leave</span> early on Fridays if all work is finished. You <span class="highlight-question">can</span> <span class="highlight-answer">take</span> a 15-minute break every four hours.</p>

                                    <p><strong>Optional Situations:</strong></p>
                                    <p>Remember: You <span class="highlight-question">don't have to</span> <span class="highlight-answer">work</span> on public holidays (it's optional, not required). You <span class="highlight-question">don't have to</span> <span class="highlight-answer">attend</span> the Friday social events, but they're a great way to meet colleagues!</p>

                                    <p><strong>Uncertain Possibilities:</strong></p>
                                    <p>We <span class="highlight-question">might</span> <span class="highlight-answer">introduce</span> flexible working hours next year. The company <span class="highlight-question">could</span> <span class="highlight-answer">offer</span> additional benefits in the future.</p>
                                </div>
                            </div>
                        </div>

                        <div class="slide" data-section="reading">
                            <h2>Reading Analysis</h2>
                            <div class="explanation-box">
                                <h3>Notice the Different Modals:</h3>
                                <div class="example-box">
                                    <p>• <strong>MUST/HAVE TO</strong> - Strong obligations and requirements</p>
                                    <p>• <strong>MUSTN'T/CAN'T</strong> - Prohibitions and things not allowed</p>
                                    <p>• <strong>SHOULD/OUGHT TO</strong> - Recommendations and advice</p>
                                    <p>• <strong>CAN/MAY</strong> - Permissions and abilities</p>
                                    <p>• <strong>DON'T HAVE TO</strong> - Things that are optional</p>
                                    <p>• <strong>MIGHT/COULD</strong> - Uncertain possibilities</p>
                                </div>

                                <h3>Key Differences:</h3>
                                <div class="example-box">
                                    <p>• "You <strong>mustn't</strong> smoke inside" - Forbidden!</p>
                                    <p>• "You <strong>don't have to</strong> work on holidays" - Optional, your choice</p>
                                    <p>• "You <strong>should</strong> check email" - Good advice, not a rule</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="slide-indicators" id="reading-indicators">
                        <span class="indicator-dot active" onclick="goToSlide(1)"></span>
                        <span class="indicator-dot" onclick="goToSlide(2)"></span>
                    </div>
                </div>
            </div>

            <!-- Media Section -->
            <div class="section" id="media">
                <div class="slideshow-container">
                    <div class="slide-content-wrapper">
                        <button class="slide-arrow prev" onclick="changeSlide(-1)">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                                <polyline points="15 18 9 12 15 6"></polyline>
                            </svg>
                        </button>
                        <button class="slide-arrow next" onclick="changeSlide(1)">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                                <polyline points="9 18 15 12 9 6"></polyline>
                            </svg>
                        </button>

                        <div class="slide active" data-section="media">
                            <h2>Video: Modal Verbs Explained</h2>
                            <div class="explanation-box">
                                <p style="font-size: 1.1rem; margin-bottom: 20px;">Watch this video about Modal Verbs:</p>
                                <div style="text-align: center; margin: 30px 0;">
                                    <iframe width="800" height="450"
                                        src="https://www.youtube.com/embed/jrGfQeah-ss"
                                        style="border-radius: 15px; box-shadow: 0 8px 30px rgba(0,0,0,0.2);"
                                        frameborder="0"
                                        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                                        allowfullscreen>
                                    </iframe>
                                </div>
                                <p style="font-size: 1rem; color: #666; text-align: center; font-style: italic;">
                                    Learn about different modal verbs and their uses
                                </p>
                            </div>
                        </div>

                        <div class="slide" data-section="media">
                            <h2>Video: Modal Verbs Practice</h2>
                            <div class="explanation-box">
                                <p style="font-size: 1.1rem; margin-bottom: 20px;">Modal verbs with exercises:</p>
                                <div style="text-align: center; margin: 30px 0;">
                                    <iframe width="800" height="450"
                                        src="https://www.youtube.com/embed/Nqq2hcJUV3k"
                                        style="border-radius: 15px; box-shadow: 0 8px 30px rgba(0,0,0,0.2);"
                                        frameborder="0"
                                        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                                        allowfullscreen>
                                    </iframe>
                                </div>
                                <p style="font-size: 1rem; color: #666; text-align: center; font-style: italic;">
                                    Understanding when to use different modals
                                </p>
                            </div>
                        </div>
                    </div>
                    <div class="slide-indicators" id="media-indicators">
                        <span class="indicator-dot active" onclick="goToSlide(1)"></span>
                        <span class="indicator-dot" onclick="goToSlide(2)"></span>
                    </div>
                </div>
            </div>

            <!-- Practice Section -->
            <div class="section" id="practice">
                <div class="slideshow-container">
                    <div class="slide-content-wrapper">
                        <button class="slide-arrow prev" onclick="changeSlide(-1)">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                                <polyline points="15 18 9 12 15 6"></polyline>
                            </svg>
                        </button>
                        <button class="slide-arrow next" onclick="changeSlide(1)">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                                <polyline points="9 18 15 12 9 6"></polyline>
                            </svg>
                        </button>

                        <div class="slide active" data-section="practice">
                            <h2>Practice 1: Strong obligation</h2>
                            <div class="exercise-container">
                                <div class="question-box">
                                    <p>"You ___ wear a seatbelt. It's the law!" (must / should)</p>
                                    <input type="text" id="q1" placeholder="Type: must" onkeypress="if(event.key==='Enter') checkAnswer1()">
                                    <button class="check-button" onclick="checkAnswer1()">Check Answer</button>
                                    <div id="feedback1" class="feedback"></div>
                                </div>
                            </div>
                        </div>

                        <div class="slide" data-section="practice">
                            <h2>Practice 2: Prohibition</h2>
                            <div class="exercise-container">
                                <div class="question-box">
                                    <p>"You ___ smoke here. It's forbidden!" (mustn't / don't have to)</p>
                                    <input type="text" id="q2" placeholder="Type: mustn't" onkeypress="if(event.key==='Enter') checkAnswer2()">
                                    <button class="check-button" onclick="checkAnswer2()">Check Answer</button>
                                    <div id="feedback2" class="feedback"></div>
                                </div>
                            </div>
                        </div>

                        <div class="slide" data-section="practice">
                            <h2>Practice 3: Advice</h2>
                            <div class="exercise-container">
                                <div class="question-box">
                                    <p>"You ___ see a doctor if you feel sick." (should / must)</p>
                                    <input type="text" id="q3" placeholder="Type: should" onkeypress="if(event.key==='Enter') checkAnswer3()">
                                    <button class="check-button" onclick="checkAnswer3()">Check Answer</button>
                                    <div id="feedback3" class="feedback"></div>
                                </div>
                            </div>
                        </div>

                        <div class="slide" data-section="practice">
                            <h2>Practice 4: No obligation</h2>
                            <div class="exercise-container">
                                <div class="question-box">
                                    <p>"You ___ ___ ___ come if you're busy. It's optional." (don't have to)</p>
                                    <input type="text" id="q4" placeholder="Type: don't have to" onkeypress="if(event.key==='Enter') checkAnswer4()">
                                    <button class="check-button" onclick="checkAnswer4()">Check Answer</button>
                                    <div id="feedback4" class="feedback"></div>
                                </div>
                            </div>
                        </div>

                        <div class="slide" data-section="practice">
                            <h2>Practice 5: Ability</h2>
                            <div class="exercise-container">
                                <div class="question-box">
                                    <p>"I ___ speak three languages." (can / must)</p>
                                    <input type="text" id="q5" placeholder="Type: can" onkeypress="if(event.key==='Enter') checkAnswer5()">
                                    <button class="check-button" onclick="checkAnswer5()">Check Answer</button>
                                    <div id="feedback5" class="feedback"></div>
                                </div>
                            </div>
                        </div>

                        <div class="slide" data-section="practice">
                            <h2>Practice 6: Permission</h2>
                            <div class="exercise-container">
                                <div class="question-box">
                                    <p>"___ I use your phone?" (Polite request - Can/Could/May)</p>
                                    <input type="text" id="q6" placeholder="Type: Can / Could / May" onkeypress="if(event.key==='Enter') checkAnswer6()">
                                    <button class="check-button" onclick="checkAnswer6()">Check Answer</button>
                                    <div id="feedback6" class="feedback"></div>
                                </div>
                            </div>
                        </div>

                        <div class="slide" data-section="practice">
                            <h2>Practice 7: Possibility</h2>
                            <div class="exercise-container">
                                <div class="question-box">
                                    <p>"It ___ rain tomorrow. I'm not sure." (might / must)</p>
                                    <input type="text" id="q7" placeholder="Type: might" onkeypress="if(event.key==='Enter') checkAnswer7()">
                                    <button class="check-button" onclick="checkAnswer7()">Check Answer</button>
                                    <div id="feedback7" class="feedback"></div>
                                </div>
                            </div>
                        </div>

                        <div class="slide" data-section="practice">
                            <h2>Practice 8: Fix the mistake</h2>
                            <div class="exercise-container">
                                <div class="question-box">
                                    <p>Fix: "She cans speak English." → "___"</p>
                                    <input type="text" id="q8" placeholder="Type the correct sentence" onkeypress="if(event.key==='Enter') checkAnswer8()">
                                    <button class="check-button" onclick="checkAnswer8()">Check Answer</button>
                                    <div id="feedback8" class="feedback"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="slide-indicators" id="practice-indicators">
                        <span class="indicator-dot active" onclick="goToSlide(1)"></span>
                        <span class="indicator-dot" onclick="goToSlide(2)"></span>
                        <span class="indicator-dot" onclick="goToSlide(3)"></span>
                        <span class="indicator-dot" onclick="goToSlide(4)"></span>
                        <span class="indicator-dot" onclick="goToSlide(5)"></span>
                        <span class="indicator-dot" onclick="goToSlide(6)"></span>
                        <span class="indicator-dot" onclick="goToSlide(7)"></span>
                        <span class="indicator-dot" onclick="goToSlide(8)"></span>
                    </div>
                </div>
            </div>

            <!-- Writing Section -->
            <div class="section" id="writing">
                <div class="slideshow-container">
                    <div class="slide-content-wrapper">
                        <button class="slide-arrow prev" onclick="changeSlide(-1)">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                                <polyline points="15 18 9 12 15 6"></polyline>
                            </svg>
                        </button>
                        <button class="slide-arrow next" onclick="changeSlide(1)">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                                <polyline points="9 18 15 12 9 6"></polyline>
                            </svg>
                        </button>

                        <div class="slide active" data-section="writing" style="overflow-y: auto;">
                            <h2>Writing Practice</h2>
                            <div class="explanation-box">
                                <h3>Write rules and advice for a situation</h3>
                                <p style="margin-bottom: 15px;">Use different modal verbs to give rules, advice, and describe what's allowed or forbidden.</p>
                                <div class="question-box">
                                    <textarea id="writing1" rows="8" style="width: 100%; padding: 12px; border: 2px solid rgba(102, 126, 234, 0.3); border-radius: 8px; font-size: 1.05rem; font-family: 'Inter', sans-serif; resize: vertical;" spellcheck="true" placeholder="At my school, students must wear uniforms. We can't use phones in class. We should study every day. We don't have to come on weekends..."></textarea>
                                    <div style="display: flex; gap: 10px; margin-top: 10px;">
                                        <button class="check-button" onclick="checkGrammar()">Check Grammar</button>
                                        <button id="send-teacher-btn" class="check-button" onclick="sendToTeacher()" style="background: linear-gradient(135deg, #48bb78 0%, #38a169 100%); opacity: 0.5; cursor: not-allowed;" disabled>Send to Teacher</button>
                                    </div>
                                    <div id="grammar-feedback" style="margin-top: 15px; padding: 15px; border-radius: 8px; display: none;"></div>
                                    <p style="font-size: 0.95rem; color: #666; margin-top: 10px;">Example topics: school rules, workplace guidelines, travel advice, health recommendations</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="slide-indicators" id="writing-indicators">
                        <span class="indicator-dot active" onclick="goToSlide(1)"></span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let currentSlide = 1;
        let currentSection = 'explanation';

        function showSection(sectionName, element) {
            const sections = document.querySelectorAll('.section');
            sections.forEach(section => section.classList.remove('active'));

            const navItems = document.querySelectorAll('.nav-item');
            navItems.forEach(item => item.classList.remove('active'));

            document.getElementById(sectionName).classList.add('active');

            if (element) {
                element.classList.add('active');
            }

            currentSection = sectionName;
            currentSlide = 1;

            setTimeout(() => {
                const activeSection = document.querySelector('.section.active');
                const inputField = activeSection.querySelector('input[type="text"]');
                if (inputField) {
                    inputField.focus();
                }
            }, 100);
        }

        function changeSlide(direction) {
            const activeSection = document.querySelector('.section.active');
            const slides = activeSection.querySelectorAll('.slide');
            const dots = activeSection.querySelectorAll('.indicator-dot');

            if (slides.length === 1) return;

            slides[currentSlide - 1].classList.remove('active');
            dots[currentSlide - 1].classList.remove('active');

            currentSlide += direction;

            if (currentSlide > slides.length) {
                currentSlide = 1;
            }
            if (currentSlide < 1) {
                currentSlide = slides.length;
            }

            slides[currentSlide - 1].classList.add('active');
            dots[currentSlide - 1].classList.add('active');

            setTimeout(() => {
                const activeSlide = slides[currentSlide - 1];
                const inputField = activeSlide.querySelector('input[type="text"]');
                if (inputField) {
                    inputField.focus();
                    inputField.value = '';
                }
            }, 100);
        }

        function goToSlide(slideNum) {
            const activeSection = document.querySelector('.section.active');
            const slides = activeSection.querySelectorAll('.slide');
            const dots = activeSection.querySelectorAll('.indicator-dot');

            slides[currentSlide - 1].classList.remove('active');
            dots[currentSlide - 1].classList.remove('active');

            currentSlide = slideNum;

            slides[currentSlide - 1].classList.add('active');
            dots[currentSlide - 1].classList.add('active');
        }

        document.addEventListener('keydown', function(e) {
            if (e.key === 'ArrowLeft') {
                changeSlide(-1);
            } else if (e.key === 'ArrowRight') {
                changeSlide(1);
            }
        });

        function checkAnswer1() {
            const answer = document.getElementById('q1').value.trim().toLowerCase();
            const feedback = document.getElementById('feedback1');

            if (answer === 'must') {
                feedback.className = 'feedback correct';
                feedback.textContent = '✓ Perfect! "must" - Strong obligation/law.';
                setTimeout(() => { changeSlide(1); }, 1500);
            } else {
                feedback.className = 'feedback incorrect';
                feedback.textContent = '✗ Use "must" for legal requirements and strong obligations';
            }
        }

        function checkAnswer2() {
            const answer = document.getElementById('q2').value.trim().toLowerCase();
            const feedback = document.getElementById('feedback2');

            if (answer === "mustn't" || answer === 'must not') {
                feedback.className = 'feedback correct';
                feedback.textContent = '✓ Excellent! "mustn\'t" - Prohibition/forbidden.';
                setTimeout(() => { changeSlide(1); }, 1500);
            } else {
                feedback.className = 'feedback incorrect';
                feedback.textContent = '✗ Use "mustn\'t" for prohibitions (things that are forbidden)';
            }
        }

        function checkAnswer3() {
            const answer = document.getElementById('q3').value.trim().toLowerCase();
            const feedback = document.getElementById('feedback3');

            if (answer === 'should') {
                feedback.className = 'feedback correct';
                feedback.textContent = '✓ Correct! "should" - Advice/recommendation.';
                setTimeout(() => { changeSlide(1); }, 1500);
            } else {
                feedback.className = 'feedback incorrect';
                feedback.textContent = '✗ Use "should" for advice (not a strong obligation)';
            }
        }

        function checkAnswer4() {
            const answer = document.getElementById('q4').value.trim().toLowerCase();
            const feedback = document.getElementById('feedback4');

            if (answer === "don't have to" || answer === 'do not have to') {
                feedback.className = 'feedback correct';
                feedback.textContent = '✓ Great! "don\'t have to" - Not necessary (optional).';
                setTimeout(() => { changeSlide(1); }, 1500);
            } else {
                feedback.className = 'feedback incorrect';
                feedback.textContent = '✗ Use "don\'t have to" for things that are optional/not necessary';
            }
        }

        function checkAnswer5() {
            const answer = document.getElementById('q5').value.trim().toLowerCase();
            const feedback = document.getElementById('feedback5');

            if (answer === 'can') {
                feedback.className = 'feedback correct';
                feedback.textContent = '✓ Perfect! "can" - Ability.';
                setTimeout(() => { changeSlide(1); }, 1500);
            } else {
                feedback.className = 'feedback incorrect';
                feedback.textContent = '✗ Use "can" to express ability';
            }
        }

        function checkAnswer6() {
            const answer = document.getElementById('q6').value.trim().toLowerCase();
            const feedback = document.getElementById('feedback6');

            if (answer === 'can' || answer === 'could' || answer === 'may') {
                feedback.className = 'feedback correct';
                feedback.textContent = '✓ Excellent! All three work! (Can=informal, Could=polite, May=formal)';
                setTimeout(() => { changeSlide(1); }, 1500);
            } else {
                feedback.className = 'feedback incorrect';
                feedback.textContent = '✗ Use Can/Could/May for asking permission';
            }
        }

        function checkAnswer7() {
            const answer = document.getElementById('q7').value.trim().toLowerCase();
            const feedback = document.getElementById('feedback7');

            if (answer === 'might' || answer === 'may' || answer === 'could') {
                feedback.className = 'feedback correct';
                feedback.textContent = '✓ Correct! Shows uncertain possibility.';
                setTimeout(() => { changeSlide(1); }, 1500);
            } else {
                feedback.className = 'feedback incorrect';
                feedback.textContent = '✗ Use might/may/could for uncertain possibilities';
            }
        }

        function checkAnswer8() {
            const answer = document.getElementById('q8').value.trim().toLowerCase();
            const feedback = document.getElementById('feedback8');

            if (answer === 'she can speak english' || answer === 'she can speak english.') {
                feedback.className = 'feedback correct';
                feedback.textContent = '✓ Great! Modals don\'t take -s!';
                setTimeout(() => { changeSlide(1); }, 1500);
            } else {
                feedback.className = 'feedback incorrect';
                feedback.textContent = '✗ Correct: She can speak English (no -s on modals)';
            }
        }

        async function checkGrammar() {
            const text = document.getElementById('writing1').value;
            const feedbackDiv = document.getElementById('grammar-feedback');
            const textarea = document.getElementById('writing1');

            if (!text.trim()) {
                feedbackDiv.style.display = 'block';
                feedbackDiv.style.background = 'rgba(245, 101, 101, 0.1)';
                feedbackDiv.style.border = '1px solid rgba(245, 101, 101, 0.3)';
                feedbackDiv.style.color = '#c53030';
                feedbackDiv.innerHTML = '✗ Please write some sentences first!';
                return;
            }

            textarea.style.display = 'none';
            window.grammarCheckResult = { original: text, corrected: '' };

            feedbackDiv.style.display = 'block';
            feedbackDiv.style.background = 'rgba(102, 126, 234, 0.1)';
            feedbackDiv.style.border = '1px solid rgba(102, 126, 234, 0.3)';
            feedbackDiv.style.color = '#667eea';
            feedbackDiv.innerHTML = '⏳ Checking your grammar and spelling...';

            try {
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=AIzaSyBTH0NmDb3cqjrY6p7YROPIJel-iCxSxzs`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        contents: [{
                            parts: [{
                                text: `You are a strict grammar checker. Fix grammar and spelling errors. Do not change the meaning, style, or add punctuation unless absolutely necessary. Profanities are acceptable, but don't use shortened informal words like "cuz" or "wanna"\n\nText: "${text}"\n\nReturn only the corrected text with minimal changes.`
                            }]
                        }]
                    })
                });

                const data = await response.json();
                const correctedText = data.candidates?.[0]?.content?.parts?.[0]?.text?.trim() || text;

                if (correctedText !== text && correctedText.toLowerCase() !== text.toLowerCase()) {
                    const originalWords = text.split(/(\s+)/);
                    const correctedWords = correctedText.split(/(\s+)/);
                    let highlightedText = '';

                    originalWords.forEach((word, i) => {
                        if (word.match(/\s+/)) {
                            highlightedText += word;
                        } else if (correctedWords[i] && word.toLowerCase() !== correctedWords[i].toLowerCase()) {
                            highlightedText += `<span style="color: #e53e3e; font-weight: 600; background: rgba(245, 101, 101, 0.15); padding: 2px 4px; border-radius: 3px;">${word}</span>`;
                        } else {
                            highlightedText += word;
                        }
                    });

                    let html = `
                        <div style="margin-bottom: 20px;">
                            <strong style="color: #c53030;">Your Text (errors highlighted):</strong>
                            <div style="background: white; padding: 15px; border-radius: 8px; margin-top: 10px; border: 2px solid rgba(245, 101, 101, 0.3); line-height: 1.8;">
                                ${highlightedText}
                            </div>
                        </div>
                        <div>
                            <strong style="color: #2f855a;">Corrected Text:</strong>
                            <div style="background: rgba(72, 187, 120, 0.1); padding: 15px; border-radius: 8px; margin-top: 10px; border: 2px solid rgba(72, 187, 120, 0.3); color: #2d3748; line-height: 1.8;">
                                ${correctedText}
                            </div>
                        </div>
                    `;

                    feedbackDiv.style.background = 'rgba(245, 101, 101, 0.05)';
                    feedbackDiv.style.border = '1px solid rgba(245, 101, 101, 0.3)';
                    feedbackDiv.style.color = '#2d3748';
                    feedbackDiv.innerHTML = html;

                    window.grammarCheckResult.corrected = correctedText;
                    const sendBtn = document.getElementById('send-teacher-btn');
                    sendBtn.disabled = false;
                    sendBtn.style.opacity = '1';
                    sendBtn.style.cursor = 'pointer';
                } else {
                    feedbackDiv.style.background = 'rgba(72, 187, 120, 0.1)';
                    feedbackDiv.style.border = '1px solid rgba(72, 187, 120, 0.3)';
                    feedbackDiv.style.color = '#2f855a';
                    feedbackDiv.innerHTML = '✓ Perfect! No grammar or spelling errors detected!';

                    window.grammarCheckResult.corrected = text;
                    const sendBtn = document.getElementById('send-teacher-btn');
                    sendBtn.disabled = false;
                    sendBtn.style.opacity = '1';
                    sendBtn.style.cursor = 'pointer';
                }
            } catch (error) {
                feedbackDiv.style.background = 'rgba(245, 101, 101, 0.1)';
                feedbackDiv.style.border = '1px solid rgba(245, 101, 101, 0.3)';
                feedbackDiv.style.color = '#c53030';
                feedbackDiv.innerHTML = '✗ Unable to check grammar. Error: ' + error.message;
            }
        }

        function sendToTeacher() {
            const essayTitle = "B1-50: Mixed Modals - Possibility, Obligation, Prohibition";
            const originalText = window.grammarCheckResult.original;
            const correctedText = window.grammarCheckResult.corrected;

            const emailBody = `Essay Title: ${essayTitle}\n\nOriginal Essay:\n${originalText}\n\nWe made some changes:\n\nCorrected Text:\n${correctedText}`;
            const mailtoLink = `mailto:?subject=${encodeURIComponent(essayTitle)}&body=${encodeURIComponent(emailBody)}`;
            window.location.href = mailtoLink;
        }
    </script>
</body>
</html>
