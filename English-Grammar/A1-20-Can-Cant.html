<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>A1-20: Can/Can't - Ability and Permission</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            height: 100vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 20px 40px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
        }

        .header-left {
            display: flex;
            flex-direction: column;
        }

        .header h1 {
            color: #2d3748;
            font-size: 2.5rem;
            font-weight: 700;
            margin: 0;
            letter-spacing: -0.5px;
        }

        .header .website {
            text-align: center;
            margin-top: 8px;
        }

        .header .website a {
            color: #4c51bf;
            text-decoration: none;
            font-size: 1.2rem;
            font-weight: 500;
            transition: color 0.3s ease;
        }

        .header .website a:hover {
            color: #553c9a;
        }

        .header-image {
            width: 120px;
            height: 80px;
            border-radius: 12px;
            object-fit: cover;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.15);
        }

        .container {
            display: flex;
            height: calc(100vh - 120px);
        }

        .navigation {
            width: 280px;
            background: rgba(45, 55, 72, 0.95);
            backdrop-filter: blur(10px);
            padding: 30px 20px;
            border-right: 1px solid rgba(255, 255, 255, 0.1);
        }

        .nav-item {
            padding: 16px 24px;
            margin: 8px 0;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            color: #e2e8f0;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            text-align: center;
            font-weight: 500;
            font-size: 1.1rem;
            backdrop-filter: blur(5px);
        }

        .nav-item:hover {
            background: rgba(255, 255, 255, 0.2);
            color: #ffffff;
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
        }

        .nav-item.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #ffffff;
            border-color: transparent;
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
        }

        .content {
            flex: 1;
            display: flex;
            flex-direction: column;
            height: 100%;
            overflow: hidden;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
        }

        .section {
            display: none;
            flex: 1;
            padding: 0;
            overflow: hidden;
            height: 100%;
            background: white;
        }

        .section.active {
            display: flex;
            flex-direction: column;
        }

        .slideshow-container {
            position: relative;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background: white;
            padding: 30px 80px;
        }

        .slide-content-wrapper {
            position: relative;
            width: 100%;
            max-width: 1400px;
            height: 85%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .slide {
            display: none;
            width: 100%;
            height: 100%;
            background: white;
            border-radius: 20px;
            padding: 25px 35px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .slide.active {
            display: flex;
            flex-direction: column;
            animation: slideIn 0.5s ease-in-out;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(30px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .slide-arrow {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: #8B7EC8;
            color: white;
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            z-index: 10;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }

        .slide-arrow:hover {
            background: #7366B0;
            transform: translateY(-50%) scale(1.1);
        }

        .slide-arrow.prev {
            left: -70px;
        }

        .slide-arrow.next {
            right: -70px;
        }

        .slide-indicators {
            position: absolute;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 12px;
            z-index: 10;
        }

        .indicator-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #D1D5DB;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .indicator-dot.active {
            background: #667eea;
            transform: scale(1.3);
        }

        .indicator-dot:hover {
            background: #9CA3AF;
        }

        .slide h2 {
            color: #2d3748;
            margin-bottom: 15px;
            font-size: 2rem;
            font-weight: 700;
            text-align: center;
            letter-spacing: -0.5px;
        }

        .explanation-box {
            background: transparent;
            border: none;
            border-radius: 0;
            padding: 0;
            margin-bottom: 0;
            backdrop-filter: none;
            box-shadow: none;
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow-y: auto;
            overflow-x: hidden;
        }

        .explanation-box h3 {
            color: #667eea;
            font-size: 1.3rem;
            margin-bottom: 10px;
            font-weight: 600;
        }

        .explanation-box p {
            color: #2d3748;
            line-height: 1.5;
            font-size: 1rem;
            margin-bottom: 8px;
        }

        .rule-box {
            background: #e3f2fd;
            padding: 15px 20px;
            border-radius: 10px;
            margin: 10px 0;
            border-left: 4px solid #667eea;
        }

        .rule-box h4 {
            color: #667eea;
            font-size: 1.2rem;
            margin-bottom: 8px;
            font-weight: 600;
        }

        .rule-box p {
            font-size: 1rem;
            color: #2d3748;
            margin: 5px 0;
        }

        .yes-no {
            display: inline-block;
            padding: 6px 12px;
            margin: 3px;
            border-radius: 6px;
            font-weight: 600;
            font-size: 1rem;
            background: #4299e1;
            color: white;
        }

        .auxiliary {
            display: inline-block;
            padding: 6px 12px;
            margin: 3px;
            border-radius: 6px;
            font-weight: 600;
            font-size: 1rem;
            background: #48bb78;
            color: white;
        }

        .subject {
            display: inline-block;
            padding: 6px 12px;
            margin: 3px;
            border-radius: 6px;
            font-weight: 600;
            font-size: 1rem;
            background: #9f7aea;
            color: white;
        }

        .verb {
            display: inline-block;
            padding: 6px 12px;
            margin: 3px;
            border-radius: 6px;
            font-weight: 600;
            font-size: 1rem;
            background: #ed64a6;
            color: white;
        }

        .example-box {
            background: #f7fafc;
            border-left: 4px solid #667eea;
            padding: 12px;
            border-radius: 8px;
            margin: 8px 0;
        }

        .example-box p {
            margin: 5px 0;
            font-size: 1rem;
            color: #2d3748;
        }

        .note-box {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 12px;
            margin: 10px 0;
            border-radius: 8px;
        }

        .note-box strong {
            color: #856404;
            font-size: 1rem;
        }

        .note-box p {
            color: #856404;
            margin-top: 5px;
            line-height: 1.4;
            font-size: 0.95rem;
        }

        .exercise-container {
            background: transparent;
            border: none;
            border-radius: 0;
            padding: 0;
            margin-bottom: 10px;
            backdrop-filter: none;
            box-shadow: none;
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .exercise-container h3 {
            color: #764ba2;
            font-size: 1.4rem;
            margin-bottom: 15px;
            font-weight: 600;
        }

        .question-box {
            background: #e3f2fd;
            padding: 20px;
            border-radius: 12px;
            margin: 0;
        }

        .question-box p {
            font-weight: 600;
            color: #2d3748;
            margin-bottom: 12px;
            font-size: 1.1rem;
        }

        input[type="text"] {
            width: 100%;
            padding: 12px 18px;
            margin: 8px 0;
            border: 2px solid rgba(102, 126, 234, 0.3);
            border-radius: 8px;
            font-size: 1.05rem;
            font-family: 'Inter', sans-serif;
            background: rgba(255, 255, 255, 0.8);
            transition: all 0.3s ease;
        }

        input[type="text"]:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 20px rgba(102, 126, 234, 0.2);
        }

        .check-button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #ffffff;
            border: none;
            padding: 12px 30px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1.1rem;
            font-weight: 600;
            margin: 15px 5px 10px 5px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }

        .check-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
        }

        .feedback {
            padding: 15px 20px;
            border-radius: 12px;
            margin: 15px 0;
            font-weight: 500;
            font-size: 1.05rem;
            display: none;
        }

        .feedback.correct {
            background: rgba(72, 187, 120, 0.1);
            color: #2f855a;
            border: 1px solid rgba(72, 187, 120, 0.3);
            display: block;
        }

        .feedback.incorrect {
            background: rgba(245, 101, 101, 0.1);
            color: #c53030;
            border: 1px solid rgba(245, 101, 101, 0.3);
            display: block;
        }

        ul {
            margin-left: 25px;
            line-height: 1.6;
        }

        li {
            margin: 6px 0;
            font-size: 1.05rem;
            color: #2d3748;
        }

        li strong {
            color: #667eea;
        }

        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin: 12px 0;
        }

        .comparison-table th {
            background: #667eea;
            color: white;
            padding: 10px;
            font-size: 1.05rem;
            font-weight: 600;
        }

        .comparison-table td {
            padding: 10px;
            border: 1px solid #e2e8f0;
            font-size: 1rem;
            text-align: center;
        }

        .comparison-table tr:nth-child(even) {
            background: #f7fafc;
        }

        .explanation-box::-webkit-scrollbar {
            width: 8px;
        }

        .explanation-box::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }

        .explanation-box::-webkit-scrollbar-thumb {
            background: #667eea;
            border-radius: 10px;
        }

        .explanation-box::-webkit-scrollbar-thumb:hover {
            background: #5568d3;
        }

        .formula-box {
            background: #e6fffa;
            border: 2px solid #319795;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            text-align: center;
            font-size: 1.3rem;
        }

        .grid-examples {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .grid-card {
            background: white;
            padding: 15px;
            border-radius: 10px;
            border: 2px solid #e2e8f0;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .grid-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .reading-text {
            background: #f7fafc;
            padding: 20px;
            border-radius: 10px;
            line-height: 1.9;
            margin: 15px 0;
            border: 2px solid #e2e8f0;
        }

        .reading-text p {
            margin: 12px 0;
        }

        .highlight-question {
            background: #bee3f8;
            padding: 2px 6px;
            border-radius: 4px;
            font-weight: bold;
        }

        .highlight-answer {
            background: #c6f6d5;
            padding: 2px 6px;
            border-radius: 4px;
            font-weight: bold;
        }

        .example-sentence {
            font-size: 1.1rem;
            margin: 10px 0;
            padding: 10px;
            background: white;
            border-radius: 8px;
            border-left: 3px solid #667eea;
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="header-left">
            <h1>A1-20: Can/Can't - Ability and Permission</h1>
            <div class="website">
                <a href="https://www.mimlanguageservices.com/" target="_blank">mimlanguageservices</a>
            </div>
        </div>
        <a href="https://www.mimlanguageservices.com/" target="_blank">
            <img src="https://static.wixstatic.com/media/593d03_8958d96b0f6d4d1ea9dffa7f89bffe8b~mv2.png" alt="ESL Logo" class="header-image">
        </a>
    </div>

    <div class="container">
        <div class="navigation">
            <div class="nav-item active" onclick="showSection('explanation', this)">Explanation</div>
            <div class="nav-item" onclick="showSection('examples', this)">Examples</div>
            <div class="nav-item" onclick="showSection('reading', this)">Reading</div>
            <div class="nav-item" onclick="showSection('media', this)">Media</div>
            <div class="nav-item" onclick="showSection('practice', this)">Practice</div>
            <div class="nav-item" onclick="showSection('writing', this)">Writing</div>
        </div>

        <div class="content">
            <!-- Explanation Section -->
            <div class="section active" id="explanation">
                <div class="slideshow-container">
                    <div class="slide-content-wrapper">
                        <button class="slide-arrow prev" onclick="changeSlide(-1)">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                                <polyline points="15 18 9 12 15 6"></polyline>
                            </svg>
                        </button>
                        <button class="slide-arrow next" onclick="changeSlide(1)">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                                <polyline points="9 18 15 12 9 6"></polyline>
                            </svg>
                        </button>

                        <div class="slide active" data-section="explanation">
                            <h2>Welcome to CAN/CAN'T!</h2>
                            <div class="explanation-box">
                                <p style="font-size: 1.2rem; text-align: center; margin: 20px 0;">
                                    Today we will learn <span class="yes-no">CAN and CAN'T</span> in English!
                                </p>
                                <p style="font-size: 1.1rem; text-align: center;">
                                    We use CAN to talk about ability, permission, and requests.
                                </p>
                                <div class="formula-box">
                                    <span class="subject">Subject</span> + <span class="auxiliary">CAN</span> / <span class="verb">CAN'T</span> + base verb
                                </div>
                                <p style="text-align: center; font-size: 1.1rem;">
                                    Example: I <strong>can</strong> swim / She <strong>can't</strong> drive / <strong>Can</strong> you help me?
                                </p>
                            </div>
                        </div>

                        <div class="slide" data-section="explanation">
                            <h2>CAN for Ability</h2>
                            <div class="explanation-box">
                                <h3>Use CAN to talk about what you can or cannot do</h3>

                                <div class="formula-box">
                                    <span class="subject">Subject</span> + <span class="auxiliary">CAN</span> + base verb
                                </div>

                                <table class="comparison-table">
                                    <tr>
                                        <th>Positive</th>
                                        <th>Negative</th>
                                    </tr>
                                    <tr>
                                        <td>I can swim.</td>
                                        <td>I can't swim. / I cannot swim.</td>
                                    </tr>
                                    <tr>
                                        <td>She can drive.</td>
                                        <td>She can't drive. / She cannot drive.</td>
                                    </tr>
                                    <tr>
                                        <td>They can speak English.</td>
                                        <td>They can't speak English.</td>
                                    </tr>
                                </table>

                                <div class="rule-box">
                                    <h4>Examples:</h4>
                                    <p>• I <strong>can</strong> play the guitar.</p>
                                    <p>• He <strong>can't</strong> cook very well.</p>
                                    <p>• We <strong>can</strong> run fast.</p>
                                </div>
                            </div>
                        </div>

                        <div class="slide" data-section="explanation">
                            <h2>CAN for Permission</h2>
                            <div class="explanation-box">
                                <h3>Use CAN to ask for or give permission</h3>

                                <div class="formula-box">
                                    <span class="auxiliary">CAN</span> + <span class="subject">subject</span> + base verb ?
                                </div>

                                <table class="comparison-table">
                                    <tr>
                                        <th>Question</th>
                                        <th>Answer (Yes)</th>
                                        <th>Answer (No)</th>
                                    </tr>
                                    <tr>
                                        <td>Can I go?</td>
                                        <td>Yes, you can.</td>
                                        <td>No, you can't.</td>
                                    </tr>
                                    <tr>
                                        <td>Can I use your phone?</td>
                                        <td>Yes, you can.</td>
                                        <td>No, you can't.</td>
                                    </tr>
                                    <tr>
                                        <td>Can we leave early?</td>
                                        <td>Yes, you can.</td>
                                        <td>No, you can't.</td>
                                    </tr>
                                </table>

                                <div class="rule-box">
                                    <h4>Examples:</h4>
                                    <p>• <strong>Can I</strong> sit here?</p>
                                    <p>• <strong>Can we</strong> open the window?</p>
                                    <p>• You <strong>can</strong> take my car. (giving permission)</p>
                                </div>
                            </div>
                        </div>

                        <div class="slide" data-section="explanation">
                            <h2>CAN for Requests</h2>
                            <div class="explanation-box">
                                <h3>Use CAN to ask someone to do something</h3>

                                <div class="formula-box">
                                    <span class="auxiliary">CAN</span> + <span class="subject">you</span> + base verb ?
                                </div>

                                <table class="comparison-table">
                                    <tr>
                                        <th>Request</th>
                                        <th>Response (Yes)</th>
                                        <th>Response (No)</th>
                                    </tr>
                                    <tr>
                                        <td>Can you help me?</td>
                                        <td>Yes, I can. / Sure!</td>
                                        <td>Sorry, I can't.</td>
                                    </tr>
                                    <tr>
                                        <td>Can you close the door?</td>
                                        <td>Of course!</td>
                                        <td>Sorry, I'm busy.</td>
                                    </tr>
                                    <tr>
                                        <td>Can you speak louder?</td>
                                        <td>Yes, I can.</td>
                                        <td>Sorry, I can't.</td>
                                    </tr>
                                </table>

                                <div class="rule-box">
                                    <h4>Examples:</h4>
                                    <p>• <strong>Can you</strong> pass the salt?</p>
                                    <p>• <strong>Can you</strong> open the window?</p>
                                    <p>• <strong>Can you</strong> call me later?</p>
                                </div>
                            </div>
                        </div>

                        <div class="slide" data-section="explanation">
                            <h2>CAN for Offers</h2>
                            <div class="explanation-box">
                                <h3>Use CAN to offer help</h3>

                                <div class="formula-box">
                                    <span class="auxiliary">CAN</span> + <span class="subject">I</span> + base verb ?
                                </div>

                                <table class="comparison-table">
                                    <tr>
                                        <th>Offer</th>
                                        <th>Meaning</th>
                                    </tr>
                                    <tr>
                                        <td>Can I help you?</td>
                                        <td>I want to help you</td>
                                    </tr>
                                    <tr>
                                        <td>Can I carry that for you?</td>
                                        <td>I offer to carry it</td>
                                    </tr>
                                    <tr>
                                        <td>Can I get you something?</td>
                                        <td>I offer to get something</td>
                                    </tr>
                                </table>

                                <div class="rule-box">
                                    <h4>Examples:</h4>
                                    <p>• <strong>Can I</strong> help you with that?</p>
                                    <p>• <strong>Can I</strong> take your coat?</p>
                                    <p>• <strong>Can I</strong> get you a drink?</p>
                                </div>
                            </div>
                        </div>

                        <div class="slide" data-section="explanation">
                            <h2>Common Mistakes</h2>
                            <div class="explanation-box">
                                <h3>❌ Mistake 1: Adding -s to CAN</h3>
                                <div class="example-box">
                                    <p>❌ She <del>cans</del> swim. → ✅ She <strong>can</strong> swim.</p>
                                    <p>❌ He <del>cans</del> drive. → ✅ He <strong>can</strong> drive.</p>
                                </div>

                                <h3>❌ Mistake 2: Adding TO after CAN</h3>
                                <div class="example-box">
                                    <p>❌ I can <del>to</del> speak English. → ✅ I <strong>can speak</strong> English.</p>
                                    <p>❌ She can <del>to</del> play piano. → ✅ She <strong>can play</strong> piano.</p>
                                </div>

                                <h3>❌ Mistake 3: Using CAN with -ing form</h3>
                                <div class="example-box">
                                    <p>❌ I can <del>swimming</del>. → ✅ I <strong>can swim</strong>.</p>
                                    <p>❌ They can <del>running</del> fast. → ✅ They <strong>can run</strong> fast.</p>
                                </div>

                                <h3>❌ Mistake 4: Wrong negative form</h3>
                                <div class="example-box">
                                    <p>❌ I <del>no can</del> go. → ✅ I <strong>can't</strong> go. / I <strong>cannot</strong> go.</p>
                                    <p>❌ She <del>doesn't can</del> come. → ✅ She <strong>can't</strong> come.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="slide-indicators" id="explanation-indicators">
                        <span class="indicator-dot active" onclick="goToSlide(1)"></span>
                        <span class="indicator-dot" onclick="goToSlide(2)"></span>
                        <span class="indicator-dot" onclick="goToSlide(3)"></span>
                        <span class="indicator-dot" onclick="goToSlide(4)"></span>
                        <span class="indicator-dot" onclick="goToSlide(5)"></span>
                        <span class="indicator-dot" onclick="goToSlide(6)"></span>
                    </div>
                </div>
            </div>

            <!-- Examples Section -->
            <div class="section" id="examples">
                <div class="slideshow-container">
                    <div class="slide-content-wrapper">
                        <button class="slide-arrow prev" onclick="changeSlide(-1)">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                                <polyline points="15 18 9 12 15 6"></polyline>
                            </svg>
                        </button>
                        <button class="slide-arrow next" onclick="changeSlide(1)">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                                <polyline points="9 18 15 12 9 6"></polyline>
                            </svg>
                        </button>

                        <div class="slide active" data-section="examples">
                            <h2>Ability Examples</h2>
                            <div class="explanation-box">
                                <h3>Using CAN/CAN'T for abilities:</h3>
                                <div class="grid-examples">
                                    <div class="grid-card">
                                        <strong>Physical Abilities:</strong><br><br>
                                        • I <strong>can swim</strong> very well.<br>
                                        • She <strong>can run</strong> fast.<br>
                                        • He <strong>can't jump</strong> high.<br>
                                        • They <strong>can dance</strong> salsa.
                                    </div>
                                    <div class="grid-card">
                                        <strong>Skills & Talents:</strong><br><br>
                                        • I <strong>can play</strong> the guitar.<br>
                                        • She <strong>can speak</strong> three languages.<br>
                                        • He <strong>can't cook</strong> very well.<br>
                                        • We <strong>can drive</strong> a car.
                                    </div>
                                </div>

                                <h3>Mental Abilities:</h3>
                                <div class="grid-examples">
                                    <div class="grid-card">
                                        <strong>Knowledge:</strong><br><br>
                                        • I <strong>can understand</strong> English.<br>
                                        • She <strong>can solve</strong> math problems.<br>
                                        • He <strong>can't remember</strong> names.<br>
                                        • They <strong>can read</strong> music.
                                    </div>
                                    <div class="grid-card">
                                        <strong>Senses:</strong><br><br>
                                        • I <strong>can see</strong> the mountains.<br>
                                        • She <strong>can hear</strong> the music.<br>
                                        • He <strong>can't taste</strong> the difference.<br>
                                        • We <strong>can smell</strong> the flowers.
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="slide" data-section="examples">
                            <h2>Permission Examples</h2>
                            <div class="explanation-box">
                                <table class="comparison-table">
                                    <tr>
                                        <th>Asking Permission</th>
                                        <th>Giving Permission</th>
                                        <th>Refusing Permission</th>
                                    </tr>
                                    <tr>
                                        <td>Can I use your phone?</td>
                                        <td>Yes, you can.</td>
                                        <td>No, you can't.</td>
                                    </tr>
                                    <tr>
                                        <td>Can I sit here?</td>
                                        <td>Of course you can!</td>
                                        <td>Sorry, you can't.</td>
                                    </tr>
                                    <tr>
                                        <td>Can we leave early?</td>
                                        <td>Yes, you can leave.</td>
                                        <td>No, you can't leave.</td>
                                    </tr>
                                    <tr>
                                        <td>Can I open the window?</td>
                                        <td>Sure, go ahead.</td>
                                        <td>I'd rather you didn't.</td>
                                    </tr>
                                </table>

                                <h3>Complete Dialogues:</h3>
                                <div class="example-box">
                                    <p><strong>Student:</strong> Can I ask a question?<br>
                                    <strong>Teacher:</strong> Yes, of course you can.</p>
                                    <p><strong>Child:</strong> Can I have some ice cream?<br>
                                    <strong>Parent:</strong> No, you can't. It's too late.</p>
                                    <p><strong>Employee:</strong> Can I take a break?<br>
                                    <strong>Boss:</strong> Yes, you can take 10 minutes.</p>
                                </div>
                            </div>
                        </div>

                        <div class="slide" data-section="examples">
                            <h2>Requests & Offers</h2>
                            <div class="explanation-box">
                                <h3>Making Requests:</h3>

                                <table class="comparison-table">
                                    <tr>
                                        <th>Request</th>
                                        <th>Positive Response</th>
                                        <th>Negative Response</th>
                                    </tr>
                                    <tr>
                                        <td>Can you help me?</td>
                                        <td>Sure, I can help.</td>
                                        <td>Sorry, I can't right now.</td>
                                    </tr>
                                    <tr>
                                        <td>Can you close the door?</td>
                                        <td>Yes, of course.</td>
                                        <td>Sorry, I'm too far away.</td>
                                    </tr>
                                    <tr>
                                        <td>Can you speak louder?</td>
                                        <td>Sure, no problem.</td>
                                        <td>Sorry, I have a sore throat.</td>
                                    </tr>
                                </table>

                                <h3>Making Offers:</h3>
                                <div class="example-box">
                                    <p>• <strong>Can I help you</strong> with those bags?</p>
                                    <p>• <strong>Can I get you</strong> a drink?</p>
                                    <p>• <strong>Can I carry that</strong> for you?</p>
                                    <p>• <strong>Can I give you</strong> a hand?</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="slide-indicators" id="examples-indicators">
                        <span class="indicator-dot active" onclick="goToSlide(1)"></span>
                        <span class="indicator-dot" onclick="goToSlide(2)"></span>
                        <span class="indicator-dot" onclick="goToSlide(3)"></span>
                    </div>
                </div>
            </div>

            <!-- Reading Section -->
            <div class="section" id="reading">
                <div class="slideshow-container">
                    <div class="slide-content-wrapper">
                        <button class="slide-arrow prev" onclick="changeSlide(-1)">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                                <polyline points="15 18 9 12 15 6"></polyline>
                            </svg>
                        </button>
                        <button class="slide-arrow next" onclick="changeSlide(1)">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                                <polyline points="9 18 15 12 9 6"></polyline>
                            </svg>
                        </button>

                        <div class="slide active" data-section="reading">
                            <h2>Reading: What Can You Do?</h2>
                            <div class="explanation-box">
                                <div class="reading-text">
                                    <p><strong>A Conversation at a Party</strong></p>

                                    <p><strong>Emma:</strong> Hi! I'm Emma. Nice to meet you!</p>
                                    <p><strong>Mike:</strong> Hi Emma! I'm Mike. Nice to meet you too!</p>

                                    <p><strong>Emma:</strong> So, what do you do for fun? <span class="highlight-question">Can you play</span> any sports?</p>
                                    <p><strong>Mike:</strong> Yes, I <span class="highlight-answer">can play</span> basketball very well. I play every weekend. How about you?</p>

                                    <p><strong>Emma:</strong> I <span class="highlight-answer">can't play</span> basketball, but I <span class="highlight-answer">can swim</span> really fast. I was on the swim team in school.</p>
                                    <p><strong>Mike:</strong> That's cool! <span class="highlight-question">Can you dive</span>?</p>

                                    <p><strong>Emma:</strong> No, I <span class="highlight-answer">can't dive</span>. I'm too scared! What else <span class="highlight-question">can you do</span>?</p>
                                    <p><strong>Mike:</strong> Well, I <span class="highlight-answer">can speak</span> Spanish and a little bit of French. I love languages.</p>

                                    <p><strong>Emma:</strong> Wow! I <span class="highlight-answer">can't speak</span> Spanish, but I <span class="highlight-answer">can play</span> the piano. Do you play any instruments?</p>
                                    <p><strong>Mike:</strong> No, I <span class="highlight-answer">can't play</span> any instruments. But I <span class="highlight-answer">can sing</span> pretty well!</p>

                                    <p><strong>Emma:</strong> Really? Maybe we <span class="highlight-question">can perform</span> together sometime!</p>
                                    <p><strong>Mike:</strong> That sounds great! By the way, <span class="highlight-question">can I get you</span> a drink?</p>
                                    <p><strong>Emma:</strong> Sure, thanks!</p>
                                </div>
                            </div>
                        </div>

                        <div class="slide" data-section="reading">
                            <h2>Reading Analysis</h2>
                            <div class="explanation-box">
                                <h3>CAN for Ability (Positive):</h3>
                                <div class="example-box">
                                    <p>• I <strong>can play</strong> basketball very well.</p>
                                    <p>• I <strong>can swim</strong> really fast.</p>
                                    <p>• I <strong>can speak</strong> Spanish and a little bit of French.</p>
                                    <p>• I <strong>can play</strong> the piano.</p>
                                    <p>• I <strong>can sing</strong> pretty well!</p>
                                </div>

                                <h3>CAN'T for Inability (Negative):</h3>
                                <div class="example-box">
                                    <p>• I <strong>can't play</strong> basketball.</p>
                                    <p>• I <strong>can't dive</strong>. I'm too scared!</p>
                                    <p>• I <strong>can't speak</strong> Spanish.</p>
                                    <p>• I <strong>can't play</strong> any instruments.</p>
                                </div>

                                <h3>CAN for Questions:</h3>
                                <div class="example-box">
                                    <p>• <strong>Can you play</strong> any sports?</p>
                                    <p>• <strong>Can you dive</strong>?</p>
                                    <p>• What else <strong>can you do</strong>?</p>
                                    <p>• <strong>Can we perform</strong> together sometime?</p>
                                </div>

                                <h3>CAN for Offers:</h3>
                                <div class="example-box">
                                    <p>• <strong>Can I get you</strong> a drink? (offering help)</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="slide-indicators" id="reading-indicators">
                        <span class="indicator-dot active" onclick="goToSlide(1)"></span>
                        <span class="indicator-dot" onclick="goToSlide(2)"></span>
                    </div>
                </div>
            </div>

            <!-- Media Section -->
            <div class="section" id="media">
                <div class="slideshow-container">
                    <div class="slide-content-wrapper">
                        <button class="slide-arrow prev" onclick="changeSlide(-1)">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                                <polyline points="15 18 9 12 15 6"></polyline>
                            </svg>
                        </button>
                        <button class="slide-arrow next" onclick="changeSlide(1)">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                                <polyline points="9 18 15 12 9 6"></polyline>
                            </svg>
                        </button>

                        <div class="slide active" data-section="media">
                            <h2>Video: Can and Can't</h2>
                            <div class="explanation-box">
                                <p style="font-size: 1.1rem; margin-bottom: 20px;">Watch this video about CAN and CAN'T:</p>
                                <div style="text-align: center; margin: 30px 0;">
                                    <iframe width="800" height="450"
                                        src="https://www.youtube.com/embed/KolNRGBLEJ0"
                                        style="border-radius: 15px; box-shadow: 0 8px 30px rgba(0,0,0,0.2);"
                                        frameborder="0"
                                        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                                        allowfullscreen>
                                    </iframe>
                                </div>
                                <p style="font-size: 1rem; color: #666; text-align: center; font-style: italic;">
                                    Learn how to use CAN for ability and permission
                                </p>
                            </div>
                        </div>

                        <div class="slide" data-section="media">
                            <h2>Video: CAN Practice</h2>
                            <div class="explanation-box">
                                <p style="font-size: 1.1rem; margin-bottom: 20px;">More practice with CAN and CAN'T:</p>
                                <div style="text-align: center; margin: 30px 0;">
                                    <iframe width="800" height="450"
                                        src="https://www.youtube.com/embed/6FgtUFCskQE"
                                        style="border-radius: 15px; box-shadow: 0 8px 30px rgba(0,0,0,0.2);"
                                        frameborder="0"
                                        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                                        allowfullscreen>
                                    </iframe>
                                </div>
                                <p style="font-size: 1rem; color: #666; text-align: center; font-style: italic;">
                                    Practice using CAN correctly in different situations
                                </p>
                            </div>
                        </div>
                    </div>
                    <div class="slide-indicators" id="media-indicators">
                        <span class="indicator-dot active" onclick="goToSlide(1)"></span>
                        <span class="indicator-dot" onclick="goToSlide(2)"></span>
                    </div>
                </div>
            </div>

            <!-- Practice Section -->
            <div class="section" id="practice">
                <div class="slideshow-container">
                    <div class="slide-content-wrapper">
                        <button class="slide-arrow prev" onclick="changeSlide(-1)">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                                <polyline points="15 18 9 12 15 6"></polyline>
                            </svg>
                        </button>
                        <button class="slide-arrow next" onclick="changeSlide(1)">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                                <polyline points="9 18 15 12 9 6"></polyline>
                            </svg>
                        </button>

                        <div class="slide active" data-section="practice">
                            <h2>Practice 1: Make it Positive</h2>
                            <div class="exercise-container">
                                <div class="question-box">
                                    <p>"I ___ swim very well." (Complete with CAN)</p>
                                    <input type="text" id="q1" placeholder="Type: can" onkeypress="if(event.key==='Enter') checkAnswer1()">
                                    <button class="check-button" onclick="checkAnswer1()">Check Answer</button>
                                    <div id="feedback1" class="feedback"></div>
                                </div>
                            </div>
                        </div>

                        <div class="slide" data-section="practice">
                            <h2>Practice 2: Make it Negative</h2>
                            <div class="exercise-container">
                                <div class="question-box">
                                    <p>"She ___ drive. She doesn't have a license." (Complete with CAN'T)</p>
                                    <input type="text" id="q2" placeholder="Type: can't or cannot" onkeypress="if(event.key==='Enter') checkAnswer2()">
                                    <button class="check-button" onclick="checkAnswer2()">Check Answer</button>
                                    <div id="feedback2" class="feedback"></div>
                                </div>
                            </div>
                        </div>

                        <div class="slide" data-section="practice">
                            <h2>Practice 3: Form a Question</h2>
                            <div class="exercise-container">
                                <div class="question-box">
                                    <p>"___ you speak English?" (Start with CAN)</p>
                                    <input type="text" id="q3" placeholder="Type: Can" onkeypress="if(event.key==='Enter') checkAnswer3()">
                                    <button class="check-button" onclick="checkAnswer3()">Check Answer</button>
                                    <div id="feedback3" class="feedback"></div>
                                </div>
                            </div>
                        </div>

                        <div class="slide" data-section="practice">
                            <h2>Practice 4: Permission Question</h2>
                            <div class="exercise-container">
                                <div class="question-box">
                                    <p>"___ I use your phone?" (Ask for permission)</p>
                                    <input type="text" id="q4" placeholder="Type: Can" onkeypress="if(event.key==='Enter') checkAnswer4()">
                                    <button class="check-button" onclick="checkAnswer4()">Check Answer</button>
                                    <div id="feedback4" class="feedback"></div>
                                </div>
                            </div>
                        </div>

                        <div class="slide" data-section="practice">
                            <h2>Practice 5: Fix the Mistake</h2>
                            <div class="exercise-container">
                                <div class="question-box">
                                    <p>Fix: "She cans play piano" → "___"</p>
                                    <input type="text" id="q5" placeholder="Type the correct sentence" onkeypress="if(event.key==='Enter') checkAnswer5()">
                                    <button class="check-button" onclick="checkAnswer5()">Check Answer</button>
                                    <div id="feedback5" class="feedback"></div>
                                </div>
                            </div>
                        </div>

                        <div class="slide" data-section="practice">
                            <h2>Practice 6: Remove TO</h2>
                            <div class="exercise-container">
                                <div class="question-box">
                                    <p>Fix: "I can to swim" → "___"</p>
                                    <input type="text" id="q6" placeholder="Type the correct sentence" onkeypress="if(event.key==='Enter') checkAnswer6()">
                                    <button class="check-button" onclick="checkAnswer6()">Check Answer</button>
                                    <div id="feedback6" class="feedback"></div>
                                </div>
                            </div>
                        </div>

                        <div class="slide" data-section="practice">
                            <h2>Practice 7: Request</h2>
                            <div class="exercise-container">
                                <div class="question-box">
                                    <p>"___ you help me with this?" (Make a request)</p>
                                    <input type="text" id="q7" placeholder="Type: Can" onkeypress="if(event.key==='Enter') checkAnswer7()">
                                    <button class="check-button" onclick="checkAnswer7()">Check Answer</button>
                                    <div id="feedback7" class="feedback"></div>
                                </div>
                            </div>
                        </div>

                        <div class="slide" data-section="practice">
                            <h2>Practice 8: Fix the Negative</h2>
                            <div class="exercise-container">
                                <div class="question-box">
                                    <p>Fix: "I no can go" → "___"</p>
                                    <input type="text" id="q8" placeholder="Type the correct sentence" onkeypress="if(event.key==='Enter') checkAnswer8()">
                                    <button class="check-button" onclick="checkAnswer8()">Check Answer</button>
                                    <div id="feedback8" class="feedback"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="slide-indicators" id="practice-indicators">
                        <span class="indicator-dot active" onclick="goToSlide(1)"></span>
                        <span class="indicator-dot" onclick="goToSlide(2)"></span>
                        <span class="indicator-dot" onclick="goToSlide(3)"></span>
                        <span class="indicator-dot" onclick="goToSlide(4)"></span>
                        <span class="indicator-dot" onclick="goToSlide(5)"></span>
                        <span class="indicator-dot" onclick="goToSlide(6)"></span>
                        <span class="indicator-dot" onclick="goToSlide(7)"></span>
                        <span class="indicator-dot" onclick="goToSlide(8)"></span>
                    </div>
                </div>
            </div>

            <!-- Writing Section -->
            <div class="section" id="writing">
                <div class="slideshow-container">
                    <div class="slide-content-wrapper">
                        <button class="slide-arrow prev" onclick="changeSlide(-1)">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                                <polyline points="15 18 9 12 15 6"></polyline>
                            </svg>
                        </button>
                        <button class="slide-arrow next" onclick="changeSlide(1)">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                                <polyline points="9 18 15 12 9 6"></polyline>
                            </svg>
                        </button>

                        <div class="slide active" data-section="writing" style="overflow-y: auto;">
                            <h2>Writing Practice</h2>
                            <div class="explanation-box">
                                <h3>Write 10 sentences about your abilities</h3>
                                <p style="margin-bottom: 15px;">Use CAN and CAN'T to describe what you can and can't do.</p>
                                <div class="question-box">
                                    <textarea id="writing1" rows="8" style="width: 100%; padding: 12px; border: 2px solid rgba(102, 126, 234, 0.3); border-radius: 8px; font-size: 1.05rem; font-family: 'Inter', sans-serif; resize: vertical;" spellcheck="true" placeholder="I can swim very well. I can speak two languages. I can't play the guitar..."></textarea>
                                    <div style="display: flex; gap: 10px; margin-top: 10px;">
                                        <button class="check-button" onclick="checkGrammar()">Check Grammar</button>
                                        <button id="send-teacher-btn" class="check-button" onclick="sendToTeacher()" style="background: linear-gradient(135deg, #48bb78 0%, #38a169 100%); opacity: 0.5; cursor: not-allowed;" disabled>Send to Teacher</button>
                                    </div>
                                    <div id="grammar-feedback" style="margin-top: 15px; padding: 15px; border-radius: 8px; display: none;"></div>
                                    <p style="font-size: 0.95rem; color: #666; margin-top: 10px;">Example: I can swim very well. I can speak two languages. I can't play the guitar. I can cook Italian food.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="slide-indicators" id="writing-indicators">
                        <span class="indicator-dot active" onclick="goToSlide(1)"></span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let currentSlide = 1;
        let currentSection = 'explanation';

        function showSection(sectionName, element) {
            const sections = document.querySelectorAll('.section');
            sections.forEach(section => section.classList.remove('active'));

            const navItems = document.querySelectorAll('.nav-item');
            navItems.forEach(item => item.classList.remove('active'));

            document.getElementById(sectionName).classList.add('active');

            if (element) {
                element.classList.add('active');
            }

            currentSection = sectionName;
            currentSlide = 1;

            setTimeout(() => {
                const activeSection = document.querySelector('.section.active');
                const inputField = activeSection.querySelector('input[type="text"]');
                if (inputField) {
                    inputField.focus();
                }
            }, 100);
        }

        function changeSlide(direction) {
            const activeSection = document.querySelector('.section.active');
            const slides = activeSection.querySelectorAll('.slide');
            const dots = activeSection.querySelectorAll('.indicator-dot');

            if (slides.length === 1) return;

            slides[currentSlide - 1].classList.remove('active');
            dots[currentSlide - 1].classList.remove('active');

            currentSlide += direction;

            if (currentSlide > slides.length) {
                currentSlide = 1;
            }
            if (currentSlide < 1) {
                currentSlide = slides.length;
            }

            slides[currentSlide - 1].classList.add('active');
            dots[currentSlide - 1].classList.add('active');

            setTimeout(() => {
                const activeSlide = slides[currentSlide - 1];
                const inputField = activeSlide.querySelector('input[type="text"]');
                if (inputField) {
                    inputField.focus();
                    inputField.value = '';
                }
            }, 100);
        }

        function goToSlide(slideNum) {
            const activeSection = document.querySelector('.section.active');
            const slides = activeSection.querySelectorAll('.slide');
            const dots = activeSection.querySelectorAll('.indicator-dot');

            slides[currentSlide - 1].classList.remove('active');
            dots[currentSlide - 1].classList.remove('active');

            currentSlide = slideNum;

            slides[currentSlide - 1].classList.add('active');
            dots[currentSlide - 1].classList.add('active');
        }

        document.addEventListener('keydown', function(e) {
            if (e.key === 'ArrowLeft') {
                changeSlide(-1);
            } else if (e.key === 'ArrowRight') {
                changeSlide(1);
            }
        });

        function checkAnswer1() {
            const answer = document.getElementById('q1').value.trim().toLowerCase();
            const feedback = document.getElementById('feedback1');

            if (answer === 'can') {
                feedback.className = 'feedback correct';
                feedback.textContent = '✓ Perfect! "I can swim very well."';
                setTimeout(() => { changeSlide(1); }, 1500);
            } else {
                feedback.className = 'feedback incorrect';
                feedback.textContent = '✗ The answer is: can (I can swim very well)';
            }
        }

        function checkAnswer2() {
            const answer = document.getElementById('q2').value.trim().toLowerCase();
            const feedback = document.getElementById('feedback2');

            if (answer === "can't" || answer === 'cannot') {
                feedback.className = 'feedback correct';
                feedback.textContent = '✓ Excellent! "She can\'t drive" or "She cannot drive."';
                setTimeout(() => { changeSlide(1); }, 1500);
            } else {
                feedback.className = 'feedback incorrect';
                feedback.textContent = '✗ The answer is: can\'t or cannot';
            }
        }

        function checkAnswer3() {
            const answer = document.getElementById('q3').value.trim().toLowerCase();
            const feedback = document.getElementById('feedback3');

            if (answer === 'can') {
                feedback.className = 'feedback correct';
                feedback.textContent = '✓ Correct! "Can you speak English?"';
                setTimeout(() => { changeSlide(1); }, 1500);
            } else {
                feedback.className = 'feedback incorrect';
                feedback.textContent = '✗ Start questions with CAN: Can you speak English?';
            }
        }

        function checkAnswer4() {
            const answer = document.getElementById('q4').value.trim().toLowerCase();
            const feedback = document.getElementById('feedback4');

            if (answer === 'can') {
                feedback.className = 'feedback correct';
                feedback.textContent = '✓ Perfect! "Can I use your phone?"';
                setTimeout(() => { changeSlide(1); }, 1500);
            } else {
                feedback.className = 'feedback incorrect';
                feedback.textContent = '✗ Use CAN to ask permission: Can I use your phone?';
            }
        }

        function checkAnswer5() {
            const answer = document.getElementById('q5').value.trim().toLowerCase();
            const feedback = document.getElementById('feedback5');

            if (answer === 'she can play piano' || answer === 'she can play the piano' || answer === 'she can play piano.') {
                feedback.className = 'feedback correct';
                feedback.textContent = '✓ Correct! Never add -s to CAN: "She can play piano."';
                setTimeout(() => { changeSlide(1); }, 1500);
            } else {
                feedback.className = 'feedback incorrect';
                feedback.textContent = '✗ Don\'t add -s to CAN: She can play piano (NOT cans)';
            }
        }

        function checkAnswer6() {
            const answer = document.getElementById('q6').value.trim().toLowerCase();
            const feedback = document.getElementById('feedback6');

            if (answer === 'i can swim' || answer === 'i can swim.') {
                feedback.className = 'feedback correct';
                feedback.textContent = '✓ Great! Never use TO after CAN: "I can swim."';
                setTimeout(() => { changeSlide(1); }, 1500);
            } else {
                feedback.className = 'feedback incorrect';
                feedback.textContent = '✗ Remove TO: I can swim (NOT can to swim)';
            }
        }

        function checkAnswer7() {
            const answer = document.getElementById('q7').value.trim().toLowerCase();
            const feedback = document.getElementById('feedback7');

            if (answer === 'can') {
                feedback.className = 'feedback correct';
                feedback.textContent = '✓ Perfect! "Can you help me with this?"';
                setTimeout(() => { changeSlide(1); }, 1500);
            } else {
                feedback.className = 'feedback incorrect';
                feedback.textContent = '✗ Use CAN to make requests: Can you help me?';
            }
        }

        function checkAnswer8() {
            const answer = document.getElementById('q8').value.trim().toLowerCase();
            const feedback = document.getElementById('feedback8');

            if (answer === "i can't go" || answer === 'i cannot go' || answer === "i can't go." || answer === 'i cannot go.') {
                feedback.className = 'feedback correct';
                feedback.textContent = '✓ Excellent! Use CAN\'T or CANNOT for negative: "I can\'t go."';
                setTimeout(() => { changeSlide(1); }, 1500);
            } else {
                feedback.className = 'feedback incorrect';
                feedback.textContent = '✗ Use CAN\'T or CANNOT: I can\'t go (NOT no can)';
            }
        }

        async function checkGrammar() {
            const text = document.getElementById('writing1').value;
            const feedbackDiv = document.getElementById('grammar-feedback');
            const textarea = document.getElementById('writing1');

            if (!text.trim()) {
                feedbackDiv.style.display = 'block';
                feedbackDiv.style.background = 'rgba(245, 101, 101, 0.1)';
                feedbackDiv.style.border = '1px solid rgba(245, 101, 101, 0.3)';
                feedbackDiv.style.color = '#c53030';
                feedbackDiv.innerHTML = '✗ Please write some sentences first!';
                return;
            }

            textarea.style.display = 'none';
            window.grammarCheckResult = { original: text, corrected: '' };

            feedbackDiv.style.display = 'block';
            feedbackDiv.style.background = 'rgba(102, 126, 234, 0.1)';
            feedbackDiv.style.border = '1px solid rgba(102, 126, 234, 0.3)';
            feedbackDiv.style.color = '#667eea';
            feedbackDiv.innerHTML = '⏳ Checking your grammar and spelling...';

            try {
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=AIzaSyBTH0NmDb3cqjrY6p7YROPIJel-iCxSxzs`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        contents: [{
                            parts: [{
                                text: `You are a strict grammar checker. Fix grammar and spelling errors. Do not change the meaning, style, or add punctuation unless absolutely necessary. Profanities are acceptable, but don't use shortened informal words like "cuz" or "wanna"\n\nText: "${text}"\n\nReturn only the corrected text with minimal changes.`
                            }]
                        }]
                    })
                });

                const data = await response.json();
                const correctedText = data.candidates?.[0]?.content?.parts?.[0]?.text?.trim() || text;

                if (correctedText !== text && correctedText.toLowerCase() !== text.toLowerCase()) {
                    const originalWords = text.split(/(\s+)/);
                    const correctedWords = correctedText.split(/(\s+)/);
                    let highlightedText = '';

                    originalWords.forEach((word, i) => {
                        if (word.match(/\s+/)) {
                            highlightedText += word;
                        } else if (correctedWords[i] && word.toLowerCase() !== correctedWords[i].toLowerCase()) {
                            highlightedText += `<span style="color: #e53e3e; font-weight: 600; background: rgba(245, 101, 101, 0.15); padding: 2px 4px; border-radius: 3px;">${word}</span>`;
                        } else {
                            highlightedText += word;
                        }
                    });

                    let html = `
                        <div style="margin-bottom: 20px;">
                            <strong style="color: #c53030;">Your Text (errors highlighted):</strong>
                            <div style="background: white; padding: 15px; border-radius: 8px; margin-top: 10px; border: 2px solid rgba(245, 101, 101, 0.3); line-height: 1.8;">
                                ${highlightedText}
                            </div>
                        </div>
                        <div>
                            <strong style="color: #2f855a;">Corrected Text:</strong>
                            <div style="background: rgba(72, 187, 120, 0.1); padding: 15px; border-radius: 8px; margin-top: 10px; border: 2px solid rgba(72, 187, 120, 0.3); color: #2d3748; line-height: 1.8;">
                                ${correctedText}
                            </div>
                        </div>
                    `;

                    feedbackDiv.style.background = 'rgba(245, 101, 101, 0.05)';
                    feedbackDiv.style.border = '1px solid rgba(245, 101, 101, 0.3)';
                    feedbackDiv.style.color = '#2d3748';
                    feedbackDiv.innerHTML = html;

                    window.grammarCheckResult.corrected = correctedText;
                    const sendBtn = document.getElementById('send-teacher-btn');
                    sendBtn.disabled = false;
                    sendBtn.style.opacity = '1';
                    sendBtn.style.cursor = 'pointer';
                } else {
                    feedbackDiv.style.background = 'rgba(72, 187, 120, 0.1)';
                    feedbackDiv.style.border = '1px solid rgba(72, 187, 120, 0.3)';
                    feedbackDiv.style.color = '#2f855a';
                    feedbackDiv.innerHTML = '✓ Perfect! No grammar or spelling errors detected!';

                    window.grammarCheckResult.corrected = text;
                    const sendBtn = document.getElementById('send-teacher-btn');
                    sendBtn.disabled = false;
                    sendBtn.style.opacity = '1';
                    sendBtn.style.cursor = 'pointer';
                }
            } catch (error) {
                feedbackDiv.style.background = 'rgba(245, 101, 101, 0.1)';
                feedbackDiv.style.border = '1px solid rgba(245, 101, 101, 0.3)';
                feedbackDiv.style.color = '#c53030';
                feedbackDiv.innerHTML = '✗ Unable to check grammar. Error: ' + error.message;
            }
        }

        function sendToTeacher() {
            const essayTitle = "A1-20: Can/Can't - Ability and Permission";
            const originalText = window.grammarCheckResult.original;
            const correctedText = window.grammarCheckResult.corrected;

            const emailBody = `Essay Title: ${essayTitle}\n\nOriginal Essay:\n${originalText}\n\nWe made some changes:\n\nCorrected Text:\n${correctedText}`;
            const mailtoLink = `mailto:?subject=${encodeURIComponent(essayTitle)}&body=${encodeURIComponent(emailBody)}`;
            window.location.href = mailtoLink;
        }
    </script>
</body>
</html>
